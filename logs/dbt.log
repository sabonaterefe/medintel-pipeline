[0m12:04:48.197222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7FA443A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7F8459BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7FB82BC50>]}


============================== 12:04:48.215893 | 0d9880ee-0b5f-4a73-927e-be35684d238a ==============================
[0m12:04:48.215893 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:04:48.218809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:04:48.340119 [info ] [MainThread]: dbt version: 1.10.4
[0m12:04:48.353636 [info ] [MainThread]: python version: 3.13.5
[0m12:04:48.357271 [info ] [MainThread]: python path: C:\Users\User\medintel-pipeline\venv\Scripts\python.exe
[0m12:04:48.359000 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:04:48.368130 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m12:04:48.370024 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m12:04:48.376775 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\medintel-pipeline\dbt_project.yml
[0m12:04:48.379287 [info ] [MainThread]: Configuration:
[0m12:04:48.381807 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:04:48.385660 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:04:48.402573 [info ] [MainThread]: Required dependencies:
[0m12:04:48.411618 [debug] [MainThread]: Executing "git --help"
[0m12:04:48.569833 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:04:48.573015 [debug] [MainThread]: STDERR: "b''"
[0m12:04:48.574751 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:04:48.578686 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:04:48.580934 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:04:48.582995 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\User\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:04:48.588953 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\User\medintel-pipeline\dbt_project.yml> not found

[0m12:04:48.598237 [debug] [MainThread]: Command `dbt debug` failed at 12:04:48.597024 after 0.81 seconds
[0m12:04:48.600150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7FC8888A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7FB71A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7FC8686B0>]}
[0m12:04:48.601839 [debug] [MainThread]: Flushing usage events
[0m12:04:50.491497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:21.451247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D468183A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D466199BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46956BC50>]}


============================== 12:08:21.464250 | 4bd084f2-1e7f-46ee-b826-5bd12dba7806 ==============================
[0m12:08:21.464250 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:08:21.466065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:08:21.527449 [info ] [MainThread]: dbt version: 1.10.4
[0m12:08:21.528854 [info ] [MainThread]: python version: 3.13.5
[0m12:08:21.530228 [info ] [MainThread]: python path: C:\Users\User\medintel-pipeline\venv\Scripts\python.exe
[0m12:08:21.531652 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:08:21.533687 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m12:08:21.534964 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m12:08:21.536338 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\medintel-pipeline\dbt_project.yml
[0m12:08:21.537747 [info ] [MainThread]: Configuration:
[0m12:08:21.539949 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:08:21.541428 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:08:21.544016 [info ] [MainThread]: Required dependencies:
[0m12:08:21.545716 [debug] [MainThread]: Executing "git --help"
[0m12:08:21.637922 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:08:21.640257 [debug] [MainThread]: STDERR: "b''"
[0m12:08:21.641494 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:08:21.643092 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:08:21.644596 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:08:21.646835 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\User\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:08:21.649524 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\User\medintel-pipeline\dbt_project.yml> not found

[0m12:08:21.652117 [debug] [MainThread]: Command `dbt debug` failed at 12:08:21.651786 after 0.77 seconds
[0m12:08:21.653103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A5C88A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46945E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A5B06B0>]}
[0m12:08:21.654098 [debug] [MainThread]: Flushing usage events
[0m12:08:23.015261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:27.074926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB1499FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB129BDBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB15D8FC50>]}


============================== 12:15:27.086828 | becd41ae-6e62-47af-8913-27e27e71141c ==============================
[0m12:15:27.086828 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:15:27.088520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:15:27.149167 [info ] [MainThread]: dbt version: 1.10.4
[0m12:15:27.150343 [info ] [MainThread]: python version: 3.13.5
[0m12:15:27.151803 [info ] [MainThread]: python path: C:\Users\User\medintel-pipeline\venv\Scripts\python.exe
[0m12:15:27.153519 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:15:27.154873 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m12:15:27.157926 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m12:15:27.159324 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\medintel-pipeline\dbt_project.yml
[0m12:15:27.190338 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:15:27.193740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'becd41ae-6e62-47af-8913-27e27e71141c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB16DE9F30>]}
[0m12:15:27.195601 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m12:15:27.198222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'becd41ae-6e62-47af-8913-27e27e71141c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB16DCBBD0>]}
[0m12:15:27.561586 [info ] [MainThread]: Configuration:
[0m12:15:27.563296 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:15:27.564960 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:15:27.566489 [info ] [MainThread]: Required dependencies:
[0m12:15:27.567935 [debug] [MainThread]: Executing "git --help"
[0m12:15:27.646114 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:15:27.647885 [debug] [MainThread]: STDERR: "b''"
[0m12:15:27.649014 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:15:27.650543 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:15:27.652254 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:15:27.654110 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\User\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:15:27.658679 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigDataPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:15:27.664291 [debug] [MainThread]: Command `dbt debug` failed at 12:15:27.663637 after 1.02 seconds
[0m12:15:27.665579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB15C23D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB16F64050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB14CA9E50>]}
[0m12:15:27.666437 [debug] [MainThread]: Flushing usage events
[0m12:15:28.942086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:09.454617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014350733A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001434E749BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014351B0BC50>]}


============================== 12:21:09.471399 | 45d6343e-834b-4776-ad1e-1bc8e5149c1f ==============================
[0m12:21:09.471399 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:21:09.474363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:09.565645 [info ] [MainThread]: dbt version: 1.10.4
[0m12:21:09.567397 [info ] [MainThread]: python version: 3.13.5
[0m12:21:09.568985 [info ] [MainThread]: python path: C:\Users\User\medintel-pipeline\venv\Scripts\python.exe
[0m12:21:09.570308 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:21:09.912759 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m12:21:09.914234 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m12:21:09.915613 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\medintel-pipeline\dbt_project.yml
[0m12:21:09.918483 [info ] [MainThread]: adapter type: postgres
[0m12:21:09.920031 [info ] [MainThread]: adapter version: 1.9.0
[0m12:21:09.952049 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:21:09.965431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45d6343e-834b-4776-ad1e-1bc8e5149c1f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014352B6B950>]}
[0m12:21:09.970605 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m12:21:09.977620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45d6343e-834b-4776-ad1e-1bc8e5149c1f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014352CD4C00>]}
[0m12:21:10.380446 [info ] [MainThread]: Configuration:
[0m12:21:10.382322 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:21:10.384061 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:21:10.385634 [info ] [MainThread]: Required dependencies:
[0m12:21:10.389143 [debug] [MainThread]: Executing "git --help"
[0m12:21:10.475436 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:21:10.476800 [debug] [MainThread]: STDERR: "b''"
[0m12:21:10.477868 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:21:10.479538 [info ] [MainThread]: Connection:
[0m12:21:10.481036 [info ] [MainThread]:   host: localhost
[0m12:21:10.482762 [info ] [MainThread]:   port: 5432
[0m12:21:10.484063 [info ] [MainThread]:   user: postgres
[0m12:21:10.485976 [info ] [MainThread]:   database: postgres
[0m12:21:10.489175 [info ] [MainThread]:   schema: staging
[0m12:21:10.491531 [info ] [MainThread]:   connect_timeout: 10
[0m12:21:10.493082 [info ] [MainThread]:   role: None
[0m12:21:10.494735 [info ] [MainThread]:   search_path: None
[0m12:21:10.496362 [info ] [MainThread]:   keepalives_idle: 0
[0m12:21:10.497962 [info ] [MainThread]:   sslmode: None
[0m12:21:10.500929 [info ] [MainThread]:   sslcert: None
[0m12:21:10.502548 [info ] [MainThread]:   sslkey: None
[0m12:21:10.503793 [info ] [MainThread]:   sslrootcert: None
[0m12:21:10.505410 [info ] [MainThread]:   application_name: dbt
[0m12:21:10.507556 [info ] [MainThread]:   retries: 1
[0m12:21:10.509291 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:21:11.268115 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:21:14.300717 [debug] [MainThread]: Using postgres connection "debug"
[0m12:21:14.301486 [debug] [MainThread]: On debug: select 1 as id
[0m12:21:14.301970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:14.402319 [debug] [MainThread]: SQL status: SELECT 1 in 0.100 seconds
[0m12:21:14.404871 [debug] [MainThread]: On debug: Close
[0m12:21:14.405966 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:21:14.409135 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:21:14.411097 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigDataPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:21:14.416183 [debug] [MainThread]: Command `dbt debug` succeeded at 12:21:14.415782 after 5.47 seconds
[0m12:21:14.417203 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:21:14.418643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014352BCA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014352BCA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014350A29E50>]}
[0m12:21:14.420753 [debug] [MainThread]: Flushing usage events
[0m12:21:24.491584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:28.015943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017070CDFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001706ECFDBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170720C7C50>]}


============================== 12:35:28.031933 | 1cdbe70c-527b-4123-84cb-7c3b64222da4 ==============================
[0m12:35:28.031933 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:35:28.035682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:28.334385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:35:28.336605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170730EA060>]}
[0m12:35:28.338377 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m12:35:28.339568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017073109D00>]}
[0m12:35:29.512402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017071F53850>]}
[0m12:35:29.756528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017071F46300>]}
[0m12:35:29.765647 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:35:30.498703 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:35:30.501808 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:35:30.503772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001707340A510>]}
[0m12:35:36.835314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170736128F0>]}
[0m12:35:36.986883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\dbt/medintel_models/target\manifest.json
[0m12:35:36.996120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\dbt/medintel_models/target\semantic_manifest.json
[0m12:35:37.082600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017073652210>]}
[0m12:35:37.084070 [info ] [MainThread]: Found 433 macros
[0m12:35:37.087461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cdbe70c-527b-4123-84cb-7c3b64222da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017073661390>]}
[0m12:35:37.091942 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:35:37.102400 [debug] [MainThread]: Command end result
[0m12:35:37.213014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\dbt/medintel_models/target\manifest.json
[0m12:35:37.225565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\dbt/medintel_models/target\semantic_manifest.json
[0m12:35:37.243389 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\dbt/medintel_models/target\run_results.json
[0m12:35:37.245925 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigDataPathDeprecation: 1 occurrence
- ConfigTargetPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:35:37.249669 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:37.249396 after 9.73 seconds
[0m12:35:37.251866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170737120D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170736CDBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017070888AD0>]}
[0m12:35:37.253327 [debug] [MainThread]: Flushing usage events
[0m12:35:47.598005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:21.406153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65BC03A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F659C19BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65CFE7C50>]}


============================== 12:38:21.418589 | 2c5347c4-ba14-4df8-9d70-bfff988a4764 ==============================
[0m12:38:21.418589 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:38:21.421154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:38:22.077501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c5347c4-ba14-4df8-9d70-bfff988a4764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65C2EFCE0>]}
[0m12:38:22.413086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c5347c4-ba14-4df8-9d70-bfff988a4764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65D059F20>]}
[0m12:38:22.416830 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:38:23.356519 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:38:23.360093 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:38:23.362059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c5347c4-ba14-4df8-9d70-bfff988a4764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65CE73750>]}
[0m12:38:26.253987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5347c4-ba14-4df8-9d70-bfff988a4764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65BABBE30>]}
[0m12:38:26.382738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m12:38:26.391315 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m12:38:26.461080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5347c4-ba14-4df8-9d70-bfff988a4764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65E3EB3F0>]}
[0m12:38:26.462964 [info ] [MainThread]: Found 433 macros
[0m12:38:26.464319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5347c4-ba14-4df8-9d70-bfff988a4764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65E4F35F0>]}
[0m12:38:26.468957 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:38:26.470828 [debug] [MainThread]: Command end result
[0m12:38:26.557287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m12:38:26.564470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m12:38:26.574078 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m12:38:26.577066 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:26.576566 after 5.72 seconds
[0m12:38:26.578450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65CF9C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65E501860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F65E501650>]}
[0m12:38:26.579821 [debug] [MainThread]: Flushing usage events
[0m12:38:27.537235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:05.510377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749CD2FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749AD51BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749E127C50>]}


============================== 12:41:05.520600 | a8e179f0-b10b-4cdd-af4b-df649dff1288 ==============================
[0m12:41:05.520600 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:41:05.522839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:41:06.358837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749D42FCE0>]}
[0m12:41:06.570359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749F169F20>]}
[0m12:41:06.573306 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:41:07.468050 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:41:07.899385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m12:41:07.901396 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/models\marts\schema.yml
[0m12:41:07.904490 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/models\marts\dim_dates.sql
[0m12:41:07.906135 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/models\marts\dim_channels.sql
[0m12:41:07.908093 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/models\marts\fct_messages.sql
[0m12:41:07.909843 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m12:41:09.925084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749F62B650>]}
[0m12:41:10.395798 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m12:41:10.401935 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m12:41:10.796485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749DFA6300>]}
[0m12:41:10.798182 [info ] [MainThread]: Found 4 models, 5 data tests, 433 macros
[0m12:41:10.799823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749E10E970>]}
[0m12:41:10.806067 [info ] [MainThread]: 
[0m12:41:10.807551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:10.808601 [info ] [MainThread]: 
[0m12:41:10.810485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:41:10.823297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:41:11.023711 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:41:11.024560 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:41:11.025281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:11.140670 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.115 seconds
[0m12:41:11.143412 [debug] [ThreadPool]: On list_postgres: Close
[0m12:41:11.148180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m12:41:11.163294 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:41:11.164095 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m12:41:11.164767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:11.249679 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m12:41:11.250731 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m12:41:11.251496 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m12:41:11.290726 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.038 seconds
[0m12:41:11.293956 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m12:41:11.294874 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m12:41:11.303594 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:11.304350 [debug] [MainThread]: On master: BEGIN
[0m12:41:11.304970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:11.381514 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m12:41:11.382338 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:11.383184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:41:11.406880 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m12:41:11.409363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749F9347A0>]}
[0m12:41:11.410557 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:11.411577 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:11.412297 [debug] [MainThread]: On master: BEGIN
[0m12:41:11.413551 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:41:11.414788 [debug] [MainThread]: On master: COMMIT
[0m12:41:11.415889 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:11.417016 [debug] [MainThread]: On master: COMMIT
[0m12:41:11.418239 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:11.419112 [debug] [MainThread]: On master: Close
[0m12:41:11.433799 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m12:41:11.436179 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m12:41:11.438692 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m12:41:11.440297 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m12:41:11.466581 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m12:41:11.484340 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m12:41:11.662833 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.stg_telegram_messages"
[0m12:41:11.667770 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m12:41:11.669266 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: BEGIN
[0m12:41:11.670652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:11.746611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m12:41:11.748085 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m12:41:11.748965 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  id,
  channel,
  CAST(date AS TIMESTAMP) AS message_date,
  LENGTH(text) AS message_length,
  has_image,
  image_path,
  text
FROM raw.telegram_messages
  );
[0m12:41:11.771591 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m12:41:11.791187 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m12:41:11.792099 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m12:41:11.795614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:41:11.853049 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m12:41:11.854057 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m12:41:11.854900 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m12:41:11.857920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:41:11.871063 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m12:41:11.881609 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m12:41:11.882864 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m12:41:11.884916 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:41:11.889665 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: Close
[0m12:41:11.896955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749FD74590>]}
[0m12:41:11.899243 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.45s]
[0m12:41:11.901928 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m12:41:11.904039 [debug] [Thread-4 (]: Began running node model.medintel_models.fct_messages
[0m12:41:11.906048 [debug] [Thread-2 (]: Began running node model.medintel_models.dim_channels
[0m12:41:11.904995 [debug] [Thread-3 (]: Began running node model.medintel_models.dim_dates
[0m12:41:11.907561 [info ] [Thread-4 (]: 4 of 4 START sql view model staging.fct_messages ............................... [RUN]
[0m12:41:11.909106 [info ] [Thread-2 (]: 2 of 4 START sql view model staging.dim_channels ............................... [RUN]
[0m12:41:11.913130 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m12:41:11.915359 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medintel_models.dim_channels'
[0m12:41:11.910602 [info ] [Thread-3 (]: 3 of 4 START sql view model staging.dim_dates .................................. [RUN]
[0m12:41:11.917537 [debug] [Thread-4 (]: Began compiling node model.medintel_models.fct_messages
[0m12:41:11.919122 [debug] [Thread-2 (]: Began compiling node model.medintel_models.dim_channels
[0m12:41:11.921068 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medintel_models.dim_dates'
[0m12:41:11.939996 [debug] [Thread-4 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m12:41:11.943420 [debug] [Thread-2 (]: Writing injected SQL for node "model.medintel_models.dim_channels"
[0m12:41:11.945042 [debug] [Thread-3 (]: Began compiling node model.medintel_models.dim_dates
[0m12:41:11.957024 [debug] [Thread-3 (]: Writing injected SQL for node "model.medintel_models.dim_dates"
[0m12:41:11.960123 [debug] [Thread-4 (]: Began executing node model.medintel_models.fct_messages
[0m12:41:11.970477 [debug] [Thread-4 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m12:41:11.973141 [debug] [Thread-2 (]: Began executing node model.medintel_models.dim_channels
[0m12:41:11.990311 [debug] [Thread-2 (]: Writing runtime sql for node "model.medintel_models.dim_channels"
[0m12:41:11.995352 [debug] [Thread-3 (]: Began executing node model.medintel_models.dim_dates
[0m12:41:11.997281 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m12:41:12.007333 [debug] [Thread-3 (]: Writing runtime sql for node "model.medintel_models.dim_dates"
[0m12:41:12.008604 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m12:41:12.010422 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: BEGIN
[0m12:41:12.012499 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: BEGIN
[0m12:41:12.014154 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:41:12.015243 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:41:12.018103 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m12:41:12.019767 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: BEGIN
[0m12:41:12.021571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:41:12.252101 [debug] [Thread-4 (]: SQL status: BEGIN in 0.238 seconds
[0m12:41:12.253561 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m12:41:12.255027 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  id,
  channel,
  message_date,
  message_length,
  has_image,
  image_path
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m12:41:12.268356 [debug] [Thread-2 (]: SQL status: BEGIN in 0.253 seconds
[0m12:41:12.269948 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m12:41:12.271483 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m12:41:12.284069 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m12:41:12.285776 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */

  create view "postgres"."staging"."dim_channels__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  channel AS channel_name
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m12:41:12.287496 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m12:41:12.290023 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:41:12.296624 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m12:41:12.298296 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m12:41:12.299888 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m12:41:12.301417 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m12:41:12.309408 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m12:41:12.311388 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m12:41:12.312967 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
alter table "postgres"."staging"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:41:12.321909 [debug] [Thread-4 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m12:41:12.332399 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m12:41:12.333439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.312 seconds
[0m12:41:12.334939 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m12:41:12.336359 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:41:12.338269 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m12:41:12.342353 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:41:12.344314 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m12:41:12.345195 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */

  create view "postgres"."staging"."dim_dates__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  message_date::DATE AS date
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m12:41:12.347766 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: Close
[0m12:41:12.348596 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m12:41:12.350005 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m12:41:12.352257 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749FCDD2E0>]}
[0m12:41:12.356513 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m12:41:12.364906 [debug] [Thread-2 (]: Applying DROP to: "postgres"."staging"."dim_channels__dbt_backup"
[0m12:41:12.365831 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m12:41:12.355210 [info ] [Thread-4 (]: 4 of 4 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.44s]
[0m12:41:12.367433 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m12:41:12.375230 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m12:41:12.377681 [debug] [Thread-4 (]: Finished running node model.medintel_models.fct_messages
[0m12:41:12.379265 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
drop view if exists "postgres"."staging"."dim_channels__dbt_backup" cascade
[0m12:41:12.380830 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
alter table "postgres"."staging"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:41:12.383624 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:41:12.388451 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: Close
[0m12:41:12.389299 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:41:12.394741 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m12:41:12.396608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749F4202D0>]}
[0m12:41:12.397943 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m12:41:12.399629 [info ] [Thread-2 (]: 2 of 4 OK created sql view model staging.dim_channels .......................... [[32mCREATE VIEW[0m in 0.48s]
[0m12:41:12.400884 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m12:41:12.403356 [debug] [Thread-2 (]: Finished running node model.medintel_models.dim_channels
[0m12:41:12.405860 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m12:41:12.412698 [debug] [Thread-3 (]: Applying DROP to: "postgres"."staging"."dim_dates__dbt_backup"
[0m12:41:12.414202 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m12:41:12.414972 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
drop view if exists "postgres"."staging"."dim_dates__dbt_backup" cascade
[0m12:41:12.416193 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:41:12.418904 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: Close
[0m12:41:12.420348 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e179f0-b10b-4cdd-af4b-df649dff1288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749FBD4250>]}
[0m12:41:12.422821 [info ] [Thread-3 (]: 3 of 4 OK created sql view model staging.dim_dates ............................. [[32mCREATE VIEW[0m in 0.50s]
[0m12:41:12.426563 [debug] [Thread-3 (]: Finished running node model.medintel_models.dim_dates
[0m12:41:12.430504 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:12.431743 [debug] [MainThread]: On master: BEGIN
[0m12:41:12.432918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:12.521923 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m12:41:12.523840 [debug] [MainThread]: On master: COMMIT
[0m12:41:12.526119 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:12.527641 [debug] [MainThread]: On master: COMMIT
[0m12:41:12.529486 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:12.530799 [debug] [MainThread]: On master: Close
[0m12:41:12.532107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:12.533026 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:41:12.534058 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m12:41:12.535059 [debug] [MainThread]: Connection 'model.medintel_models.stg_telegram_messages' was properly closed.
[0m12:41:12.536180 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m12:41:12.537116 [debug] [MainThread]: Connection 'model.medintel_models.dim_channels' was properly closed.
[0m12:41:12.538050 [debug] [MainThread]: Connection 'model.medintel_models.dim_dates' was properly closed.
[0m12:41:12.539160 [info ] [MainThread]: 
[0m12:41:12.547111 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m12:41:12.555176 [debug] [MainThread]: Command end result
[0m12:41:12.727532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m12:41:12.774852 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m12:41:12.821612 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m12:41:12.823350 [info ] [MainThread]: 
[0m12:41:12.863403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:12.899747 [info ] [MainThread]: 
[0m12:41:12.924215 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:41:12.951460 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:12.950874 after 7.88 seconds
[0m12:41:12.954594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027497A0DB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749C8C19B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749F7935F0>]}
[0m12:41:12.957570 [debug] [MainThread]: Flushing usage events
[0m12:41:14.013462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:45.097219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198DF4EFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198DD50DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E08D7C50>]}


============================== 13:01:45.106915 | 44efa686-a5be-42e7-8bea-da1542b6d826 ==============================
[0m13:01:45.106915 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:01:45.108831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m13:01:45.700991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198DFBDBCE0>]}
[0m13:01:45.883371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E0935F20>]}
[0m13:01:45.886120 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:01:46.512758 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:01:46.932435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:46.933018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:47.048735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E1D4DF50>]}
[0m13:01:47.262663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m13:01:47.270000 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m13:01:47.336588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E0756300>]}
[0m13:01:47.337862 [info ] [MainThread]: Found 4 models, 5 data tests, 433 macros
[0m13:01:47.339183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E1A12CF0>]}
[0m13:01:47.344752 [info ] [MainThread]: 
[0m13:01:47.346290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:47.347500 [info ] [MainThread]: 
[0m13:01:47.349227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:47.374737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:01:47.623544 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:01:47.624818 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:01:47.625584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:47.713111 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.087 seconds
[0m13:01:47.715774 [debug] [ThreadPool]: On list_postgres: Close
[0m13:01:47.720446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m13:01:47.730451 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:01:47.731795 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:01:47.732855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:47.805900 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m13:01:47.806599 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:01:47.807108 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:01:47.821865 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m13:01:47.824516 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:01:47.825451 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:01:47.842835 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:47.843605 [debug] [MainThread]: On master: BEGIN
[0m13:01:47.844168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:47.914146 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m13:01:47.915316 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:47.916324 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:47.936301 [debug] [MainThread]: SQL status: SELECT 4 in 0.019 seconds
[0m13:01:47.941582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E20B36C0>]}
[0m13:01:47.942509 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:47.943528 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:47.944060 [debug] [MainThread]: On master: BEGIN
[0m13:01:47.944885 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:47.945838 [debug] [MainThread]: On master: COMMIT
[0m13:01:47.946726 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:47.947744 [debug] [MainThread]: On master: COMMIT
[0m13:01:47.948730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:47.949907 [debug] [MainThread]: On master: Close
[0m13:01:47.959887 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m13:01:47.962643 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m13:01:47.964275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m13:01:47.965031 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m13:01:47.982186 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m13:01:47.985225 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m13:01:48.098701 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.stg_telegram_messages"
[0m13:01:48.101097 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m13:01:48.102340 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: BEGIN
[0m13:01:48.103590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:01:48.177735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m13:01:48.178949 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m13:01:48.180137 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  id,
  channel,
  CAST(date AS TIMESTAMP) AS message_date,
  LENGTH(text) AS message_length,
  has_image,
  image_path,
  text
FROM raw.telegram_messages
  );
[0m13:01:48.193802 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m13:01:48.209562 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m13:01:48.211044 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m13:01:48.212933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:48.219097 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m13:01:48.220603 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m13:01:48.222817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:48.269685 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m13:01:48.271367 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m13:01:48.272501 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m13:01:48.274687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:48.289825 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m13:01:48.303292 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m13:01:48.304005 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m13:01:48.321108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m13:01:48.327139 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: Close
[0m13:01:48.333490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E1F3B7D0>]}
[0m13:01:48.335504 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.36s]
[0m13:01:48.338811 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m13:01:48.340880 [debug] [Thread-4 (]: Began running node model.medintel_models.fct_messages
[0m13:01:48.342297 [debug] [Thread-3 (]: Began running node model.medintel_models.dim_dates
[0m13:01:48.343700 [debug] [Thread-2 (]: Began running node model.medintel_models.dim_channels
[0m13:01:48.345333 [info ] [Thread-4 (]: 4 of 4 START sql view model staging.fct_messages ............................... [RUN]
[0m13:01:48.352330 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m13:01:48.354056 [debug] [Thread-4 (]: Began compiling node model.medintel_models.fct_messages
[0m13:01:48.347016 [info ] [Thread-3 (]: 3 of 4 START sql view model staging.dim_dates .................................. [RUN]
[0m13:01:48.365375 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medintel_models.dim_dates'
[0m13:01:48.367120 [debug] [Thread-4 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m13:01:48.368694 [debug] [Thread-3 (]: Began compiling node model.medintel_models.dim_dates
[0m13:01:48.349298 [info ] [Thread-2 (]: 2 of 4 START sql view model staging.dim_channels ............................... [RUN]
[0m13:01:48.386074 [debug] [Thread-3 (]: Writing injected SQL for node "model.medintel_models.dim_dates"
[0m13:01:48.387867 [debug] [Thread-4 (]: Began executing node model.medintel_models.fct_messages
[0m13:01:48.389472 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medintel_models.dim_channels'
[0m13:01:48.404858 [debug] [Thread-4 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m13:01:48.406801 [debug] [Thread-3 (]: Began executing node model.medintel_models.dim_dates
[0m13:01:48.408496 [debug] [Thread-2 (]: Began compiling node model.medintel_models.dim_channels
[0m13:01:48.429808 [debug] [Thread-3 (]: Writing runtime sql for node "model.medintel_models.dim_dates"
[0m13:01:48.437550 [debug] [Thread-2 (]: Writing injected SQL for node "model.medintel_models.dim_channels"
[0m13:01:48.439138 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m13:01:48.441003 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: BEGIN
[0m13:01:48.442026 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:01:48.443941 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m13:01:48.445287 [debug] [Thread-2 (]: Began executing node model.medintel_models.dim_channels
[0m13:01:48.446620 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: BEGIN
[0m13:01:48.462025 [debug] [Thread-2 (]: Writing runtime sql for node "model.medintel_models.dim_channels"
[0m13:01:48.463293 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:01:48.466242 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m13:01:48.470214 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: BEGIN
[0m13:01:48.472233 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:01:48.556974 [debug] [Thread-3 (]: SQL status: BEGIN in 0.094 seconds
[0m13:01:48.558508 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m13:01:48.559978 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */

  create view "postgres"."staging"."dim_dates__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  message_date::DATE AS date
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m13:01:48.563176 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m13:01:48.564495 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m13:01:48.565944 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */

  create view "postgres"."staging"."dim_channels__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  channel AS channel_name
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m13:01:48.571382 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:01:48.580202 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m13:01:48.581575 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m13:01:48.582924 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
alter table "postgres"."staging"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m13:01:48.592456 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m13:01:48.594030 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
alter table "postgres"."staging"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m13:01:48.595416 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:01:48.600663 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m13:01:48.602062 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:01:48.603339 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m13:01:48.608095 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m13:01:48.609454 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m13:01:48.610798 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m13:01:48.612083 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m13:01:48.613527 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:48.621738 [debug] [Thread-3 (]: Applying DROP to: "postgres"."staging"."dim_dates__dbt_backup"
[0m13:01:48.623091 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m13:01:48.625401 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m13:01:48.630129 [debug] [Thread-2 (]: Applying DROP to: "postgres"."staging"."dim_channels__dbt_backup"
[0m13:01:48.631427 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
drop view if exists "postgres"."staging"."dim_dates__dbt_backup" cascade
[0m13:01:48.634188 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m13:01:48.635960 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
drop view if exists "postgres"."staging"."dim_channels__dbt_backup" cascade
[0m13:01:48.637020 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:01:48.641141 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: Close
[0m13:01:48.642517 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:01:48.644126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E1F2BC20>]}
[0m13:01:48.648708 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: Close
[0m13:01:48.652366 [debug] [Thread-4 (]: SQL status: BEGIN in 0.210 seconds
[0m13:01:48.651282 [info ] [Thread-3 (]: 3 of 4 OK created sql view model staging.dim_dates ............................. [[32mCREATE VIEW[0m in 0.28s]
[0m13:01:48.654185 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m13:01:48.655658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E2303BB0>]}
[0m13:01:48.657882 [debug] [Thread-3 (]: Finished running node model.medintel_models.dim_dates
[0m13:01:48.659079 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  id,
  channel,
  message_date,
  message_length,
  has_image,
  image_path
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m13:01:48.661258 [info ] [Thread-2 (]: 2 of 4 OK created sql view model staging.dim_channels .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m13:01:48.664813 [debug] [Thread-2 (]: Finished running node model.medintel_models.dim_channels
[0m13:01:48.672522 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:01:48.680655 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m13:01:48.681963 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m13:01:48.686284 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:48.690964 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m13:01:48.692470 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m13:01:48.693747 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m13:01:48.696821 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m13:01:48.712397 [debug] [Thread-4 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m13:01:48.714047 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m13:01:48.715356 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m13:01:48.717705 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:01:48.722602 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: Close
[0m13:01:48.724197 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44efa686-a5be-42e7-8bea-da1542b6d826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E21D01D0>]}
[0m13:01:48.726231 [info ] [Thread-4 (]: 4 of 4 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.37s]
[0m13:01:48.730013 [debug] [Thread-4 (]: Finished running node model.medintel_models.fct_messages
[0m13:01:48.734221 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:48.735113 [debug] [MainThread]: On master: BEGIN
[0m13:01:48.735578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:48.819614 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m13:01:48.820741 [debug] [MainThread]: On master: COMMIT
[0m13:01:48.821928 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:48.823144 [debug] [MainThread]: On master: COMMIT
[0m13:01:48.824465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:48.825448 [debug] [MainThread]: On master: Close
[0m13:01:48.826661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:48.827588 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:01:48.828412 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m13:01:48.829219 [debug] [MainThread]: Connection 'model.medintel_models.stg_telegram_messages' was properly closed.
[0m13:01:48.830064 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m13:01:48.830890 [debug] [MainThread]: Connection 'model.medintel_models.dim_dates' was properly closed.
[0m13:01:48.831681 [debug] [MainThread]: Connection 'model.medintel_models.dim_channels' was properly closed.
[0m13:01:48.832690 [info ] [MainThread]: 
[0m13:01:48.834056 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m13:01:48.837886 [debug] [MainThread]: Command end result
[0m13:01:48.996464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m13:01:49.003096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m13:01:49.019035 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m13:01:49.019812 [info ] [MainThread]: 
[0m13:01:49.021654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:49.023499 [info ] [MainThread]: 
[0m13:01:49.025303 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:01:49.029293 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:49.028911 after 4.39 seconds
[0m13:01:49.031402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198DA21DB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E1AE9B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E08E0B90>]}
[0m13:01:49.032673 [debug] [MainThread]: Flushing usage events
[0m13:01:50.210426 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:58.673354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146337EFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014631809BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014634BE7C50>]}


============================== 13:01:58.684615 | ffda6f92-7e5c-4b16-88a0-6d843e14ac21 ==============================
[0m13:01:58.684615 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:01:58.686867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:01:59.817984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffda6f92-7e5c-4b16-88a0-6d843e14ac21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014633EF3CE0>]}
[0m13:02:00.134899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffda6f92-7e5c-4b16-88a0-6d843e14ac21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014635C29F20>]}
[0m13:02:00.138028 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:02:01.069361 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:02:01.869054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:01.870278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:02.001571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffda6f92-7e5c-4b16-88a0-6d843e14ac21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146360BDE50>]}
[0m13:02:02.301543 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m13:02:02.308446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m13:02:02.450573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffda6f92-7e5c-4b16-88a0-6d843e14ac21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636305310>]}
[0m13:02:02.451983 [info ] [MainThread]: Found 4 models, 5 data tests, 433 macros
[0m13:02:02.453237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffda6f92-7e5c-4b16-88a0-6d843e14ac21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146362A67B0>]}
[0m13:02:02.461901 [info ] [MainThread]: 
[0m13:02:02.464506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:02.467822 [info ] [MainThread]: 
[0m13:02:02.475076 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:02:02.508153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m13:02:02.798627 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:02:02.799730 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:02:02.801167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:02.928826 [debug] [ThreadPool]: SQL status: BEGIN in 0.127 seconds
[0m13:02:02.930678 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:02:02.934048 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:02:02.962138 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m13:02:02.966572 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:02:02.967948 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:02:02.987176 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:02.988470 [debug] [MainThread]: On master: BEGIN
[0m13:02:02.989701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:03.096150 [debug] [MainThread]: SQL status: BEGIN in 0.106 seconds
[0m13:02:03.097378 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:03.099105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:02:03.121653 [debug] [MainThread]: SQL status: SELECT 4 in 0.021 seconds
[0m13:02:03.129637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffda6f92-7e5c-4b16-88a0-6d843e14ac21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146364DB380>]}
[0m13:02:03.131489 [debug] [MainThread]: On master: ROLLBACK
[0m13:02:03.133455 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:03.134174 [debug] [MainThread]: On master: BEGIN
[0m13:02:03.135674 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:02:03.136961 [debug] [MainThread]: On master: COMMIT
[0m13:02:03.138200 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:03.139467 [debug] [MainThread]: On master: COMMIT
[0m13:02:03.140807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:02:03.141889 [debug] [MainThread]: On master: Close
[0m13:02:03.155555 [debug] [Thread-1 (]: Began running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m13:02:03.157226 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m13:02:03.158968 [debug] [Thread-4 (]: Began running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m13:02:03.163586 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m13:02:03.165622 [info ] [Thread-1 (]: 1 of 5 START test not_null_dim_channels_channel_name ........................... [RUN]
[0m13:02:03.167286 [info ] [Thread-3 (]: 3 of 5 START test not_null_fct_messages_id ..................................... [RUN]
[0m13:02:03.172422 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m13:02:03.173977 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medintel_models.not_null_fct_messages_id.a8dc118488'
[0m13:02:03.168908 [info ] [Thread-4 (]: 4 of 5 START test unique_dim_channels_channel_name ............................. [RUN]
[0m13:02:03.176998 [debug] [Thread-1 (]: Began compiling node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m13:02:03.180411 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m13:02:03.170623 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_messages_channel ................................ [RUN]
[0m13:02:03.182857 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medintel_models.unique_dim_channels_channel_name.e57614abc8'
[0m13:02:03.232893 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medintel_models.not_null_fct_messages_channel.e99e1d225f'
[0m13:02:03.306017 [debug] [Thread-4 (]: Began compiling node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m13:02:03.323091 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m13:02:03.329376 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m13:02:03.330852 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m13:02:03.355841 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m13:02:03.372784 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m13:02:03.374754 [debug] [Thread-4 (]: Began executing node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m13:02:03.376874 [debug] [Thread-1 (]: Began executing node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m13:02:03.434333 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m13:02:03.486174 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m13:02:03.557726 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m13:02:03.563182 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m13:02:03.567176 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m13:02:03.570225 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m13:02:03.573784 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m13:02:03.575391 [debug] [Thread-1 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m13:02:03.577463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:02:03.579899 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m13:02:03.581704 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m13:02:03.583066 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: BEGIN
[0m13:02:03.584608 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m13:02:03.586342 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m13:02:03.587566 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:02:03.589028 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: BEGIN
[0m13:02:03.590286 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:02:03.592067 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:02:03.702331 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m13:02:03.703851 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m13:02:03.705199 [debug] [Thread-4 (]: SQL status: BEGIN in 0.115 seconds
[0m13:02:03.706489 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_id.a8dc118488"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."fct_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:02:03.707880 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m13:02:03.709567 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:02:03.713003 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:02:03.729086 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: ROLLBACK
[0m13:02:03.730593 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m13:02:03.735667 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m13:02:03.737048 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: Close
[0m13:02:03.738667 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: Close
[0m13:02:03.778068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.201 seconds
[0m13:02:03.779418 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m13:02:03.780991 [debug] [Thread-1 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "postgres"."staging"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m13:02:03.786803 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:02:03.791995 [debug] [Thread-1 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m13:02:03.794127 [debug] [Thread-1 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m13:02:03.740481 [info ] [Thread-3 (]: 3 of 5 PASS not_null_fct_messages_id ........................................... [[32mPASS[0m in 0.57s]
[0m13:02:03.801856 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m13:02:03.803199 [debug] [Thread-3 (]: Began running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m13:02:03.742779 [info ] [Thread-4 (]: 4 of 5 PASS unique_dim_channels_channel_name ................................... [[32mPASS[0m in 0.56s]
[0m13:02:03.870132 [debug] [Thread-4 (]: Finished running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m13:02:03.888851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.297 seconds
[0m13:02:03.890212 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m13:02:03.891760 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."fct_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m13:02:03.898623 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:02:03.903886 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: ROLLBACK
[0m13:02:03.905619 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: Close
[0m13:02:03.796114 [info ] [Thread-1 (]: 1 of 5 PASS not_null_dim_channels_channel_name ................................. [[32mPASS[0m in 0.62s]
[0m13:02:03.918971 [debug] [Thread-1 (]: Finished running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m13:02:03.804721 [info ] [Thread-3 (]: 5 of 5 START test unique_fct_messages_id ....................................... [RUN]
[0m13:02:03.922002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_id.a8dc118488, now test.medintel_models.unique_fct_messages_id.e6be0d3724)
[0m13:02:03.923542 [debug] [Thread-3 (]: Began compiling node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m13:02:03.939004 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m13:02:03.945518 [debug] [Thread-3 (]: Began executing node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m13:02:03.955377 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m13:02:04.082696 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m13:02:03.907956 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_messages_channel ...................................... [[32mPASS[0m in 0.68s]
[0m13:02:04.085875 [debug] [Thread-3 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: BEGIN
[0m13:02:04.087748 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m13:02:04.090052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:04.255638 [debug] [Thread-3 (]: SQL status: BEGIN in 0.166 seconds
[0m13:02:04.257020 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m13:02:04.258440 [debug] [Thread-3 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_fct_messages_id.e6be0d3724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."fct_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:02:04.264990 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:02:04.269527 [debug] [Thread-3 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: ROLLBACK
[0m13:02:04.271111 [debug] [Thread-3 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: Close
[0m13:02:04.273104 [info ] [Thread-3 (]: 5 of 5 PASS unique_fct_messages_id ............................................. [[32mPASS[0m in 0.35s]
[0m13:02:04.306460 [debug] [Thread-3 (]: Finished running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m13:02:04.309705 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:04.310912 [debug] [MainThread]: On master: BEGIN
[0m13:02:04.312004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:04.541730 [debug] [MainThread]: SQL status: BEGIN in 0.230 seconds
[0m13:02:04.542891 [debug] [MainThread]: On master: COMMIT
[0m13:02:04.544011 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:04.544919 [debug] [MainThread]: On master: COMMIT
[0m13:02:04.546005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:02:04.546963 [debug] [MainThread]: On master: Close
[0m13:02:04.548428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:04.549457 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m13:02:04.550620 [debug] [MainThread]: Connection 'test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b' was properly closed.
[0m13:02:04.551672 [debug] [MainThread]: Connection 'test.medintel_models.unique_fct_messages_id.e6be0d3724' was properly closed.
[0m13:02:04.552648 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m13:02:04.553707 [debug] [MainThread]: Connection 'test.medintel_models.not_null_fct_messages_channel.e99e1d225f' was properly closed.
[0m13:02:04.555176 [info ] [MainThread]: 
[0m13:02:04.556920 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m13:02:04.564046 [debug] [MainThread]: Command end result
[0m13:02:04.802576 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m13:02:04.812830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m13:02:04.838230 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m13:02:04.839213 [info ] [MainThread]: 
[0m13:02:04.840929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:04.844775 [info ] [MainThread]: 
[0m13:02:04.849644 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:02:04.852986 [debug] [MainThread]: Command `dbt test` succeeded at 13:02:04.852661 after 6.48 seconds
[0m13:02:04.854671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014634B9C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636332360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636331DE0>]}
[0m13:02:04.856056 [debug] [MainThread]: Flushing usage events
[0m13:02:05.748561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:30.521410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E83ACFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFFEA5BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E84EC7C50>]}


============================== 13:51:30.528072 | e4ac2409-575b-403e-a4a5-a846630a3987 ==============================
[0m13:51:30.528072 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:51:30.529151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:51:30.867222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4ac2409-575b-403e-a4a5-a846630a3987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E841CBCE0>]}
[0m13:51:30.978109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4ac2409-575b-403e-a4a5-a846630a3987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E84F39F20>]}
[0m13:51:30.980078 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:51:31.385619 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:51:31.685816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:51:31.686536 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/tests\long_messages.sql
[0m13:51:31.687151 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m13:51:32.165522 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medintel_models.stg_telegram_messages' (dbt/medintel_models/models\staging\stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m13:51:32.167589 [debug] [MainThread]: Command `dbt run` failed at 13:51:32.167367 after 1.88 seconds
[0m13:51:32.168154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E86369550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E8636A350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E866D0AA0>]}
[0m13:51:32.168667 [debug] [MainThread]: Flushing usage events
[0m13:51:33.257992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:55.033565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D4543A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D255DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D5927C50>]}


============================== 13:52:55.040779 | c3adc624-3fe7-4d98-9e1b-ba5ca78e0781 ==============================
[0m13:52:55.040779 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:52:55.041821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:55.397046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3adc624-3fe7-4d98-9e1b-ba5ca78e0781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D4C2BCE0>]}
[0m13:52:55.518620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3adc624-3fe7-4d98-9e1b-ba5ca78e0781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D5999F20>]}
[0m13:52:55.520583 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:52:55.960109 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:52:56.235230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:52:56.236091 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/tests\long_messages.sql
[0m13:52:56.236959 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\schema.yml
[0m13:52:56.237540 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m13:52:57.070708 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medintel_models.stg_telegram_messages' (dbt/medintel_models/models\staging\stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m13:52:57.073549 [debug] [MainThread]: Command `dbt run` failed at 13:52:57.073227 after 2.23 seconds
[0m13:52:57.074392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D6E1EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D6E1E550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D717FB60>]}
[0m13:52:57.075393 [debug] [MainThread]: Flushing usage events
[0m13:52:58.129401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:30.049987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F0AAFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0EEAC9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F1E8FC50>]}


============================== 13:55:30.056541 | 1e1002b4-91fe-4431-b8f4-3103bb5d57f9 ==============================
[0m13:55:30.056541 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:55:30.058993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:30.373898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1002b4-91fe-4431-b8f4-3103bb5d57f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F1197CE0>]}
[0m13:55:30.426042 [debug] [MainThread]: Command `dbt clean` succeeded at 13:55:30.425673 after 0.67 seconds
[0m13:55:30.432016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F2FEC050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F2FEC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F1D23D50>]}
[0m13:55:30.433086 [debug] [MainThread]: Flushing usage events
[0m13:55:31.790709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:03.889299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07CD43A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07AD59BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07E11BC50>]}


============================== 13:56:03.896099 | 948e38a3-d917-4426-880b-cd526d59f8bd ==============================
[0m13:56:03.896099 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:56:03.897209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:56:04.144261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '948e38a3-d917-4426-880b-cd526d59f8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07D433CE0>]}
[0m13:56:04.181681 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:56:04.183340 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:56:04.184788 [debug] [MainThread]: Command `dbt deps` succeeded at 13:56:04.184599 after 0.45 seconds
[0m13:56:04.185324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07DF53F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07F27CC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07DFB1950>]}
[0m13:56:04.186290 [debug] [MainThread]: Flushing usage events
[0m13:56:05.082510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:18.671938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F9DDAFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F9BDC9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F9F1A3C50>]}


============================== 13:58:18.678574 | 4ea69e6c-dec0-45f3-b1aa-b05289662fbd ==============================
[0m13:58:18.678574 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:58:18.679853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m13:58:18.911575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ea69e6c-dec0-45f3-b1aa-b05289662fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F9E4B3CE0>]}
[0m13:58:18.959384 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:58:18.961561 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:58:18.963358 [debug] [MainThread]: Command `dbt deps` succeeded at 13:58:18.963139 after 0.51 seconds
[0m13:58:18.963877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F9EFD3F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FA037CC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F9F031950>]}
[0m13:58:18.964794 [debug] [MainThread]: Flushing usage events
[0m13:58:20.034411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:05.377139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4664CFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4644E9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4678AFC50>]}


============================== 14:02:05.383638 | 376ba251-ff71-4420-a83e-ad7ab71c5db1 ==============================
[0m14:02:05.383638 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:02:05.384707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:02:05.681844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '376ba251-ff71-4420-a83e-ad7ab71c5db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C466BBFCE0>]}
[0m14:02:05.728267 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:02:05.730363 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:02:05.732412 [debug] [MainThread]: Command `dbt deps` succeeded at 14:02:05.732180 after 0.61 seconds
[0m14:02:05.732969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4676E3F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C468AFCC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C467741950>]}
[0m14:02:05.734114 [debug] [MainThread]: Flushing usage events
[0m14:02:11.672801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:05.930458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64CEFFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64AF1DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64E2DFC50>]}


============================== 14:04:05.940098 | c39b7b93-3787-4572-a1c1-7a8424131a8c ==============================
[0m14:04:05.940098 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:04:05.941450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:06.512581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c39b7b93-3787-4572-a1c1-7a8424131a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64D5EFCE0>]}
[0m14:04:06.566086 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:06.565831 after 1.16 seconds
[0m14:04:06.567161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64F44C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64F44C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64E173D50>]}
[0m14:04:06.568726 [debug] [MainThread]: Flushing usage events
[0m14:04:07.486657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:20.374797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024012253A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401026DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024013647C50>]}


============================== 14:04:20.385443 | 28565be6-b769-4449-8477-f5ebf36a3837 ==============================
[0m14:04:20.385443 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:04:20.387631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:21.005092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28565be6-b769-4449-8477-f5ebf36a3837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024012953CE0>]}
[0m14:04:21.384027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28565be6-b769-4449-8477-f5ebf36a3837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240136B9F20>]}
[0m14:04:21.387309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:22.136280 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:04:22.653505 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m14:04:22.655607 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/tests\long_messages.sql
[0m14:04:22.657404 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\fct_messages.sql
[0m14:04:22.658005 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\dim_channels.sql
[0m14:04:22.659097 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\dim_dates.sql
[0m14:04:22.660237 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m14:04:23.833757 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medintel_models.stg_telegram_messages' (dbt/medintel_models/models\staging\stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m14:04:23.837126 [debug] [MainThread]: Command `dbt run` failed at 14:04:23.836614 after 3.73 seconds
[0m14:04:23.838475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024014A6DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024014A6DF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024014C2D7C0>]}
[0m14:04:23.839460 [debug] [MainThread]: Flushing usage events
[0m14:04:24.707334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:39.230871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254B957FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254B7595BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BA95FC50>]}


============================== 14:06:39.242277 | 61d06d89-600e-45ce-8327-0fa423032961 ==============================
[0m14:06:39.242277 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:06:39.244717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:39.874393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61d06d89-600e-45ce-8327-0fa423032961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254B9C6FCE0>]}
[0m14:06:39.942791 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:39.942410 after 1.11 seconds
[0m14:06:39.943857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BBB6C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BBB6C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BA7F3D50>]}
[0m14:06:39.945648 [debug] [MainThread]: Flushing usage events
[0m14:06:41.097816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:52.504699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4DBA73A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4D9A89BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4DCE5FC50>]}


============================== 14:06:52.517006 | 130d8f9a-804e-4656-a2fb-cf1d7b244f16 ==============================
[0m14:06:52.517006 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:06:52.519171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:53.051258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '130d8f9a-804e-4656-a2fb-cf1d7b244f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4DC16FCE0>]}
[0m14:06:53.127835 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:06:53.130575 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:06:53.132717 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:53.132473 after 0.89 seconds
[0m14:06:53.133359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4DCC93F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4DDFB8C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4DCCF1950>]}
[0m14:06:53.135438 [debug] [MainThread]: Flushing usage events
[0m14:06:58.991354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:15.362644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DF593A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DD5ADBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E0977C50>]}


============================== 14:07:15.376011 | ac622640-5a75-4627-9ad2-b516dc9758f8 ==============================
[0m14:07:15.376011 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:07:15.379636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:16.090973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac622640-5a75-4627-9ad2-b516dc9758f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DFC7BCE0>]}
[0m14:07:16.321389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac622640-5a75-4627-9ad2-b516dc9758f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E19B9F20>]}
[0m14:07:16.324833 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:16.993219 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:07:17.471756 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m14:07:17.472764 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/tests\long_messages.sql
[0m14:07:17.474212 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\fct_messages.sql
[0m14:07:17.475187 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\dim_dates.sql
[0m14:07:17.476925 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m14:07:17.477896 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\dim_channels.sql
[0m14:07:18.346270 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medintel_models.stg_telegram_messages' (dbt/medintel_models/models\staging\stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m14:07:18.350309 [debug] [MainThread]: Command `dbt run` failed at 14:07:18.350040 after 3.36 seconds
[0m14:07:18.351285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E1DE9D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E1DE9F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216E1FA97C0>]}
[0m14:07:18.352598 [debug] [MainThread]: Flushing usage events
[0m14:07:19.490869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:23.892286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D010C3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D7F07DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D024A3C50>]}


============================== 14:09:23.901291 | eb22f2a3-a4de-4dc8-82b7-4034aea03a91 ==============================
[0m14:09:23.901291 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:09:23.902897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:24.251193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb22f2a3-a4de-4dc8-82b7-4034aea03a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D017B3CE0>]}
[0m14:09:24.347504 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:24.347117 after 0.78 seconds
[0m14:09:24.348846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D03618050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D03618380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D02333D50>]}
[0m14:09:24.350297 [debug] [MainThread]: Flushing usage events
[0m14:09:25.776173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:34.428202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC6373A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC4389BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC7753C50>]}


============================== 14:09:34.442002 | 026e026f-d34e-4609-a368-2bd231945e91 ==============================
[0m14:09:34.442002 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:09:34.443667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:34.983982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '026e026f-d34e-4609-a368-2bd231945e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC6A5FCE0>]}
[0m14:09:35.057640 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:09:35.062557 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:09:35.066025 [debug] [MainThread]: Command `dbt deps` succeeded at 14:09:35.065517 after 0.94 seconds
[0m14:09:35.067949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC7583F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC88ACC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC75E1950>]}
[0m14:09:35.069378 [debug] [MainThread]: Flushing usage events
[0m14:09:36.648347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:48.034449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24F98FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24D9A9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F250D77C50>]}


============================== 14:09:48.049500 | 64f5f29c-0d89-4d69-89a3-09b1d9e4055e ==============================
[0m14:09:48.049500 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:09:48.051858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:49.059222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25007FCE0>]}
[0m14:09:49.338283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F251DB9F20>]}
[0m14:09:49.341575 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:09:50.928232 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:09:51.456994 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 4 files changed.
[0m14:09:51.458908 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/models\staging\schema.yml
[0m14:09:51.460651 [debug] [MainThread]: Partial parsing: added file: medintel_models://dbt/medintel_models/tests\long_messages.sql
[0m14:09:51.462870 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\dim_dates.sql
[0m14:09:51.464223 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\fct_messages.sql
[0m14:09:51.465911 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m14:09:51.468288 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\dim_channels.sql
[0m14:09:53.536824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F250C03A50>]}
[0m14:09:53.930041 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:09:53.938332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:09:54.019244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F251E1B5C0>]}
[0m14:09:54.021659 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:09:54.025351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F250BF3690>]}
[0m14:09:54.031425 [info ] [MainThread]: 
[0m14:09:54.033974 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:54.035627 [info ] [MainThread]: 
[0m14:09:54.040738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:09:54.062863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:09:54.335688 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:09:54.336888 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:09:54.338346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:54.445174 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.107 seconds
[0m14:09:54.449019 [debug] [ThreadPool]: On list_postgres: Close
[0m14:09:54.463153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:09:54.481290 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:09:54.482268 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:09:54.483165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:54.561692 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m14:09:54.562720 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:09:54.563779 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:09:54.579466 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m14:09:54.583588 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:09:54.584937 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:09:54.600567 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:54.601592 [debug] [MainThread]: On master: BEGIN
[0m14:09:54.602460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:54.689966 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m14:09:54.690977 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:54.692379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:09:54.713427 [debug] [MainThread]: SQL status: SELECT 4 in 0.019 seconds
[0m14:09:54.718841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252887E10>]}
[0m14:09:54.720199 [debug] [MainThread]: On master: ROLLBACK
[0m14:09:54.721887 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:54.723175 [debug] [MainThread]: On master: BEGIN
[0m14:09:54.724503 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:09:54.725201 [debug] [MainThread]: On master: COMMIT
[0m14:09:54.725690 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:54.726611 [debug] [MainThread]: On master: COMMIT
[0m14:09:54.728078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:09:54.729268 [debug] [MainThread]: On master: Close
[0m14:09:54.752245 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m14:09:54.754229 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m14:09:54.756734 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m14:09:54.758060 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m14:09:54.784606 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m14:09:54.792346 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m14:09:54.942340 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.stg_telegram_messages"
[0m14:09:54.944977 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:09:54.946452 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: BEGIN
[0m14:09:54.947963 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:55.026051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m14:09:55.027621 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:09:55.029068 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  msg.id,
  msg.channel,
  CAST(msg.date AS TIMESTAMP) AS message_date,
  LENGTH(msg.text) AS message_length,
  msg.has_image,
  msg.image_path,
  msg.text
FROM "postgres"."raw"."telegram_messages" AS msg
  );
[0m14:09:55.041388 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:09:55.059450 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:09:55.060138 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m14:09:55.061662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:09:55.070751 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:09:55.071839 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m14:09:55.073329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:09:55.132367 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:09:55.134562 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:09:55.136424 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:09:55.140409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:09:55.160763 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m14:09:55.174684 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:09:55.176664 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m14:09:55.182618 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:09:55.190816 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: Close
[0m14:09:55.196970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252900DD0>]}
[0m14:09:55.199177 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.44s]
[0m14:09:55.202527 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m14:09:55.204985 [debug] [Thread-4 (]: Began running node model.medintel_models.fct_messages
[0m14:09:55.206601 [debug] [Thread-2 (]: Began running node model.medintel_models.dim_channels
[0m14:09:55.209859 [debug] [Thread-3 (]: Began running node model.medintel_models.dim_dates
[0m14:09:55.208703 [info ] [Thread-4 (]: 4 of 4 START sql view model staging.fct_messages ............................... [RUN]
[0m14:09:55.212547 [info ] [Thread-2 (]: 2 of 4 START sql view model staging.dim_channels ............................... [RUN]
[0m14:09:55.216979 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:09:55.218651 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medintel_models.dim_channels'
[0m14:09:55.214355 [info ] [Thread-3 (]: 3 of 4 START sql view model staging.dim_dates .................................. [RUN]
[0m14:09:55.219577 [debug] [Thread-4 (]: Began compiling node model.medintel_models.fct_messages
[0m14:09:55.220581 [debug] [Thread-2 (]: Began compiling node model.medintel_models.dim_channels
[0m14:09:55.222407 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medintel_models.dim_dates'
[0m14:09:55.247147 [debug] [Thread-2 (]: Writing injected SQL for node "model.medintel_models.dim_channels"
[0m14:09:55.236249 [debug] [Thread-4 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:09:55.248712 [debug] [Thread-3 (]: Began compiling node model.medintel_models.dim_dates
[0m14:09:55.259704 [debug] [Thread-3 (]: Writing injected SQL for node "model.medintel_models.dim_dates"
[0m14:09:55.261718 [debug] [Thread-4 (]: Began executing node model.medintel_models.fct_messages
[0m14:09:55.275435 [debug] [Thread-4 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:09:55.276900 [debug] [Thread-2 (]: Began executing node model.medintel_models.dim_channels
[0m14:09:55.289222 [debug] [Thread-2 (]: Writing runtime sql for node "model.medintel_models.dim_channels"
[0m14:09:55.290668 [debug] [Thread-3 (]: Began executing node model.medintel_models.dim_dates
[0m14:09:55.302548 [debug] [Thread-3 (]: Writing runtime sql for node "model.medintel_models.dim_dates"
[0m14:09:55.306372 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:09:55.309482 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:09:55.310742 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:09:55.312897 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: BEGIN
[0m14:09:55.314927 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:09:55.317452 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: BEGIN
[0m14:09:55.318932 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:09:55.320777 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:09:55.322147 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:09:55.428849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.107 seconds
[0m14:09:55.430106 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:09:55.431442 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */

  create view "postgres"."staging"."dim_channels__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  channel AS channel_name,
  NULL::TEXT AS channel_type -- Optional enrichment
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m14:09:55.442934 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:09:55.451723 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:09:55.453216 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
alter table "postgres"."staging"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m14:09:55.455115 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:09:55.459724 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m14:09:55.461292 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:09:55.462664 [debug] [Thread-4 (]: SQL status: BEGIN in 0.142 seconds
[0m14:09:55.464007 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m14:09:55.465551 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:09:55.467027 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  stg.message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
  );
[0m14:09:55.468400 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:09:55.476356 [debug] [Thread-2 (]: Applying DROP to: "postgres"."staging"."dim_channels__dbt_backup"
[0m14:09:55.478959 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:09:55.480313 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:09:55.481574 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
drop view if exists "postgres"."staging"."dim_channels__dbt_backup" cascade
[0m14:09:55.490449 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:09:55.491957 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:09:55.493282 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:09:55.497654 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: Close
[0m14:09:55.499037 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:09:55.503514 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:09:55.504968 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25251E780>]}
[0m14:09:55.506258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.187 seconds
[0m14:09:55.507605 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:09:55.511111 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:09:55.512366 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:09:55.509842 [info ] [Thread-2 (]: 2 of 4 OK created sql view model staging.dim_channels .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m14:09:55.514085 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */

  create view "postgres"."staging"."dim_dates__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  );
[0m14:09:55.516470 [debug] [Thread-2 (]: Finished running node model.medintel_models.dim_channels
[0m14:09:55.517853 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:09:55.527278 [debug] [Thread-4 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:09:55.529802 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:09:55.531335 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:09:55.532855 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:09:55.544767 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:09:55.546456 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.014 seconds
[0m14:09:55.547982 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
alter table "postgres"."staging"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m14:09:55.552385 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: Close
[0m14:09:55.554697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252B20870>]}
[0m14:09:55.558128 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:09:55.562309 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m14:09:55.563690 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:09:55.565123 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m14:09:55.556852 [info ] [Thread-4 (]: 4 of 4 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.34s]
[0m14:09:55.567827 [debug] [Thread-4 (]: Finished running node model.medintel_models.fct_messages
[0m14:09:55.569090 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:09:55.576723 [debug] [Thread-3 (]: Applying DROP to: "postgres"."staging"."dim_dates__dbt_backup"
[0m14:09:55.579660 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:09:55.581210 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
drop view if exists "postgres"."staging"."dim_dates__dbt_backup" cascade
[0m14:09:55.583029 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:09:55.587392 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: Close
[0m14:09:55.589298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f5f29c-0d89-4d69-89a3-09b1d9e4055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252999F50>]}
[0m14:09:55.592877 [info ] [Thread-3 (]: 3 of 4 OK created sql view model staging.dim_dates ............................. [[32mCREATE VIEW[0m in 0.37s]
[0m14:09:55.601425 [debug] [Thread-3 (]: Finished running node model.medintel_models.dim_dates
[0m14:09:55.604900 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:55.606596 [debug] [MainThread]: On master: BEGIN
[0m14:09:55.607679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:55.732282 [debug] [MainThread]: SQL status: BEGIN in 0.125 seconds
[0m14:09:55.733394 [debug] [MainThread]: On master: COMMIT
[0m14:09:55.734426 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:55.735423 [debug] [MainThread]: On master: COMMIT
[0m14:09:55.736615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:09:55.737571 [debug] [MainThread]: On master: Close
[0m14:09:55.738809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:55.739707 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:09:55.740571 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:09:55.741439 [debug] [MainThread]: Connection 'model.medintel_models.stg_telegram_messages' was properly closed.
[0m14:09:55.742315 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:09:55.743214 [debug] [MainThread]: Connection 'model.medintel_models.dim_channels' was properly closed.
[0m14:09:55.744096 [debug] [MainThread]: Connection 'model.medintel_models.dim_dates' was properly closed.
[0m14:09:55.745190 [info ] [MainThread]: 
[0m14:09:55.756978 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m14:09:55.766521 [debug] [MainThread]: Command end result
[0m14:09:55.954548 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:09:55.960774 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:09:55.989656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:09:55.990711 [info ] [MainThread]: 
[0m14:09:55.998074 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:56.012723 [info ] [MainThread]: 
[0m14:09:56.051131 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m14:09:56.062471 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:56.062108 after 8.40 seconds
[0m14:09:56.064099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F250C6F460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24A66DB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252042570>]}
[0m14:09:56.068981 [debug] [MainThread]: Flushing usage events
[0m14:09:57.422462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:12.122570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC76873A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7488DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC77C67C50>]}


============================== 14:11:12.133696 | 53c3937e-f7b7-4556-92f6-8e40c25f0409 ==============================
[0m14:11:12.133696 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:11:12.135545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:11:13.298252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53c3937e-f7b7-4556-92f6-8e40c25f0409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC76F67CE0>]}
[0m14:11:13.539396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53c3937e-f7b7-4556-92f6-8e40c25f0409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC77CC5F20>]}
[0m14:11:13.542477 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:11:14.428165 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:11:14.909522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:14.910113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:15.046231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53c3937e-f7b7-4556-92f6-8e40c25f0409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC77AF3150>]}
[0m14:11:15.384094 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:11:15.389531 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:11:15.472462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53c3937e-f7b7-4556-92f6-8e40c25f0409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC79336210>]}
[0m14:11:15.473460 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:11:15.474307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53c3937e-f7b7-4556-92f6-8e40c25f0409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC79293850>]}
[0m14:11:15.479139 [info ] [MainThread]: 
[0m14:11:15.479972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:15.481392 [info ] [MainThread]: 
[0m14:11:15.482632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:15.495323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:11:15.700128 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:11:15.701288 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:11:15.702453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:15.785288 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m14:11:15.786404 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:11:15.788060 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:11:15.800485 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m14:11:15.803215 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:11:15.804194 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:11:15.818341 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:15.819252 [debug] [MainThread]: On master: BEGIN
[0m14:11:15.819831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:16.005335 [debug] [MainThread]: SQL status: BEGIN in 0.185 seconds
[0m14:11:16.006440 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:16.007461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:16.028045 [debug] [MainThread]: SQL status: SELECT 4 in 0.020 seconds
[0m14:11:16.032795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53c3937e-f7b7-4556-92f6-8e40c25f0409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC79433EE0>]}
[0m14:11:16.033756 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:16.035054 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:16.036478 [debug] [MainThread]: On master: BEGIN
[0m14:11:16.038410 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:11:16.039247 [debug] [MainThread]: On master: COMMIT
[0m14:11:16.039886 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:16.040788 [debug] [MainThread]: On master: COMMIT
[0m14:11:16.041671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:16.042390 [debug] [MainThread]: On master: Close
[0m14:11:16.053177 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:11:16.054118 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:11:16.055358 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:11:16.057028 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:11:16.057816 [info ] [Thread-4 (]: 4 of 13 START test not_null_fct_messages_channel ............................... [RUN]
[0m14:11:16.058629 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_dates_date ..................................... [RUN]
[0m14:11:16.062849 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medintel_models.not_null_fct_messages_channel.e99e1d225f'
[0m14:11:16.065461 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_dates_date.e2decc9d39'
[0m14:11:16.060139 [info ] [Thread-1 (]: 1 of 13 START test long_messages ............................................... [RUN]
[0m14:11:16.068290 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:11:16.070859 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:11:16.061304 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m14:11:16.072534 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:11:16.102271 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m14:11:16.155915 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:11:16.158545 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:11:16.159362 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:11:16.160359 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:11:16.170945 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:11:16.182547 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:11:16.184700 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:11:16.185979 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:11:16.241049 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:11:16.246441 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:11:16.249177 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:11:16.250382 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:11:16.255255 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:11:16.265340 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:11:16.267973 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:11:16.270399 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:11:16.271906 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:11:16.273233 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: BEGIN
[0m14:11:16.275408 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: BEGIN
[0m14:11:16.277238 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:11:16.278377 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:11:16.279123 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:11:16.289816 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:11:16.291011 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m14:11:16.291907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:16.293394 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:11:16.437849 [debug] [Thread-4 (]: SQL status: BEGIN in 0.159 seconds
[0m14:11:16.439159 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:11:16.440584 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."fct_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:11:16.443745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m14:11:16.445210 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:11:16.446597 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:11:16.448098 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:11:16.464909 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: ROLLBACK
[0m14:11:16.466516 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: Close
[0m14:11:16.472373 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:11:16.476990 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:11:16.479032 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:11:16.480301 [debug] [Thread-2 (]: SQL status: BEGIN in 0.187 seconds
[0m14:11:16.481821 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:11:16.484911 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "postgres"."staging"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m14:11:16.470486 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fct_messages_channel ..................................... [[32mPASS[0m in 0.41s]
[0m14:11:16.487603 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:11:16.489262 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:11:16.492648 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:11:16.498059 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m14:11:16.483609 [error] [Thread-1 (]: 1 of 13 FAIL 12 long_messages .................................................. [[31mFAIL 12[0m in 0.41s]
[0m14:11:16.500215 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m14:11:16.502178 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:11:16.506066 [debug] [Thread-1 (]: Began running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:11:16.490855 [info ] [Thread-4 (]: 5 of 13 START test not_null_fct_messages_id .................................... [RUN]
[0m14:11:16.509568 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_channel.e99e1d225f, now test.medintel_models.not_null_fct_messages_id.a8dc118488)
[0m14:11:16.510963 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:11:16.504717 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.40s]
[0m14:11:16.526949 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:11:16.529198 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:11:16.508343 [info ] [Thread-1 (]: 6 of 13 START test not_null_fct_messages_message_date .......................... [RUN]
[0m14:11:16.540026 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:11:16.548326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.long_messages, now test.medintel_models.not_null_fct_messages_message_date.e5a43e40df)
[0m14:11:16.542723 [info ] [Thread-2 (]: 7 of 13 START test not_null_stg_telegram_messages_channel ...................... [RUN]
[0m14:11:16.551046 [debug] [Thread-3 (]: SQL status: BEGIN in 0.261 seconds
[0m14:11:16.553320 [debug] [Thread-1 (]: Began compiling node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:11:16.555029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medintel_models.not_null_stg_telegram_messages_channel.4874862192)
[0m14:11:16.556304 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:11:16.570505 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:11:16.571968 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:11:16.573649 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:11:16.577500 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_dates_date.e2decc9d39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "postgres"."staging"."dim_dates"
where date is null



  
  
      
    ) dbt_internal_test
[0m14:11:16.679162 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:11:16.690213 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:11:16.692341 [debug] [Thread-1 (]: Began executing node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:11:16.702999 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:11:16.705886 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m14:11:16.709200 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:11:16.710461 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:11:16.715748 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: ROLLBACK
[0m14:11:16.724658 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: BEGIN
[0m14:11:16.723141 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:11:16.726257 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: Close
[0m14:11:16.727720 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:16.730472 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:11:16.735927 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: BEGIN
[0m14:11:16.737327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:16.740606 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:11:16.742871 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: BEGIN
[0m14:11:16.744163 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:16.733479 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_dates_date ........................................... [[32mPASS[0m in 0.67s]
[0m14:11:16.759281 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:11:16.760540 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:11:16.762136 [info ] [Thread-3 (]: 8 of 13 START test not_null_stg_telegram_messages_id ........................... [RUN]
[0m14:11:16.773258 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_dates_date.e2decc9d39, now test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m14:11:16.774516 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:11:16.786717 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:11:16.788983 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:11:16.798213 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:11:16.800596 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:11:16.824524 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m14:11:16.828446 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:16.983054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.154 seconds
[0m14:11:16.984664 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:11:16.986243 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:11:16.990761 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:11:16.994887 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m14:11:16.996137 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m14:11:16.997798 [info ] [Thread-3 (]: 8 of 13 PASS not_null_stg_telegram_messages_id ................................. [[32mPASS[0m in 0.22s]
[0m14:11:17.006054 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:11:17.007293 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:11:17.008338 [info ] [Thread-3 (]: 9 of 13 START test not_null_stg_telegram_messages_message_date ................. [RUN]
[0m14:11:17.019268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.282 seconds
[0m14:11:17.022139 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m14:11:17.023660 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:11:17.025008 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:11:17.026516 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."fct_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:11:17.032552 [debug] [Thread-2 (]: SQL status: BEGIN in 0.288 seconds
[0m14:11:17.041449 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:11:17.042849 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:11:17.044181 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."stg_telegram_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:11:17.046438 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:11:17.050776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:11:17.052198 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:11:17.060119 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:11:17.065009 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: ROLLBACK
[0m14:11:17.070099 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: ROLLBACK
[0m14:11:17.071664 [debug] [Thread-4 (]: SQL status: BEGIN in 0.344 seconds
[0m14:11:17.073444 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: Close
[0m14:11:17.074697 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:11:17.075734 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: Close
[0m14:11:17.077320 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_id.a8dc118488"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."fct_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:11:17.085509 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:11:17.090167 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: ROLLBACK
[0m14:11:17.091636 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:11:17.082371 [info ] [Thread-2 (]: 7 of 13 PASS not_null_stg_telegram_messages_channel ............................ [[32mPASS[0m in 0.52s]
[0m14:11:17.093382 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: BEGIN
[0m14:11:17.095604 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: Close
[0m14:11:17.097874 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:11:17.083953 [info ] [Thread-1 (]: 6 of 13 PASS not_null_fct_messages_message_date ................................ [[32mPASS[0m in 0.54s]
[0m14:11:17.099919 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:17.101813 [debug] [Thread-2 (]: Began running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:11:17.105404 [debug] [Thread-1 (]: Finished running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:11:17.103635 [info ] [Thread-4 (]: 5 of 13 PASS not_null_fct_messages_id .......................................... [[32mPASS[0m in 0.59s]
[0m14:11:17.111180 [debug] [Thread-1 (]: Began running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:11:17.116797 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:11:17.119608 [debug] [Thread-4 (]: Began running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:11:17.107675 [info ] [Thread-2 (]: 10 of 13 START test unique_dim_channels_channel_name ........................... [RUN]
[0m14:11:17.123538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_channel.4874862192, now test.medintel_models.unique_dim_channels_channel_name.e57614abc8)
[0m14:11:17.124848 [debug] [Thread-2 (]: Began compiling node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:11:17.118336 [info ] [Thread-1 (]: 11 of 13 START test unique_dim_dates_date ...................................... [RUN]
[0m14:11:17.141769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_message_date.e5a43e40df, now test.medintel_models.unique_dim_dates_date.bab48d2068)
[0m14:11:17.145234 [debug] [Thread-1 (]: Began compiling node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:11:17.120784 [info ] [Thread-4 (]: 12 of 13 START test unique_fct_messages_id ..................................... [RUN]
[0m14:11:17.154354 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:11:17.174034 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:11:17.175422 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_id.a8dc118488, now test.medintel_models.unique_fct_messages_id.e6be0d3724)
[0m14:11:17.177463 [debug] [Thread-4 (]: Began compiling node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:11:17.191459 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:11:17.193059 [debug] [Thread-1 (]: Began executing node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:11:17.204378 [debug] [Thread-2 (]: Began executing node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:11:17.205332 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:11:17.212684 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:11:17.215070 [debug] [Thread-4 (]: Began executing node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:11:17.222557 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:11:17.225176 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:11:17.227278 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m14:11:17.228732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:11:17.230813 [debug] [Thread-3 (]: SQL status: BEGIN in 0.131 seconds
[0m14:11:17.232237 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:11:17.233499 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:11:17.235045 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: BEGIN
[0m14:11:17.236710 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:11:17.238232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:17.239989 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:11:17.241773 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: BEGIN
[0m14:11:17.243380 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:11:17.244878 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:11:17.249075 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m14:11:17.250578 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m14:11:17.252559 [info ] [Thread-3 (]: 9 of 13 PASS not_null_stg_telegram_messages_message_date ....................... [[32mPASS[0m in 0.23s]
[0m14:11:17.262897 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:11:17.264371 [debug] [Thread-3 (]: Began running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:11:17.266493 [info ] [Thread-3 (]: 13 of 13 START test unique_stg_telegram_messages_id ............................ [RUN]
[0m14:11:17.280527 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a)
[0m14:11:17.282733 [debug] [Thread-3 (]: Began compiling node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:11:17.295288 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:11:17.298985 [debug] [Thread-3 (]: Began executing node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:11:17.324382 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:11:17.338502 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:11:17.339964 [debug] [Thread-3 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: BEGIN
[0m14:11:17.341144 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:11:17.412063 [debug] [Thread-2 (]: SQL status: BEGIN in 0.183 seconds
[0m14:11:17.413575 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:11:17.415212 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:11:17.417550 [debug] [Thread-4 (]: SQL status: BEGIN in 0.174 seconds
[0m14:11:17.418986 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:11:17.420159 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_fct_messages_id.e6be0d3724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."fct_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:11:17.421505 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:11:17.425974 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m14:11:17.427520 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:11:17.428891 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: Close
[0m14:11:17.430275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.192 seconds
[0m14:11:17.434046 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: ROLLBACK
[0m14:11:17.435220 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:11:17.436838 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_dates_date.bab48d2068"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_dates"
where date is not null
group by date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:11:17.439826 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: Close
[0m14:11:17.447517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:11:17.438732 [info ] [Thread-2 (]: 10 of 13 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.32s]
[0m14:11:17.452154 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: ROLLBACK
[0m14:11:17.454650 [debug] [Thread-2 (]: Finished running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:11:17.441420 [info ] [Thread-4 (]: 12 of 13 PASS unique_fct_messages_id ........................................... [[32mPASS[0m in 0.27s]
[0m14:11:17.456469 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m14:11:17.458005 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: Close
[0m14:11:17.460416 [debug] [Thread-4 (]: Finished running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:11:17.461816 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:11:17.466996 [debug] [Thread-3 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_telegram_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:11:17.475580 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:11:17.480715 [debug] [Thread-3 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: ROLLBACK
[0m14:11:17.465353 [info ] [Thread-1 (]: 11 of 13 PASS unique_dim_dates_date ............................................ [[32mPASS[0m in 0.32s]
[0m14:11:17.484420 [debug] [Thread-1 (]: Finished running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:11:17.485770 [debug] [Thread-3 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: Close
[0m14:11:17.488268 [info ] [Thread-3 (]: 13 of 13 PASS unique_stg_telegram_messages_id .................................. [[32mPASS[0m in 0.21s]
[0m14:11:17.495048 [debug] [Thread-3 (]: Finished running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:11:17.500547 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:17.502385 [debug] [MainThread]: On master: BEGIN
[0m14:11:17.503813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:17.604689 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m14:11:17.605804 [debug] [MainThread]: On master: COMMIT
[0m14:11:17.607000 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:17.608303 [debug] [MainThread]: On master: COMMIT
[0m14:11:17.609355 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:17.610288 [debug] [MainThread]: On master: Close
[0m14:11:17.611366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:17.612461 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:11:17.613681 [debug] [MainThread]: Connection 'test.medintel_models.unique_fct_messages_id.e6be0d3724' was properly closed.
[0m14:11:17.614232 [debug] [MainThread]: Connection 'test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a' was properly closed.
[0m14:11:17.615123 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_dates_date.bab48d2068' was properly closed.
[0m14:11:17.615592 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m14:11:17.616230 [info ] [MainThread]: 
[0m14:11:17.617959 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m14:11:17.625441 [debug] [MainThread]: Command end result
[0m14:11:17.690287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:11:17.695842 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:11:17.715033 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:11:17.715971 [info ] [MainThread]: 
[0m14:11:17.717811 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:11:17.719123 [info ] [MainThread]: 
[0m14:11:17.720469 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:11:17.722051 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:11:17.723340 [info ] [MainThread]: 
[0m14:11:17.725000 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:11:17.727847 [info ] [MainThread]: 
[0m14:11:17.730300 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=13
[0m14:11:17.739741 [debug] [MainThread]: Command `dbt test` failed at 14:11:17.738712 after 6.03 seconds
[0m14:11:17.740994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC77C1C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC797C5860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC797C57B0>]}
[0m14:11:17.742427 [debug] [MainThread]: Flushing usage events
[0m14:11:19.240975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:28.507512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057880FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020576829BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020579BF7C50>]}


============================== 14:13:28.518821 | 248412e8-35f3-4be9-942b-7728284a96cb ==============================
[0m14:13:28.518821 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:13:28.520870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:13:29.038933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020578EFBCE0>]}
[0m14:13:29.251769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020579C69F20>]}
[0m14:13:29.253997 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:13:29.965563 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:13:30.445660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:30.449559 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m14:13:32.406924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057B04FE50>]}
[0m14:13:32.941578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:13:32.948828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:13:33.033412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205786CBE30>]}
[0m14:13:33.035559 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:13:33.037117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020579A735B0>]}
[0m14:13:33.042310 [info ] [MainThread]: 
[0m14:13:33.043377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:33.044176 [info ] [MainThread]: 
[0m14:13:33.045516 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:33.073363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:13:33.303139 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:13:33.305502 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:13:33.306731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:33.510608 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.204 seconds
[0m14:13:33.514394 [debug] [ThreadPool]: On list_postgres: Close
[0m14:13:33.520569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:13:33.542676 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:13:33.543317 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:13:33.543792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:33.639304 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m14:13:33.640329 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:13:33.641367 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:13:33.655613 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m14:13:33.659708 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:13:33.660976 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:13:33.676953 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:33.678102 [debug] [MainThread]: On master: BEGIN
[0m14:13:33.679033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:33.808970 [debug] [MainThread]: SQL status: BEGIN in 0.130 seconds
[0m14:13:33.810040 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:33.811626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:33.834044 [debug] [MainThread]: SQL status: SELECT 4 in 0.021 seconds
[0m14:13:33.840376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057B6D4BB0>]}
[0m14:13:33.841585 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:33.842805 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:33.843805 [debug] [MainThread]: On master: BEGIN
[0m14:13:33.845213 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:13:33.846579 [debug] [MainThread]: On master: COMMIT
[0m14:13:33.847862 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:33.848981 [debug] [MainThread]: On master: COMMIT
[0m14:13:33.850139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:33.851184 [debug] [MainThread]: On master: Close
[0m14:13:33.886329 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m14:13:33.888127 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m14:13:33.891150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m14:13:33.892455 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m14:13:33.921536 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m14:13:33.935326 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m14:13:34.089063 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.stg_telegram_messages"
[0m14:13:34.093778 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:13:34.095187 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: BEGIN
[0m14:13:34.098508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:34.189462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m14:13:34.190649 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:13:34.191847 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  msg.id,
  msg.channel,
  CAST(msg.date AS TIMESTAMP) AS message_date,
  LENGTH(msg.text) AS message_length,
  msg.has_image,
  msg.image_path,
  msg.text
FROM "postgres"."raw"."telegram_messages" AS msg
WHERE LENGTH(msg.text) > 1
  );
[0m14:13:34.206368 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:13:34.226933 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:13:34.228354 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m14:13:34.231062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:34.241272 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:13:34.242634 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m14:13:34.244707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:34.317129 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:13:34.319206 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:13:34.320601 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:13:34.324625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:13:34.348615 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m14:13:34.371343 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:13:34.372851 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m14:13:34.378271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:13:34.386377 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: Close
[0m14:13:34.392305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057B5ADC10>]}
[0m14:13:34.394396 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.50s]
[0m14:13:34.400089 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m14:13:34.402557 [debug] [Thread-3 (]: Began running node model.medintel_models.dim_dates
[0m14:13:34.404566 [debug] [Thread-2 (]: Began running node model.medintel_models.dim_channels
[0m14:13:34.406263 [debug] [Thread-4 (]: Began running node model.medintel_models.fct_messages
[0m14:13:34.408247 [info ] [Thread-3 (]: 3 of 4 START sql view model staging.dim_dates .................................. [RUN]
[0m14:13:34.415642 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medintel_models.dim_dates'
[0m14:13:34.416991 [debug] [Thread-3 (]: Began compiling node model.medintel_models.dim_dates
[0m14:13:34.431731 [debug] [Thread-3 (]: Writing injected SQL for node "model.medintel_models.dim_dates"
[0m14:13:34.410184 [info ] [Thread-2 (]: 2 of 4 START sql view model staging.dim_channels ............................... [RUN]
[0m14:13:34.434273 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medintel_models.dim_channels'
[0m14:13:34.435511 [debug] [Thread-2 (]: Began compiling node model.medintel_models.dim_channels
[0m14:13:34.443532 [debug] [Thread-2 (]: Writing injected SQL for node "model.medintel_models.dim_channels"
[0m14:13:34.411816 [info ] [Thread-4 (]: 4 of 4 START sql view model staging.fct_messages ............................... [RUN]
[0m14:13:34.447890 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:13:34.449628 [debug] [Thread-3 (]: Began executing node model.medintel_models.dim_dates
[0m14:13:34.451060 [debug] [Thread-4 (]: Began compiling node model.medintel_models.fct_messages
[0m14:13:34.471474 [debug] [Thread-2 (]: Began executing node model.medintel_models.dim_channels
[0m14:13:34.475043 [debug] [Thread-3 (]: Writing runtime sql for node "model.medintel_models.dim_dates"
[0m14:13:34.486973 [debug] [Thread-4 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:13:34.501696 [debug] [Thread-2 (]: Writing runtime sql for node "model.medintel_models.dim_channels"
[0m14:13:34.504995 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:13:34.509618 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: BEGIN
[0m14:13:34.510931 [debug] [Thread-4 (]: Began executing node model.medintel_models.fct_messages
[0m14:13:34.512990 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:13:34.517626 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:13:34.529251 [debug] [Thread-4 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:13:34.532793 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: BEGIN
[0m14:13:34.536511 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:13:34.540493 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:13:34.541708 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:13:34.544435 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:13:34.666325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.123 seconds
[0m14:13:34.667979 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:13:34.669448 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  stg.message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
  );
[0m14:13:34.681030 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:13:34.690572 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:13:34.691871 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:13:34.693949 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:34.698981 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:13:34.700572 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:13:34.701971 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:13:34.705491 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:13:34.719653 [debug] [Thread-4 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:13:34.721810 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:13:34.722984 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:13:34.724623 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:13:34.729486 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: Close
[0m14:13:34.731547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057B4B3A10>]}
[0m14:13:34.758620 [debug] [Thread-3 (]: SQL status: BEGIN in 0.222 seconds
[0m14:13:34.759795 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:13:34.761029 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */

  create view "postgres"."staging"."dim_dates__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  );
[0m14:13:34.773681 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:13:34.782771 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:13:34.733512 [info ] [Thread-4 (]: 4 of 4 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m14:13:34.784483 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
alter table "postgres"."staging"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m14:13:34.786584 [debug] [Thread-4 (]: Finished running node model.medintel_models.fct_messages
[0m14:13:34.788919 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:34.793274 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m14:13:34.794704 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:13:34.796660 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m14:13:34.800765 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:13:34.808650 [debug] [Thread-3 (]: Applying DROP to: "postgres"."staging"."dim_dates__dbt_backup"
[0m14:13:34.811849 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:13:34.815279 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
drop view if exists "postgres"."staging"."dim_dates__dbt_backup" cascade
[0m14:13:34.817646 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:13:34.821863 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: Close
[0m14:13:34.824076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057B25F9D0>]}
[0m14:13:34.825807 [info ] [Thread-3 (]: 3 of 4 OK created sql view model staging.dim_dates ............................. [[32mCREATE VIEW[0m in 0.41s]
[0m14:13:34.842600 [debug] [Thread-3 (]: Finished running node model.medintel_models.dim_dates
[0m14:13:34.877549 [debug] [Thread-2 (]: SQL status: BEGIN in 0.360 seconds
[0m14:13:34.879152 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:13:34.881096 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */

  create view "postgres"."staging"."dim_channels__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  channel AS channel_name,
  NULL::TEXT AS channel_type -- Optional enrichment
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m14:13:34.892525 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:13:34.903147 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:13:34.904321 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
alter table "postgres"."staging"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m14:13:34.906315 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:34.911176 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m14:13:34.912827 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:13:34.914396 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m14:13:34.917219 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:13:34.924141 [debug] [Thread-2 (]: Applying DROP to: "postgres"."staging"."dim_channels__dbt_backup"
[0m14:13:34.926503 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:13:34.927904 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
drop view if exists "postgres"."staging"."dim_channels__dbt_backup" cascade
[0m14:13:34.929911 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:13:34.934853 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: Close
[0m14:13:34.937568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248412e8-35f3-4be9-942b-7728284a96cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057B67F250>]}
[0m14:13:34.939715 [info ] [Thread-2 (]: 2 of 4 OK created sql view model staging.dim_channels .......................... [[32mCREATE VIEW[0m in 0.50s]
[0m14:13:34.944588 [debug] [Thread-2 (]: Finished running node model.medintel_models.dim_channels
[0m14:13:34.951068 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:34.952077 [debug] [MainThread]: On master: BEGIN
[0m14:13:34.952931 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:35.203072 [debug] [MainThread]: SQL status: BEGIN in 0.250 seconds
[0m14:13:35.204324 [debug] [MainThread]: On master: COMMIT
[0m14:13:35.205576 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:35.206795 [debug] [MainThread]: On master: COMMIT
[0m14:13:35.208607 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:35.209917 [debug] [MainThread]: On master: Close
[0m14:13:35.211562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:35.213211 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:13:35.214494 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:13:35.215476 [debug] [MainThread]: Connection 'model.medintel_models.stg_telegram_messages' was properly closed.
[0m14:13:35.216496 [debug] [MainThread]: Connection 'model.medintel_models.dim_dates' was properly closed.
[0m14:13:35.217491 [debug] [MainThread]: Connection 'model.medintel_models.dim_channels' was properly closed.
[0m14:13:35.218565 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:13:35.219726 [info ] [MainThread]: 
[0m14:13:35.221132 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m14:13:35.225409 [debug] [MainThread]: Command end result
[0m14:13:35.341722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:13:35.351274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:13:35.382002 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:13:35.383383 [info ] [MainThread]: 
[0m14:13:35.385639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:35.387517 [info ] [MainThread]: 
[0m14:13:35.389624 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m14:13:35.393738 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:35.392932 after 7.27 seconds
[0m14:13:35.398831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057355DB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057AF884B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020579C052B0>]}
[0m14:13:35.400519 [debug] [MainThread]: Flushing usage events
[0m14:13:36.266622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:43.994474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DFF943A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DFE92DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D81DC7C50>]}


============================== 14:13:44.008655 | f6572aa0-331b-4e6e-8db9-4577eb9cc42d ==============================
[0m14:13:44.008655 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:13:44.011660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:13:44.744636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6572aa0-331b-4e6e-8db9-4577eb9cc42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D810CFCE0>]}
[0m14:13:44.999484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6572aa0-331b-4e6e-8db9-4577eb9cc42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D81E39F20>]}
[0m14:13:45.003458 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:13:45.704988 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:13:46.172224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:13:46.173703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:13:46.332526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6572aa0-331b-4e6e-8db9-4577eb9cc42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D81C53150>]}
[0m14:13:46.629684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:13:46.635016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:13:46.725891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6572aa0-331b-4e6e-8db9-4577eb9cc42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D8345E210>]}
[0m14:13:46.727681 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:13:46.729107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6572aa0-331b-4e6e-8db9-4577eb9cc42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D833C3850>]}
[0m14:13:46.733883 [info ] [MainThread]: 
[0m14:13:46.735156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:46.736671 [info ] [MainThread]: 
[0m14:13:46.738890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:46.762252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:13:46.990658 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:13:46.991397 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:13:46.992047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:47.081296 [debug] [ThreadPool]: SQL status: BEGIN in 0.089 seconds
[0m14:13:47.082322 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:13:47.083488 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:13:47.097067 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m14:13:47.100197 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:13:47.101412 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:13:47.116979 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:47.118177 [debug] [MainThread]: On master: BEGIN
[0m14:13:47.119100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:47.195294 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m14:13:47.196445 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:47.197470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:47.214880 [debug] [MainThread]: SQL status: SELECT 4 in 0.016 seconds
[0m14:13:47.219788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6572aa0-331b-4e6e-8db9-4577eb9cc42d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D83563EE0>]}
[0m14:13:47.220711 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:47.221745 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:47.222414 [debug] [MainThread]: On master: BEGIN
[0m14:13:47.223714 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:13:47.224722 [debug] [MainThread]: On master: COMMIT
[0m14:13:47.225628 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:47.226502 [debug] [MainThread]: On master: COMMIT
[0m14:13:47.227817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:47.229054 [debug] [MainThread]: On master: Close
[0m14:13:47.239183 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:13:47.240761 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:13:47.241449 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:13:47.242070 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:13:47.243028 [info ] [Thread-1 (]: 1 of 13 START test long_messages ............................................... [RUN]
[0m14:13:47.244114 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_dates_date ..................................... [RUN]
[0m14:13:47.250067 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:13:47.245895 [info ] [Thread-4 (]: 4 of 13 START test not_null_fct_messages_channel ............................... [RUN]
[0m14:13:47.253009 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_dates_date.e2decc9d39'
[0m14:13:47.247587 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m14:13:47.255026 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:13:47.257852 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medintel_models.not_null_fct_messages_channel.e99e1d225f'
[0m14:13:47.259224 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:13:47.261038 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m14:13:47.288353 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:13:47.291116 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:13:47.324335 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:13:47.332223 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:13:47.350334 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:13:47.359726 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:13:47.362541 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:13:47.372404 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:13:47.435484 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:13:47.446651 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:13:47.448293 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:13:47.464510 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:13:47.472822 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:13:47.481640 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:13:47.485924 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:13:47.487452 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m14:13:47.488591 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:13:47.490131 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:13:47.491794 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:13:47.493178 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:13:47.494667 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:13:47.496083 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:47.497359 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: BEGIN
[0m14:13:47.500612 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:13:47.498939 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: BEGIN
[0m14:13:47.502384 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:13:47.576324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.088 seconds
[0m14:13:47.577548 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:13:47.578930 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "postgres"."staging"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m14:13:47.592242 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:13:47.605159 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m14:13:47.607026 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m14:13:47.609076 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.35s]
[0m14:13:47.619102 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:13:47.620466 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:13:47.651259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m14:13:47.652491 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:13:47.653916 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:13:47.622094 [info ] [Thread-2 (]: 5 of 13 START test not_null_fct_messages_id .................................... [RUN]
[0m14:13:47.657797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medintel_models.not_null_fct_messages_id.a8dc118488)
[0m14:13:47.659277 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:13:47.673048 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m14:13:47.677705 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:13:47.679501 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:13:47.671583 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:13:47.685414 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:13:47.698293 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:13:47.700757 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:13:47.702207 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: BEGIN
[0m14:13:47.703362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:13:47.725879 [debug] [Thread-3 (]: SQL status: BEGIN in 0.223 seconds
[0m14:13:47.730493 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:13:47.731808 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_dates_date.e2decc9d39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "postgres"."staging"."dim_dates"
where date is null



  
  
      
    ) dbt_internal_test
[0m14:13:47.738386 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:13:47.745525 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: ROLLBACK
[0m14:13:47.682449 [error] [Thread-1 (]: 1 of 13 FAIL 12 long_messages .................................................. [[31mFAIL 12[0m in 0.43s]
[0m14:13:47.748448 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:13:47.749968 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: Close
[0m14:13:47.751530 [debug] [Thread-1 (]: Began running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:13:47.753372 [info ] [Thread-1 (]: 6 of 13 START test not_null_fct_messages_message_date .......................... [RUN]
[0m14:13:47.765804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.long_messages, now test.medintel_models.not_null_fct_messages_message_date.e5a43e40df)
[0m14:13:47.767290 [debug] [Thread-1 (]: Began compiling node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:13:47.931825 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:13:47.755120 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_dates_date ........................................... [[32mPASS[0m in 0.50s]
[0m14:13:47.933778 [debug] [Thread-2 (]: SQL status: BEGIN in 0.230 seconds
[0m14:13:47.936431 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:13:47.938254 [debug] [Thread-4 (]: SQL status: BEGIN in 0.437 seconds
[0m14:13:47.939852 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:13:47.941317 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:13:47.942943 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:13:47.944514 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_id.a8dc118488"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."fct_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:13:47.945875 [debug] [Thread-1 (]: Began executing node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:13:47.949235 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."fct_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:13:47.947851 [info ] [Thread-3 (]: 7 of 13 START test not_null_stg_telegram_messages_channel ...................... [RUN]
[0m14:13:47.958266 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:13:47.959153 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:13:47.960360 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_dates_date.e2decc9d39, now test.medintel_models.not_null_stg_telegram_messages_channel.4874862192)
[0m14:13:47.965608 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: ROLLBACK
[0m14:13:47.967019 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:13:47.968722 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:13:47.974580 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: ROLLBACK
[0m14:13:47.975964 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: Close
[0m14:13:47.985079 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:13:47.988478 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:13:47.991924 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: Close
[0m14:13:47.987221 [info ] [Thread-2 (]: 5 of 13 PASS not_null_fct_messages_id .......................................... [[32mPASS[0m in 0.33s]
[0m14:13:47.993841 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: BEGIN
[0m14:13:47.996152 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:13:48.002125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:48.004864 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:13:48.000065 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fct_messages_channel ..................................... [[32mPASS[0m in 0.74s]
[0m14:13:48.010939 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:13:48.009633 [info ] [Thread-2 (]: 8 of 13 START test not_null_stg_telegram_messages_id ........................... [RUN]
[0m14:13:48.014070 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:13:48.021944 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:13:48.025403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_id.a8dc118488, now test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m14:13:48.027098 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:13:48.028924 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:13:48.032635 [info ] [Thread-4 (]: 9 of 13 START test not_null_stg_telegram_messages_message_date ................. [RUN]
[0m14:13:48.046820 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_channel.e99e1d225f, now test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m14:13:48.049033 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:13:48.050415 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:13:48.069689 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:13:48.071106 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:13:48.074459 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: BEGIN
[0m14:13:48.075877 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:13:48.078152 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:13:48.088719 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:13:48.102016 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:13:48.099507 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:13:48.103347 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m14:13:48.111417 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:13:48.112736 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:13:48.115220 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:13:48.118628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.117 seconds
[0m14:13:48.120149 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: BEGIN
[0m14:13:48.121729 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:13:48.123674 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:13:48.125134 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."fct_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:13:48.131073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:13:48.135715 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: ROLLBACK
[0m14:13:48.137566 [debug] [Thread-1 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: Close
[0m14:13:48.141715 [info ] [Thread-1 (]: 6 of 13 PASS not_null_fct_messages_message_date ................................ [[32mPASS[0m in 0.38s]
[0m14:13:48.149519 [debug] [Thread-1 (]: Finished running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:13:48.150862 [debug] [Thread-1 (]: Began running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:13:48.152301 [info ] [Thread-1 (]: 10 of 13 START test unique_dim_channels_channel_name ........................... [RUN]
[0m14:13:48.178810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_message_date.e5a43e40df, now test.medintel_models.unique_dim_channels_channel_name.e57614abc8)
[0m14:13:48.179972 [debug] [Thread-1 (]: Began compiling node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:13:48.202575 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:13:48.204835 [debug] [Thread-3 (]: SQL status: BEGIN in 0.129 seconds
[0m14:13:48.206881 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:13:48.208600 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."stg_telegram_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:13:48.210513 [debug] [Thread-1 (]: Began executing node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:13:48.228737 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m14:13:48.243330 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:13:48.249148 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: ROLLBACK
[0m14:13:48.251270 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: Close
[0m14:13:48.255252 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:13:48.258024 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m14:13:48.259831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:48.268992 [debug] [Thread-4 (]: SQL status: BEGIN in 0.145 seconds
[0m14:13:48.270422 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:13:48.272909 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:13:48.253205 [info ] [Thread-3 (]: 7 of 13 PASS not_null_stg_telegram_messages_channel ............................ [[32mPASS[0m in 0.29s]
[0m14:13:48.275570 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:13:48.278569 [debug] [Thread-3 (]: Began running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:13:48.281885 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:13:48.287106 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m14:13:48.289527 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m14:13:48.280503 [info ] [Thread-3 (]: 11 of 13 START test unique_dim_dates_date ...................................... [RUN]
[0m14:13:48.304024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_channel.4874862192, now test.medintel_models.unique_dim_dates_date.bab48d2068)
[0m14:13:48.306897 [debug] [Thread-3 (]: Began compiling node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:13:48.328621 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:13:48.332024 [debug] [Thread-3 (]: Began executing node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:13:48.365493 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:13:48.368201 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:13:48.370008 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: BEGIN
[0m14:13:48.371218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:13:48.292760 [info ] [Thread-4 (]: 9 of 13 PASS not_null_stg_telegram_messages_message_date ....................... [[32mPASS[0m in 0.24s]
[0m14:13:48.377443 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:13:48.379506 [debug] [Thread-4 (]: Began running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:13:48.381453 [info ] [Thread-4 (]: 12 of 13 START test unique_fct_messages_id ..................................... [RUN]
[0m14:13:48.386072 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medintel_models.unique_fct_messages_id.e6be0d3724)
[0m14:13:48.387523 [debug] [Thread-4 (]: Began compiling node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:13:48.400622 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:13:48.402727 [debug] [Thread-4 (]: Began executing node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:13:48.412857 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:13:48.420440 [debug] [Thread-2 (]: SQL status: BEGIN in 0.308 seconds
[0m14:13:48.421786 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:13:48.423601 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:13:48.428558 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:13:48.433322 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m14:13:48.434806 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m14:13:48.440812 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:13:48.443028 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: BEGIN
[0m14:13:48.446387 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:13:48.437308 [info ] [Thread-2 (]: 8 of 13 PASS not_null_stg_telegram_messages_id ................................. [[32mPASS[0m in 0.41s]
[0m14:13:48.458067 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:13:48.459552 [debug] [Thread-2 (]: Began running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:13:48.476526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m14:13:48.478023 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:13:48.480409 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:48.461091 [info ] [Thread-2 (]: 13 of 13 START test unique_stg_telegram_messages_id ............................ [RUN]
[0m14:13:48.483590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a)
[0m14:13:48.484996 [debug] [Thread-2 (]: Began compiling node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:13:48.500449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m14:13:48.504992 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m14:13:48.509975 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:13:48.512699 [debug] [Thread-1 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: Close
[0m14:13:48.519894 [debug] [Thread-2 (]: Began executing node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:13:48.518208 [info ] [Thread-1 (]: 10 of 13 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.34s]
[0m14:13:48.543746 [debug] [Thread-1 (]: Finished running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:13:48.548501 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:13:48.550477 [debug] [Thread-3 (]: SQL status: BEGIN in 0.179 seconds
[0m14:13:48.552312 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:13:48.553729 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_dates_date.bab48d2068"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_dates"
where date is not null
group by date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:48.557247 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:13:48.558603 [debug] [Thread-2 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: BEGIN
[0m14:13:48.560370 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:13:48.565175 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:13:48.570488 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: ROLLBACK
[0m14:13:48.572821 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: Close
[0m14:13:48.579657 [info ] [Thread-3 (]: 11 of 13 PASS unique_dim_dates_date ............................................ [[32mPASS[0m in 0.27s]
[0m14:13:48.654539 [debug] [Thread-3 (]: Finished running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:13:48.749717 [debug] [Thread-4 (]: SQL status: BEGIN in 0.303 seconds
[0m14:13:48.751139 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:13:48.752664 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_fct_messages_id.e6be0d3724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."fct_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:48.762058 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:13:48.766223 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: ROLLBACK
[0m14:13:48.767801 [debug] [Thread-4 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: Close
[0m14:13:48.770360 [info ] [Thread-4 (]: 12 of 13 PASS unique_fct_messages_id ........................................... [[32mPASS[0m in 0.38s]
[0m14:13:48.775192 [debug] [Thread-4 (]: Finished running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:13:48.807849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.248 seconds
[0m14:13:48.809317 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:13:48.810952 [debug] [Thread-2 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_telegram_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:13:48.819743 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:13:48.825165 [debug] [Thread-2 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: ROLLBACK
[0m14:13:48.826843 [debug] [Thread-2 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: Close
[0m14:13:48.829328 [info ] [Thread-2 (]: 13 of 13 PASS unique_stg_telegram_messages_id .................................. [[32mPASS[0m in 0.35s]
[0m14:13:48.833356 [debug] [Thread-2 (]: Finished running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:13:48.837979 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:48.839015 [debug] [MainThread]: On master: BEGIN
[0m14:13:48.839494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:48.920405 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m14:13:48.921444 [debug] [MainThread]: On master: COMMIT
[0m14:13:48.922440 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:48.922957 [debug] [MainThread]: On master: COMMIT
[0m14:13:48.923685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:48.924607 [debug] [MainThread]: On master: Close
[0m14:13:48.925839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:48.927121 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:13:48.928353 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m14:13:48.929063 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_dates_date.bab48d2068' was properly closed.
[0m14:13:48.930051 [debug] [MainThread]: Connection 'test.medintel_models.unique_fct_messages_id.e6be0d3724' was properly closed.
[0m14:13:48.930873 [debug] [MainThread]: Connection 'test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a' was properly closed.
[0m14:13:48.931822 [info ] [MainThread]: 
[0m14:13:48.933464 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m14:13:48.940968 [debug] [MainThread]: Command end result
[0m14:13:49.028041 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:13:49.033570 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:13:49.059047 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:13:49.059977 [info ] [MainThread]: 
[0m14:13:49.061183 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:13:49.062358 [info ] [MainThread]: 
[0m14:13:49.063556 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:13:49.064689 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:13:49.065687 [info ] [MainThread]: 
[0m14:13:49.067558 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:13:49.069882 [info ] [MainThread]: 
[0m14:13:49.072225 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=13
[0m14:13:49.074411 [debug] [MainThread]: Command `dbt test` failed at 14:13:49.074172 after 5.40 seconds
[0m14:13:49.076183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D81D7C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D83905FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D83905F40>]}
[0m14:13:49.077525 [debug] [MainThread]: Flushing usage events
[0m14:13:50.128092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:19.105866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023671ED3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002366FEEDBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236732C7C50>]}


============================== 14:15:19.119769 | a52fca3f-2fa0-4c91-b93d-5b59e6918111 ==============================
[0m14:15:19.119769 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:15:19.123359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_messages', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:20.075013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a52fca3f-2fa0-4c91-b93d-5b59e6918111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236725CBCE0>]}
[0m14:15:20.398383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a52fca3f-2fa0-4c91-b93d-5b59e6918111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023673339F20>]}
[0m14:15:20.401988 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:15:21.321097 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:15:21.985899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:21.990163 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\fct_messages.sql
[0m14:15:23.879280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a52fca3f-2fa0-4c91-b93d-5b59e6918111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023674B74450>]}
[0m14:15:24.496969 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:15:24.510772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:15:24.595586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a52fca3f-2fa0-4c91-b93d-5b59e6918111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023672BECF50>]}
[0m14:15:24.596873 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:15:24.598837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a52fca3f-2fa0-4c91-b93d-5b59e6918111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236732AE510>]}
[0m14:15:24.603553 [info ] [MainThread]: 
[0m14:15:24.604958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:24.606388 [info ] [MainThread]: 
[0m14:15:24.608739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:24.611514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:15:24.866936 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:15:24.868472 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:15:24.869185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:25.002891 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.134 seconds
[0m14:15:25.007305 [debug] [ThreadPool]: On list_postgres: Close
[0m14:15:25.026739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:15:25.047771 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:15:25.048439 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:15:25.049445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:25.132959 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m14:15:25.134095 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:15:25.135255 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:15:25.150978 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m14:15:25.155601 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:15:25.157012 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:15:25.173224 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.174853 [debug] [MainThread]: On master: BEGIN
[0m14:15:25.176636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:25.274441 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m14:15:25.275677 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.277444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:25.299773 [debug] [MainThread]: SQL status: SELECT 4 in 0.021 seconds
[0m14:15:25.306253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a52fca3f-2fa0-4c91-b93d-5b59e6918111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023674DA0BB0>]}
[0m14:15:25.307947 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:25.309475 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.310746 [debug] [MainThread]: On master: BEGIN
[0m14:15:25.312655 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:15:25.313338 [debug] [MainThread]: On master: COMMIT
[0m14:15:25.313898 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.314371 [debug] [MainThread]: On master: COMMIT
[0m14:15:25.315130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:25.316119 [debug] [MainThread]: On master: Close
[0m14:15:25.329401 [debug] [Thread-1 (]: Began running node model.medintel_models.fct_messages
[0m14:15:25.331185 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.fct_messages ............................... [RUN]
[0m14:15:25.333716 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:15:25.335338 [debug] [Thread-1 (]: Began compiling node model.medintel_models.fct_messages
[0m14:15:25.362886 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:15:25.374124 [debug] [Thread-1 (]: Began executing node model.medintel_models.fct_messages
[0m14:15:25.546817 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:15:25.549269 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:15:25.550906 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:15:25.553391 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:25.676524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.122 seconds
[0m14:15:25.678622 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:15:25.680229 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  stg.message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
WHERE stg.message_length > 1
  );
[0m14:15:25.697422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m14:15:25.725624 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:15:25.727169 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages" rename to "fct_messages__dbt_backup"
[0m14:15:25.729725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:25.741259 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:15:25.743457 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:15:25.745540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:25.804397 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:15:25.805805 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:15:25.807061 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:15:25.810451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:15:25.833208 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:15:25.852902 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:15:25.854489 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:15:25.858806 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:15:25.867436 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: Close
[0m14:15:25.873672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a52fca3f-2fa0-4c91-b93d-5b59e6918111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023674C5DE50>]}
[0m14:15:25.876399 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.54s]
[0m14:15:25.881453 [debug] [Thread-1 (]: Finished running node model.medintel_models.fct_messages
[0m14:15:25.884994 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.886327 [debug] [MainThread]: On master: BEGIN
[0m14:15:25.887904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:25.988804 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m14:15:25.989947 [debug] [MainThread]: On master: COMMIT
[0m14:15:25.991320 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.993096 [debug] [MainThread]: On master: COMMIT
[0m14:15:25.994555 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:25.995908 [debug] [MainThread]: On master: Close
[0m14:15:25.997720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:25.998939 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:15:26.000081 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:15:26.001166 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:15:26.002398 [info ] [MainThread]: 
[0m14:15:26.006477 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m14:15:26.009858 [debug] [MainThread]: Command end result
[0m14:15:26.118370 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:15:26.138866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:15:26.176332 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:15:26.177444 [info ] [MainThread]: 
[0m14:15:26.179862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:26.182425 [info ] [MainThread]: 
[0m14:15:26.184531 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:15:26.194261 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:26.193524 after 7.83 seconds
[0m14:15:26.195540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023674B6B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367449EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002367449C0F0>]}
[0m14:15:26.197261 [debug] [MainThread]: Flushing usage events
[0m14:15:27.301748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:36.294620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655AFBFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026558FD9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655C3A3C50>]}


============================== 14:15:36.303604 | 40b76f6a-8233-4ed1-b57a-0d658e706257 ==============================
[0m14:15:36.303604 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:15:36.305469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:15:37.217954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40b76f6a-8233-4ed1-b57a-0d658e706257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655B6B3CE0>]}
[0m14:15:37.481650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40b76f6a-8233-4ed1-b57a-0d658e706257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655C419F20>]}
[0m14:15:37.485790 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:15:38.804555 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:15:39.567574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:39.568781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:39.784460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40b76f6a-8233-4ed1-b57a-0d658e706257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655C233150>]}
[0m14:15:40.266702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:15:40.273737 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:15:40.378162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40b76f6a-8233-4ed1-b57a-0d658e706257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655DA66210>]}
[0m14:15:40.379671 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:15:40.382494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40b76f6a-8233-4ed1-b57a-0d658e706257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655D9D7770>]}
[0m14:15:40.388645 [info ] [MainThread]: 
[0m14:15:40.391149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:40.393435 [info ] [MainThread]: 
[0m14:15:40.396459 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:40.420495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:15:40.661102 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:15:40.663747 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:15:40.664830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:40.818188 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m14:15:40.820427 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:15:40.823167 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:15:40.843013 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m14:15:40.849250 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:15:40.851352 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:15:40.874089 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:40.875919 [debug] [MainThread]: On master: BEGIN
[0m14:15:40.877014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:41.075892 [debug] [MainThread]: SQL status: BEGIN in 0.199 seconds
[0m14:15:41.077282 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:41.079013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:41.103129 [debug] [MainThread]: SQL status: SELECT 4 in 0.022 seconds
[0m14:15:41.110137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40b76f6a-8233-4ed1-b57a-0d658e706257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655DB63EE0>]}
[0m14:15:41.111607 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:41.113452 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:41.114653 [debug] [MainThread]: On master: BEGIN
[0m14:15:41.116505 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:41.117913 [debug] [MainThread]: On master: COMMIT
[0m14:15:41.119277 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:41.120521 [debug] [MainThread]: On master: COMMIT
[0m14:15:41.121897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:41.123117 [debug] [MainThread]: On master: Close
[0m14:15:41.145631 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:15:41.147738 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:15:41.149474 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:15:41.152950 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:15:41.154689 [info ] [Thread-1 (]: 1 of 13 START test long_messages ............................................... [RUN]
[0m14:15:41.155917 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_dates_date ..................................... [RUN]
[0m14:15:41.160458 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:15:41.162245 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_dates_date.e2decc9d39'
[0m14:15:41.157513 [info ] [Thread-4 (]: 4 of 13 START test not_null_fct_messages_channel ............................... [RUN]
[0m14:15:41.164249 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:15:41.165577 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:15:41.170026 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medintel_models.not_null_fct_messages_channel.e99e1d225f'
[0m14:15:41.158981 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m14:15:41.193840 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:15:41.210136 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:15:41.273923 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m14:15:41.277939 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:15:41.296122 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:15:41.297408 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:15:41.306737 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:15:41.335397 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:15:41.397740 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:15:41.436481 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:15:41.442403 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:15:41.489153 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:15:41.504873 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:15:41.509082 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:15:41.527745 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:15:41.544294 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:15:41.545720 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:15:41.547088 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:15:41.548454 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: BEGIN
[0m14:15:41.550533 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:15:41.553496 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:15:41.555906 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: BEGIN
[0m14:15:41.557700 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:15:41.559326 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m14:15:41.561328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:41.562850 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:15:41.564733 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:15:41.706188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.141 seconds
[0m14:15:41.707578 [debug] [Thread-3 (]: SQL status: BEGIN in 0.145 seconds
[0m14:15:41.708828 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:15:41.710249 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:15:41.711690 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "postgres"."staging"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m14:15:41.713519 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_dates_date.e2decc9d39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "postgres"."staging"."dim_dates"
where date is null



  
  
      
    ) dbt_internal_test
[0m14:15:41.720553 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:15:41.722230 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:15:41.739406 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m14:15:41.743965 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: ROLLBACK
[0m14:15:41.745593 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m14:15:41.746930 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: Close
[0m14:15:41.748832 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.48s]
[0m14:15:41.762771 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:15:41.764274 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:15:41.750440 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_dates_date ........................................... [[32mPASS[0m in 0.59s]
[0m14:15:41.773100 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:15:41.765870 [info ] [Thread-2 (]: 5 of 13 START test not_null_fct_messages_id .................................... [RUN]
[0m14:15:41.775037 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:15:41.776522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medintel_models.not_null_fct_messages_id.a8dc118488)
[0m14:15:41.779255 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:15:41.795419 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:15:41.797597 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:15:41.819766 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:15:41.821713 [debug] [Thread-4 (]: SQL status: BEGIN in 0.264 seconds
[0m14:15:41.823675 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:15:41.825179 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."fct_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:15:41.827446 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:15:41.829144 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: BEGIN
[0m14:15:41.831530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:15:41.833567 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:15:41.839452 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: ROLLBACK
[0m14:15:41.840747 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: Close
[0m14:15:41.778072 [info ] [Thread-3 (]: 6 of 13 START test not_null_fct_messages_message_date .......................... [RUN]
[0m14:15:41.844851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_dates_date.e2decc9d39, now test.medintel_models.not_null_fct_messages_message_date.e5a43e40df)
[0m14:15:41.846262 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:15:42.025209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.464 seconds
[0m14:15:41.842352 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fct_messages_channel ..................................... [[32mPASS[0m in 0.67s]
[0m14:15:42.028310 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:15:42.029898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.198 seconds
[0m14:15:42.031184 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:15:42.035365 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:15:42.037266 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:15:42.039127 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:15:42.041369 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:15:42.043275 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_id.a8dc118488"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."fct_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:15:42.044945 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:15:42.056830 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:15:42.058733 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:15:42.046182 [info ] [Thread-4 (]: 7 of 13 START test not_null_stg_telegram_messages_channel ...................... [RUN]
[0m14:15:42.063731 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:15:42.064897 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m14:15:42.067861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_channel.e99e1d225f, now test.medintel_models.not_null_stg_telegram_messages_channel.4874862192)
[0m14:15:42.074474 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: ROLLBACK
[0m14:15:42.077643 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:15:42.075817 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:15:42.088599 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: Close
[0m14:15:42.093889 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:15:42.097850 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:15:42.095932 [error] [Thread-1 (]: 1 of 13 FAIL 12 long_messages .................................................. [[31mFAIL 12[0m in 0.94s]
[0m14:15:42.103838 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: BEGIN
[0m14:15:42.108103 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:15:42.109664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:15:42.110998 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:15:42.101469 [info ] [Thread-2 (]: 5 of 13 PASS not_null_fct_messages_id .......................................... [[32mPASS[0m in 0.32s]
[0m14:15:42.112873 [debug] [Thread-1 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:15:42.122633 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:15:42.134838 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:15:42.129626 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:15:42.140389 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:15:42.141728 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: BEGIN
[0m14:15:42.143301 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:15:42.131969 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_telegram_messages_id ........................... [RUN]
[0m14:15:42.149085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.long_messages, now test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m14:15:42.153809 [debug] [Thread-1 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:15:42.169521 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:15:42.136487 [info ] [Thread-2 (]: 9 of 13 START test not_null_stg_telegram_messages_message_date ................. [RUN]
[0m14:15:42.189260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_id.a8dc118488, now test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m14:15:42.191128 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:15:42.173818 [debug] [Thread-1 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:15:42.212127 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:15:42.221477 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:15:42.224781 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:15:42.255647 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:15:42.259010 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:15:42.260280 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: BEGIN
[0m14:15:42.263868 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:15:42.270102 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:15:42.271683 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m14:15:42.273292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:42.308482 [debug] [Thread-3 (]: SQL status: BEGIN in 0.199 seconds
[0m14:15:42.310033 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:15:42.312470 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."fct_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:15:42.318439 [debug] [Thread-4 (]: SQL status: BEGIN in 0.175 seconds
[0m14:15:42.320680 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:15:42.322373 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:15:42.324146 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."stg_telegram_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:15:42.328668 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: ROLLBACK
[0m14:15:42.330334 [debug] [Thread-3 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: Close
[0m14:15:42.339266 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m14:15:42.344166 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: ROLLBACK
[0m14:15:42.346037 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: Close
[0m14:15:42.335715 [info ] [Thread-3 (]: 6 of 13 PASS not_null_fct_messages_message_date ................................ [[32mPASS[0m in 0.49s]
[0m14:15:42.355804 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:15:42.357351 [debug] [Thread-3 (]: Began running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:15:42.348093 [info ] [Thread-4 (]: 7 of 13 PASS not_null_stg_telegram_messages_channel ............................ [[32mPASS[0m in 0.28s]
[0m14:15:42.420231 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:15:42.422268 [debug] [Thread-4 (]: Began running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:15:42.359501 [info ] [Thread-3 (]: 10 of 13 START test unique_dim_channels_channel_name ........................... [RUN]
[0m14:15:42.431425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_message_date.e5a43e40df, now test.medintel_models.unique_dim_channels_channel_name.e57614abc8)
[0m14:15:42.433104 [debug] [Thread-3 (]: Began compiling node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:15:42.464751 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:15:42.469178 [debug] [Thread-3 (]: Began executing node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:15:42.472733 [debug] [Thread-2 (]: SQL status: BEGIN in 0.209 seconds
[0m14:15:42.490927 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:15:42.492127 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:15:42.509493 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:15:42.423879 [info ] [Thread-4 (]: 11 of 13 START test unique_dim_dates_date ...................................... [RUN]
[0m14:15:42.511448 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m14:15:42.513205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_channel.4874862192, now test.medintel_models.unique_dim_dates_date.bab48d2068)
[0m14:15:42.518533 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m14:15:42.520365 [debug] [Thread-4 (]: Began compiling node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:15:42.521979 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:15:42.536989 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:15:42.538640 [debug] [Thread-2 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m14:15:42.540218 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m14:15:42.541987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:15:42.545794 [debug] [Thread-4 (]: Began executing node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:15:42.555150 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:15:42.544122 [info ] [Thread-2 (]: 9 of 13 PASS not_null_stg_telegram_messages_message_date ....................... [[32mPASS[0m in 0.35s]
[0m14:15:42.557902 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:15:42.559392 [debug] [Thread-2 (]: Began running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:15:42.563980 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:15:42.565487 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: BEGIN
[0m14:15:42.572708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.299 seconds
[0m14:15:42.562522 [info ] [Thread-2 (]: 12 of 13 START test unique_fct_messages_id ..................................... [RUN]
[0m14:15:42.574504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:15:42.576630 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:15:42.578666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medintel_models.unique_fct_messages_id.e6be0d3724)
[0m14:15:42.581326 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:15:42.586065 [debug] [Thread-2 (]: Began compiling node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:15:42.603333 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:15:42.605025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m14:15:42.610625 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m14:15:42.613184 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m14:15:42.618459 [debug] [Thread-2 (]: Began executing node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:15:42.615382 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_telegram_messages_id ................................. [[32mPASS[0m in 0.47s]
[0m14:15:42.640793 [debug] [Thread-1 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:15:42.642150 [debug] [Thread-1 (]: Began running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:15:42.646945 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:15:42.653754 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:15:42.655649 [debug] [Thread-2 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: BEGIN
[0m14:15:42.657493 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:15:42.643504 [info ] [Thread-1 (]: 13 of 13 START test unique_stg_telegram_messages_id ............................ [RUN]
[0m14:15:42.674860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a)
[0m14:15:42.676097 [debug] [Thread-1 (]: Began compiling node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:15:42.690358 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:15:42.692814 [debug] [Thread-1 (]: Began executing node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:15:42.706094 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:15:42.709451 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:15:42.711252 [debug] [Thread-1 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: BEGIN
[0m14:15:42.712581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:42.727867 [debug] [Thread-4 (]: SQL status: BEGIN in 0.153 seconds
[0m14:15:42.729443 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:15:42.731531 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_dates_date.bab48d2068"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_dates"
where date is not null
group by date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:15:42.743382 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m14:15:42.748076 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: ROLLBACK
[0m14:15:42.750501 [debug] [Thread-4 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: Close
[0m14:15:42.752498 [info ] [Thread-4 (]: 11 of 13 PASS unique_dim_dates_date ............................................ [[32mPASS[0m in 0.24s]
[0m14:15:42.786908 [debug] [Thread-4 (]: Finished running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:15:42.820281 [debug] [Thread-3 (]: SQL status: BEGIN in 0.278 seconds
[0m14:15:42.821710 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:15:42.823180 [debug] [Thread-2 (]: SQL status: BEGIN in 0.166 seconds
[0m14:15:42.824741 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:15:42.826191 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:15:42.828176 [debug] [Thread-2 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_fct_messages_id.e6be0d3724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."fct_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:15:42.835614 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:15:42.840310 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m14:15:42.841787 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:15:42.843213 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: Close
[0m14:15:42.847795 [debug] [Thread-2 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: ROLLBACK
[0m14:15:42.849799 [debug] [Thread-2 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: Close
[0m14:15:42.853561 [info ] [Thread-3 (]: 10 of 13 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.42s]
[0m14:15:42.872332 [debug] [Thread-3 (]: Finished running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:15:42.855135 [info ] [Thread-2 (]: 12 of 13 PASS unique_fct_messages_id ........................................... [[32mPASS[0m in 0.28s]
[0m14:15:42.877843 [debug] [Thread-2 (]: Finished running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:15:42.944334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.232 seconds
[0m14:15:42.945689 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:15:42.947330 [debug] [Thread-1 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_telegram_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:15:42.957039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m14:15:42.961820 [debug] [Thread-1 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: ROLLBACK
[0m14:15:42.963428 [debug] [Thread-1 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: Close
[0m14:15:42.966447 [info ] [Thread-1 (]: 13 of 13 PASS unique_stg_telegram_messages_id .................................. [[32mPASS[0m in 0.29s]
[0m14:15:42.969892 [debug] [Thread-1 (]: Finished running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:15:42.973226 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:42.974301 [debug] [MainThread]: On master: BEGIN
[0m14:15:42.975280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:43.063514 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m14:15:43.064878 [debug] [MainThread]: On master: COMMIT
[0m14:15:43.066175 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:43.067862 [debug] [MainThread]: On master: COMMIT
[0m14:15:43.069252 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:43.070708 [debug] [MainThread]: On master: Close
[0m14:15:43.072156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:43.073195 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:15:43.074227 [debug] [MainThread]: Connection 'test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a' was properly closed.
[0m14:15:43.075233 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m14:15:43.076223 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_dates_date.bab48d2068' was properly closed.
[0m14:15:43.077357 [debug] [MainThread]: Connection 'test.medintel_models.unique_fct_messages_id.e6be0d3724' was properly closed.
[0m14:15:43.078496 [info ] [MainThread]: 
[0m14:15:43.080838 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m14:15:43.090651 [debug] [MainThread]: Command end result
[0m14:15:43.248504 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:15:43.272596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:15:43.319644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:15:43.321253 [info ] [MainThread]: 
[0m14:15:43.328005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:15:43.331739 [info ] [MainThread]: 
[0m14:15:43.338135 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:15:43.345176 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:15:43.347320 [info ] [MainThread]: 
[0m14:15:43.357676 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:15:43.361524 [info ] [MainThread]: 
[0m14:15:43.363639 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=13
[0m14:15:43.372959 [debug] [MainThread]: Command `dbt test` failed at 14:15:43.372625 after 7.42 seconds
[0m14:15:43.374246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655C35C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655DEF60A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655DEF5FF0>]}
[0m14:15:43.375408 [debug] [MainThread]: Flushing usage events
[0m14:15:44.310914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:28.201842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210624BFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210604E1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210638A7C50>]}


============================== 14:17:28.214557 | 3ff1f666-bec4-4026-86f9-6ab2abb988bb ==============================
[0m14:17:28.214557 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:17:28.216743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:28.898882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062BB3CE0>]}
[0m14:17:29.115236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210648E9F20>]}
[0m14:17:29.118290 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:17:29.700539 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:17:30.125952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:30.127438 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m14:17:31.444856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021064D7FA50>]}
[0m14:17:31.857583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:17:31.865311 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:17:31.941811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021063726300>]}
[0m14:17:31.943122 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:17:31.944913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106388E6D0>]}
[0m14:17:31.951853 [info ] [MainThread]: 
[0m14:17:31.953145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:31.954560 [info ] [MainThread]: 
[0m14:17:31.956682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:31.976196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:17:32.192766 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:17:32.194541 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:17:32.195951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:32.289818 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.094 seconds
[0m14:17:32.292731 [debug] [ThreadPool]: On list_postgres: Close
[0m14:17:32.297066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:17:32.311775 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:17:32.312370 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:17:32.313245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:32.401539 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m14:17:32.402554 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:17:32.403747 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:17:32.418351 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m14:17:32.422053 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:17:32.423288 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:17:32.438105 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:32.438937 [debug] [MainThread]: On master: BEGIN
[0m14:17:32.439413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:32.531587 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m14:17:32.532942 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:32.534913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:32.569873 [debug] [MainThread]: SQL status: SELECT 4 in 0.033 seconds
[0m14:17:32.576236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021065420D50>]}
[0m14:17:32.577850 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:32.580040 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:32.581443 [debug] [MainThread]: On master: BEGIN
[0m14:17:32.583633 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:17:32.585247 [debug] [MainThread]: On master: COMMIT
[0m14:17:32.586536 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:32.587814 [debug] [MainThread]: On master: COMMIT
[0m14:17:32.589307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:32.590592 [debug] [MainThread]: On master: Close
[0m14:17:32.611357 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m14:17:32.614369 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m14:17:32.618873 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m14:17:32.620051 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m14:17:32.650984 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m14:17:32.658627 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m14:17:32.814245 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.stg_telegram_messages"
[0m14:17:32.816560 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:17:32.817721 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: BEGIN
[0m14:17:32.819189 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:32.922757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m14:17:32.924081 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:17:32.925608 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  msg.id,
  msg.channel,
  CAST(msg.date AS TIMESTAMP) AS message_date,
  CHAR_LENGTH(TRIM(msg.text)) AS message_length,
  msg.has_image,
  msg.image_path,
  msg.text
FROM "postgres"."raw"."telegram_messages" AS msg
WHERE CHAR_LENGTH(TRIM(msg.text)) > 1
  );
[0m14:17:32.943107 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m14:17:32.965484 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:17:32.967871 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m14:17:32.970743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:32.979206 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:17:32.981568 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m14:17:32.984299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:33.056090 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:17:33.057279 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:17:33.057947 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:17:33.060347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:17:33.084338 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m14:17:33.124855 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:17:33.167894 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m14:17:33.175200 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:17:33.254255 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: Close
[0m14:17:33.390996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210652D9FD0>]}
[0m14:17:33.415974 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.65s]
[0m14:17:33.491439 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m14:17:33.494061 [debug] [Thread-3 (]: Began running node model.medintel_models.dim_dates
[0m14:17:33.496244 [debug] [Thread-4 (]: Began running node model.medintel_models.fct_messages
[0m14:17:33.498019 [debug] [Thread-2 (]: Began running node model.medintel_models.dim_channels
[0m14:17:33.499618 [info ] [Thread-3 (]: 3 of 4 START sql view model staging.dim_dates .................................. [RUN]
[0m14:17:33.504673 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medintel_models.dim_dates'
[0m14:17:33.506462 [debug] [Thread-3 (]: Began compiling node model.medintel_models.dim_dates
[0m14:17:33.501247 [info ] [Thread-4 (]: 4 of 4 START sql view model staging.fct_messages ............................... [RUN]
[0m14:17:33.516677 [debug] [Thread-3 (]: Writing injected SQL for node "model.medintel_models.dim_dates"
[0m14:17:33.519981 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:17:33.502735 [info ] [Thread-2 (]: 2 of 4 START sql view model staging.dim_channels ............................... [RUN]
[0m14:17:33.522444 [debug] [Thread-4 (]: Began compiling node model.medintel_models.fct_messages
[0m14:17:33.524433 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medintel_models.dim_channels'
[0m14:17:33.534864 [debug] [Thread-4 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:17:33.536375 [debug] [Thread-2 (]: Began compiling node model.medintel_models.dim_channels
[0m14:17:33.537474 [debug] [Thread-3 (]: Began executing node model.medintel_models.dim_dates
[0m14:17:33.548563 [debug] [Thread-2 (]: Writing injected SQL for node "model.medintel_models.dim_channels"
[0m14:17:33.565042 [debug] [Thread-3 (]: Writing runtime sql for node "model.medintel_models.dim_dates"
[0m14:17:33.566811 [debug] [Thread-4 (]: Began executing node model.medintel_models.fct_messages
[0m14:17:33.576989 [debug] [Thread-4 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:17:33.579852 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:17:33.581474 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:17:33.582863 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:17:33.584991 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:17:33.586428 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: BEGIN
[0m14:17:33.587851 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:17:33.589512 [debug] [Thread-2 (]: Began executing node model.medintel_models.dim_channels
[0m14:17:33.603323 [debug] [Thread-2 (]: Writing runtime sql for node "model.medintel_models.dim_channels"
[0m14:17:33.610414 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:17:33.612516 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: BEGIN
[0m14:17:33.615683 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:17:33.697695 [debug] [Thread-4 (]: SQL status: BEGIN in 0.115 seconds
[0m14:17:33.699101 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:17:33.700749 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  stg.message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
WHERE stg.message_length > 1
  );
[0m14:17:33.716757 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:17:33.731846 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:17:33.733685 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:17:33.737635 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:33.742730 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:17:33.744854 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:17:33.747297 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:17:33.750677 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:17:33.772711 [debug] [Thread-4 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:17:33.775596 [debug] [Thread-4 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:17:33.777298 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:17:33.779906 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:17:33.784854 [debug] [Thread-4 (]: On model.medintel_models.fct_messages: Close
[0m14:17:33.786515 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210651DB750>]}
[0m14:17:33.806749 [debug] [Thread-3 (]: SQL status: BEGIN in 0.219 seconds
[0m14:17:33.808275 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:17:33.810075 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */

  create view "postgres"."staging"."dim_dates__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  );
[0m14:17:33.788214 [info ] [Thread-4 (]: 4 of 4 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m14:17:33.823300 [debug] [Thread-4 (]: Finished running node model.medintel_models.fct_messages
[0m14:17:33.827221 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m14:17:33.842169 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:17:33.844127 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
alter table "postgres"."staging"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m14:17:33.848934 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:33.857810 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m14:17:33.860748 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:17:33.863725 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: COMMIT
[0m14:17:33.872875 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m14:17:33.882547 [debug] [Thread-3 (]: Applying DROP to: "postgres"."staging"."dim_dates__dbt_backup"
[0m14:17:33.887837 [debug] [Thread-3 (]: Using postgres connection "model.medintel_models.dim_dates"
[0m14:17:33.890082 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_dates"} */
drop view if exists "postgres"."staging"."dim_dates__dbt_backup" cascade
[0m14:17:33.893276 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:17:33.898623 [debug] [Thread-3 (]: On model.medintel_models.dim_dates: Close
[0m14:17:33.900373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021064F8BC50>]}
[0m14:17:33.914829 [debug] [Thread-2 (]: SQL status: BEGIN in 0.299 seconds
[0m14:17:33.917009 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:17:33.920138 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */

  create view "postgres"."staging"."dim_channels__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  channel AS channel_name,
  NULL::TEXT AS channel_type -- Optional enrichment
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m14:17:33.902097 [info ] [Thread-3 (]: 3 of 4 OK created sql view model staging.dim_dates ............................. [[32mCREATE VIEW[0m in 0.40s]
[0m14:17:33.923040 [debug] [Thread-3 (]: Finished running node model.medintel_models.dim_dates
[0m14:17:33.935786 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:17:33.954353 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:17:33.956072 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
alter table "postgres"."staging"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m14:17:33.958133 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:33.964778 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m14:17:33.966392 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:17:33.967499 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: COMMIT
[0m14:17:33.970001 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:17:33.978149 [debug] [Thread-2 (]: Applying DROP to: "postgres"."staging"."dim_channels__dbt_backup"
[0m14:17:33.980538 [debug] [Thread-2 (]: Using postgres connection "model.medintel_models.dim_channels"
[0m14:17:33.982175 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.dim_channels"} */
drop view if exists "postgres"."staging"."dim_channels__dbt_backup" cascade
[0m14:17:33.984337 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:17:33.989583 [debug] [Thread-2 (]: On model.medintel_models.dim_channels: Close
[0m14:17:33.991510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff1f666-bec4-4026-86f9-6ab2abb988bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021064E30050>]}
[0m14:17:33.993816 [info ] [Thread-2 (]: 2 of 4 OK created sql view model staging.dim_channels .......................... [[32mCREATE VIEW[0m in 0.47s]
[0m14:17:33.997307 [debug] [Thread-2 (]: Finished running node model.medintel_models.dim_channels
[0m14:17:34.000772 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:34.002146 [debug] [MainThread]: On master: BEGIN
[0m14:17:34.003433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:34.116041 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m14:17:34.117659 [debug] [MainThread]: On master: COMMIT
[0m14:17:34.119093 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:34.120608 [debug] [MainThread]: On master: COMMIT
[0m14:17:34.122015 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:34.123536 [debug] [MainThread]: On master: Close
[0m14:17:34.125297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:34.126412 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:17:34.130454 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:17:34.131757 [debug] [MainThread]: Connection 'model.medintel_models.stg_telegram_messages' was properly closed.
[0m14:17:34.134033 [debug] [MainThread]: Connection 'model.medintel_models.dim_dates' was properly closed.
[0m14:17:34.135763 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:17:34.136828 [debug] [MainThread]: Connection 'model.medintel_models.dim_channels' was properly closed.
[0m14:17:34.138077 [info ] [MainThread]: 
[0m14:17:34.140917 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m14:17:34.150464 [debug] [MainThread]: Command end result
[0m14:17:34.285976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:17:34.297548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:17:34.321998 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:17:34.323135 [info ] [MainThread]: 
[0m14:17:34.325028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:34.326597 [info ] [MainThread]: 
[0m14:17:34.330770 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m14:17:34.334546 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:34.334045 after 6.71 seconds
[0m14:17:34.335881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105D25DB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106505DCC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106247DAF0>]}
[0m14:17:34.337272 [debug] [MainThread]: Flushing usage events
[0m14:17:35.331841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:43.929975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018484193A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184821ADBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018485587C50>]}


============================== 14:17:43.941668 | 4f8fbbd8-0735-46fc-80ad-ab340e3c51b0 ==============================
[0m14:17:43.941668 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:17:43.944162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:44.703313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f8fbbd8-0735-46fc-80ad-ab340e3c51b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848488FCE0>]}
[0m14:17:44.946093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f8fbbd8-0735-46fc-80ad-ab340e3c51b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184865C9F20>]}
[0m14:17:44.949127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:17:45.746311 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:17:46.380828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:46.381827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:46.553597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f8fbbd8-0735-46fc-80ad-ab340e3c51b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018485413150>]}
[0m14:17:46.891340 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:17:46.897754 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:17:46.996895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f8fbbd8-0735-46fc-80ad-ab340e3c51b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018486C76210>]}
[0m14:17:46.998373 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:17:47.000290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8fbbd8-0735-46fc-80ad-ab340e3c51b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018486BE7770>]}
[0m14:17:47.008146 [info ] [MainThread]: 
[0m14:17:47.009622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:47.011673 [info ] [MainThread]: 
[0m14:17:47.015001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:47.028228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:17:47.251266 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:17:47.252503 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:17:47.253746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:47.342059 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m14:17:47.343224 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:17:47.344516 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:17:47.359956 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m14:17:47.363899 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:17:47.365096 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:17:47.380518 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:47.381721 [debug] [MainThread]: On master: BEGIN
[0m14:17:47.382468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:47.465004 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m14:17:47.466098 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:47.467713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:47.488156 [debug] [MainThread]: SQL status: SELECT 4 in 0.019 seconds
[0m14:17:47.494557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8fbbd8-0735-46fc-80ad-ab340e3c51b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018486D73EE0>]}
[0m14:17:47.495378 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:47.496539 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:47.497711 [debug] [MainThread]: On master: BEGIN
[0m14:17:47.499327 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:17:47.500691 [debug] [MainThread]: On master: COMMIT
[0m14:17:47.502310 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:47.503479 [debug] [MainThread]: On master: COMMIT
[0m14:17:47.505207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:47.506879 [debug] [MainThread]: On master: Close
[0m14:17:47.518452 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:17:47.519884 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:17:47.521529 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:17:47.523083 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:17:47.524610 [info ] [Thread-4 (]: 4 of 13 START test not_null_fct_messages_channel ............................... [RUN]
[0m14:17:47.525928 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_dates_date ..................................... [RUN]
[0m14:17:47.530207 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medintel_models.not_null_fct_messages_channel.e99e1d225f'
[0m14:17:47.532124 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_dates_date.e2decc9d39'
[0m14:17:47.527424 [info ] [Thread-1 (]: 1 of 13 START test long_messages ............................................... [RUN]
[0m14:17:47.534862 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:17:47.536307 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:17:47.528750 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m14:17:47.538633 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:17:47.634488 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:17:47.641447 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:17:47.643181 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m14:17:47.644888 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:17:47.647622 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:17:47.648887 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:17:47.658322 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:17:47.659756 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:17:47.695595 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:17:47.735445 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:17:47.743714 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:17:47.745496 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:17:47.752607 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:17:47.755811 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:17:47.757531 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:17:47.758945 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: BEGIN
[0m14:17:47.760334 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:17:47.761661 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:17:47.775928 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:17:47.776807 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:17:47.777694 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:17:47.778354 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: BEGIN
[0m14:17:47.779739 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:47.781160 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:17:47.783229 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:17:47.785266 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m14:17:47.786538 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:17:47.879331 [debug] [Thread-4 (]: SQL status: BEGIN in 0.102 seconds
[0m14:17:47.880737 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:17:47.882119 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."fct_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:17:47.887288 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:17:47.900222 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: ROLLBACK
[0m14:17:47.901831 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_channel.e99e1d225f: Close
[0m14:17:47.903395 [debug] [Thread-2 (]: SQL status: BEGIN in 0.117 seconds
[0m14:17:47.907392 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:17:47.909038 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "postgres"."staging"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m14:17:47.914578 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:17:47.919010 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m14:17:47.920625 [debug] [Thread-2 (]: On test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m14:17:47.906147 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fct_messages_channel ..................................... [[32mPASS[0m in 0.38s]
[0m14:17:47.923819 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:17:47.926832 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:17:47.952046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m14:17:47.953612 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:17:47.958478 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:17:47.960242 [debug] [Thread-3 (]: SQL status: BEGIN in 0.179 seconds
[0m14:17:47.961690 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:17:47.963029 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_dim_dates_date.e2decc9d39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "postgres"."staging"."dim_dates"
where date is null



  
  
      
    ) dbt_internal_test
[0m14:17:47.925542 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.28s]
[0m14:17:47.967446 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:17:47.969039 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:17:47.973317 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m14:17:47.977852 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: ROLLBACK
[0m14:17:47.979183 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m14:17:47.983357 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:17:47.984648 [debug] [Thread-3 (]: On test.medintel_models.not_null_dim_dates_date.e2decc9d39: Close
[0m14:17:47.986744 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:17:47.928159 [info ] [Thread-4 (]: 5 of 13 START test not_null_fct_messages_id .................................... [RUN]
[0m14:17:48.019156 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_channel.e99e1d225f, now test.medintel_models.not_null_fct_messages_id.a8dc118488)
[0m14:17:48.022454 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:17:47.970532 [info ] [Thread-2 (]: 6 of 13 START test not_null_fct_messages_message_date .......................... [RUN]
[0m14:17:48.033956 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medintel_models.not_null_fct_messages_message_date.e5a43e40df)
[0m14:17:48.041770 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:17:47.991756 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_dates_date ........................................... [[32mPASS[0m in 0.46s]
[0m14:17:48.043691 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:17:48.046214 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:17:47.993942 [error] [Thread-1 (]: 1 of 13 FAIL 12 long_messages .................................................. [[31mFAIL 12[0m in 0.46s]
[0m14:17:48.060255 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:17:48.061841 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:17:48.064332 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:17:48.066514 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:17:48.070510 [debug] [Thread-1 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:17:48.184599 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:17:48.068898 [info ] [Thread-3 (]: 7 of 13 START test not_null_stg_telegram_messages_channel ...................... [RUN]
[0m14:17:48.187974 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:17:48.196449 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:17:48.189566 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_telegram_messages_id ........................... [RUN]
[0m14:17:48.198009 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_dates_date.e2decc9d39, now test.medintel_models.not_null_stg_telegram_messages_channel.4874862192)
[0m14:17:48.200515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.long_messages, now test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m14:17:48.201863 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:17:48.203379 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:17:48.205331 [debug] [Thread-1 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:17:48.206749 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: BEGIN
[0m14:17:48.208426 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:17:48.221204 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:17:48.234917 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:17:48.236111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:48.239833 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: BEGIN
[0m14:17:48.241996 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:48.244313 [debug] [Thread-1 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:17:48.251946 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:17:48.258837 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:17:48.267577 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:17:48.270065 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:17:48.272166 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m14:17:48.274273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:48.288542 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:17:48.290134 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: BEGIN
[0m14:17:48.291625 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:48.385919 [debug] [Thread-4 (]: SQL status: BEGIN in 0.150 seconds
[0m14:17:48.386954 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:17:48.388682 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_id.a8dc118488"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."fct_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:17:48.393620 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:17:48.397548 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: ROLLBACK
[0m14:17:48.399099 [debug] [Thread-4 (]: On test.medintel_models.not_null_fct_messages_id.a8dc118488: Close
[0m14:17:48.400429 [debug] [Thread-3 (]: SQL status: BEGIN in 0.109 seconds
[0m14:17:48.401610 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:17:48.405480 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."stg_telegram_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m14:17:48.407924 [debug] [Thread-2 (]: SQL status: BEGIN in 0.166 seconds
[0m14:17:48.409649 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:17:48.411823 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."fct_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:17:48.414228 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:17:48.419161 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: ROLLBACK
[0m14:17:48.420816 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:17:48.403817 [info ] [Thread-4 (]: 5 of 13 PASS not_null_fct_messages_id .......................................... [[32mPASS[0m in 0.38s]
[0m14:17:48.426156 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: ROLLBACK
[0m14:17:48.427760 [debug] [Thread-3 (]: On test.medintel_models.not_null_stg_telegram_messages_channel.4874862192: Close
[0m14:17:48.429771 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:17:48.432011 [debug] [Thread-2 (]: On test.medintel_models.not_null_fct_messages_message_date.e5a43e40df: Close
[0m14:17:48.433552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m14:17:48.435443 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:17:48.443127 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:17:48.440794 [info ] [Thread-3 (]: 7 of 13 PASS not_null_stg_telegram_messages_channel ............................ [[32mPASS[0m in 0.24s]
[0m14:17:48.448522 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:17:48.451271 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:17:48.445031 [info ] [Thread-2 (]: 6 of 13 PASS not_null_fct_messages_message_date ................................ [[32mPASS[0m in 0.41s]
[0m14:17:48.453461 [debug] [Thread-3 (]: Began running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:17:48.457017 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:17:48.446768 [info ] [Thread-4 (]: 9 of 13 START test not_null_stg_telegram_messages_message_date ................. [RUN]
[0m14:17:48.458783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:17:48.462693 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_id.a8dc118488, now test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m14:17:48.461270 [debug] [Thread-2 (]: Began running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:17:48.467642 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m14:17:48.476461 [debug] [Thread-1 (]: On test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m14:17:48.460034 [info ] [Thread-3 (]: 10 of 13 START test unique_dim_channels_channel_name ........................... [RUN]
[0m14:17:48.469983 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:17:48.480119 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_channel.4874862192, now test.medintel_models.unique_dim_channels_channel_name.e57614abc8)
[0m14:17:48.497060 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:17:48.474776 [info ] [Thread-2 (]: 11 of 13 START test unique_dim_dates_date ...................................... [RUN]
[0m14:17:48.498722 [debug] [Thread-3 (]: Began compiling node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:17:48.500362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_fct_messages_message_date.e5a43e40df, now test.medintel_models.unique_dim_dates_date.bab48d2068)
[0m14:17:48.478398 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_telegram_messages_id ................................. [[32mPASS[0m in 0.28s]
[0m14:17:48.527482 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:17:48.528744 [debug] [Thread-2 (]: Began compiling node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:17:48.530872 [debug] [Thread-1 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:17:48.532325 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:17:48.542229 [debug] [Thread-1 (]: Began running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:17:48.543912 [debug] [Thread-3 (]: Began executing node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:17:48.552834 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:17:48.562894 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:17:48.573567 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:17:48.564580 [info ] [Thread-1 (]: 12 of 13 START test unique_fct_messages_id ..................................... [RUN]
[0m14:17:48.577391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medintel_models.unique_fct_messages_id.e6be0d3724)
[0m14:17:48.579485 [debug] [Thread-1 (]: Began compiling node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:17:48.590295 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:17:48.595733 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:17:48.596935 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: BEGIN
[0m14:17:48.598507 [debug] [Thread-2 (]: Began executing node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:17:48.600449 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:48.601849 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:17:48.603292 [debug] [Thread-1 (]: Began executing node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:17:48.610442 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:17:48.612294 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m14:17:48.621287 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:17:48.623345 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:17:48.625517 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:17:48.628349 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:17:48.629719 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: BEGIN
[0m14:17:48.631221 [debug] [Thread-1 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: BEGIN
[0m14:17:48.632644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:48.634009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:48.744092 [debug] [Thread-4 (]: SQL status: BEGIN in 0.143 seconds
[0m14:17:48.745849 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:17:48.747470 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m14:17:48.752949 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:17:48.758649 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m14:17:48.760521 [debug] [Thread-4 (]: On test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m14:17:48.763769 [info ] [Thread-4 (]: 9 of 13 PASS not_null_stg_telegram_messages_message_date ....................... [[32mPASS[0m in 0.30s]
[0m14:17:48.827340 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:17:48.831233 [debug] [Thread-4 (]: Began running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:17:48.833656 [info ] [Thread-4 (]: 13 of 13 START test unique_stg_telegram_messages_id ............................ [RUN]
[0m14:17:48.840362 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a)
[0m14:17:48.842218 [debug] [Thread-4 (]: Began compiling node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:17:48.858812 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:17:48.861442 [debug] [Thread-4 (]: Began executing node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:17:48.874091 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:17:48.876715 [debug] [Thread-2 (]: SQL status: BEGIN in 0.244 seconds
[0m14:17:48.878308 [debug] [Thread-2 (]: Using postgres connection "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:17:48.879847 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_dates_date.bab48d2068"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_dates"
where date is not null
group by date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:48.881694 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:17:48.883008 [debug] [Thread-4 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: BEGIN
[0m14:17:48.884994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:17:48.892344 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:17:48.896696 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: ROLLBACK
[0m14:17:48.898261 [debug] [Thread-2 (]: On test.medintel_models.unique_dim_dates_date.bab48d2068: Close
[0m14:17:48.903036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.269 seconds
[0m14:17:48.905316 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:17:48.906887 [debug] [Thread-1 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_fct_messages_id.e6be0d3724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."fct_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:48.909639 [debug] [Thread-3 (]: SQL status: BEGIN in 0.286 seconds
[0m14:17:48.911036 [debug] [Thread-3 (]: Using postgres connection "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:17:48.912463 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:48.922312 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m14:17:48.923807 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:17:48.900367 [info ] [Thread-2 (]: 11 of 13 PASS unique_dim_dates_date ............................................ [[32mPASS[0m in 0.40s]
[0m14:17:48.931981 [debug] [Thread-1 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: ROLLBACK
[0m14:17:48.937114 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m14:17:48.939292 [debug] [Thread-2 (]: Finished running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:17:48.940874 [debug] [Thread-1 (]: On test.medintel_models.unique_fct_messages_id.e6be0d3724: Close
[0m14:17:48.942443 [debug] [Thread-3 (]: On test.medintel_models.unique_dim_channels_channel_name.e57614abc8: Close
[0m14:17:48.945397 [info ] [Thread-1 (]: 12 of 13 PASS unique_fct_messages_id ........................................... [[32mPASS[0m in 0.37s]
[0m14:17:48.950194 [debug] [Thread-1 (]: Finished running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:17:48.947455 [info ] [Thread-3 (]: 10 of 13 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.47s]
[0m14:17:48.959733 [debug] [Thread-3 (]: Finished running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:17:49.009115 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m14:17:49.009809 [debug] [Thread-4 (]: Using postgres connection "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:17:49.010492 [debug] [Thread-4 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_telegram_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:17:49.022115 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:17:49.025312 [debug] [Thread-4 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: ROLLBACK
[0m14:17:49.026399 [debug] [Thread-4 (]: On test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a: Close
[0m14:17:49.027979 [info ] [Thread-4 (]: 13 of 13 PASS unique_stg_telegram_messages_id .................................. [[32mPASS[0m in 0.19s]
[0m14:17:49.031941 [debug] [Thread-4 (]: Finished running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:17:49.040960 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:49.041706 [debug] [MainThread]: On master: BEGIN
[0m14:17:49.042527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:49.130863 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m14:17:49.131493 [debug] [MainThread]: On master: COMMIT
[0m14:17:49.132024 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:49.133042 [debug] [MainThread]: On master: COMMIT
[0m14:17:49.134470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:49.135254 [debug] [MainThread]: On master: Close
[0m14:17:49.136478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:49.137789 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:17:49.139258 [debug] [MainThread]: Connection 'test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a' was properly closed.
[0m14:17:49.140467 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m14:17:49.141703 [debug] [MainThread]: Connection 'test.medintel_models.unique_fct_messages_id.e6be0d3724' was properly closed.
[0m14:17:49.142725 [debug] [MainThread]: Connection 'test.medintel_models.unique_dim_dates_date.bab48d2068' was properly closed.
[0m14:17:49.143790 [info ] [MainThread]: 
[0m14:17:49.144882 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m14:17:49.152658 [debug] [MainThread]: Command end result
[0m14:17:49.232578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:17:49.241224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:17:49.264293 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:17:49.265345 [info ] [MainThread]: 
[0m14:17:49.266613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:17:49.267785 [info ] [MainThread]: 
[0m14:17:49.269473 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:17:49.272520 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:17:49.274667 [info ] [MainThread]: 
[0m14:17:49.276832 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:17:49.279908 [info ] [MainThread]: 
[0m14:17:49.281811 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=13
[0m14:17:49.285730 [debug] [MainThread]: Command `dbt test` failed at 14:17:49.285335 after 5.65 seconds
[0m14:17:49.287580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848553C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184870F5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184870F5860>]}
[0m14:17:49.290281 [debug] [MainThread]: Flushing usage events
[0m14:17:55.187587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:38.304576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDD39FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDB3B9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDE787C50>]}


============================== 14:22:38.316907 | 14012dc3-2dec-49ff-ab59-78bf1368d90c ==============================
[0m14:22:38.316907 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:22:38.319005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_telegram_messages', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:39.094482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14012dc3-2dec-49ff-ab59-78bf1368d90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDDA8FCE0>]}
[0m14:22:39.325845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14012dc3-2dec-49ff-ab59-78bf1368d90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDE7F9F20>]}
[0m14:22:39.328356 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:22:40.244928 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:22:41.006401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:41.008469 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m14:22:42.686789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14012dc3-2dec-49ff-ab59-78bf1368d90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE0024450>]}
[0m14:22:43.255213 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:22:43.261468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:22:43.340621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14012dc3-2dec-49ff-ab59-78bf1368d90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDE606300>]}
[0m14:22:43.342096 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:22:43.344722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14012dc3-2dec-49ff-ab59-78bf1368d90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDE76F930>]}
[0m14:22:43.349512 [info ] [MainThread]: 
[0m14:22:43.350884 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:22:43.352711 [info ] [MainThread]: 
[0m14:22:43.354021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:22:43.355579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:22:43.570953 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:22:43.572298 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:22:43.573632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:43.670927 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.097 seconds
[0m14:22:43.674830 [debug] [ThreadPool]: On list_postgres: Close
[0m14:22:43.688762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:22:43.706711 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:22:43.707436 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:22:43.707924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:43.786646 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m14:22:43.787768 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:22:43.788975 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:22:43.804362 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m14:22:43.808773 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:22:43.810694 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:22:43.826693 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:43.827952 [debug] [MainThread]: On master: BEGIN
[0m14:22:43.829041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:43.914903 [debug] [MainThread]: SQL status: BEGIN in 0.086 seconds
[0m14:22:43.915879 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:43.917358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:22:43.938920 [debug] [MainThread]: SQL status: SELECT 4 in 0.020 seconds
[0m14:22:43.942112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14012dc3-2dec-49ff-ab59-78bf1368d90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE0244870>]}
[0m14:22:43.943544 [debug] [MainThread]: On master: ROLLBACK
[0m14:22:43.944864 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:43.945947 [debug] [MainThread]: On master: BEGIN
[0m14:22:43.947353 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:22:43.948597 [debug] [MainThread]: On master: COMMIT
[0m14:22:43.949559 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:43.950604 [debug] [MainThread]: On master: COMMIT
[0m14:22:43.951878 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:22:43.952964 [debug] [MainThread]: On master: Close
[0m14:22:43.965238 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m14:22:43.967057 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m14:22:43.969190 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m14:22:43.970671 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m14:22:43.997513 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m14:22:44.002543 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m14:22:44.129377 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.stg_telegram_messages"
[0m14:22:44.131796 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:22:44.133617 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: BEGIN
[0m14:22:44.135313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:44.210737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m14:22:44.211935 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:22:44.213139 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  msg.id,
  msg.channel,
  CAST(msg.date AS TIMESTAMP) AS message_date,
  CHAR_LENGTH(
    REGEXP_REPLACE(TRIM(msg.text), '\s+', '', 'g')
  ) AS message_length,
  msg.has_image,
  msg.image_path,
  msg.text
FROM "postgres"."raw"."telegram_messages" AS msg
WHERE CHAR_LENGTH(
  REGEXP_REPLACE(TRIM(msg.text), '\s+', '', 'g')
) > 1
  );
[0m14:22:44.227491 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:22:44.244574 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:22:44.245830 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m14:22:44.247397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:22:44.254588 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:22:44.255260 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m14:22:44.256895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:22:44.308647 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:22:44.310259 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:22:44.311552 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:22:44.314411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:22:44.330158 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m14:22:44.343950 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:22:44.345399 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m14:22:44.351502 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:22:44.358560 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: Close
[0m14:22:44.365079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14012dc3-2dec-49ff-ab59-78bf1368d90c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE02596D0>]}
[0m14:22:44.366917 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.39s]
[0m14:22:44.369622 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m14:22:44.373117 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:44.374201 [debug] [MainThread]: On master: BEGIN
[0m14:22:44.375326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:44.458803 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m14:22:44.459827 [debug] [MainThread]: On master: COMMIT
[0m14:22:44.460662 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:44.461627 [debug] [MainThread]: On master: COMMIT
[0m14:22:44.462676 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:22:44.464043 [debug] [MainThread]: On master: Close
[0m14:22:44.465244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:44.466249 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:22:44.467697 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:22:44.469541 [debug] [MainThread]: Connection 'model.medintel_models.stg_telegram_messages' was properly closed.
[0m14:22:44.470838 [info ] [MainThread]: 
[0m14:22:44.472839 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m14:22:44.475670 [debug] [MainThread]: Command end result
[0m14:22:44.571385 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:22:44.579944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:22:44.597100 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:22:44.598138 [info ] [MainThread]: 
[0m14:22:44.599706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:44.600980 [info ] [MainThread]: 
[0m14:22:44.602361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:22:44.606404 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:44.605937 after 6.81 seconds
[0m14:22:44.607882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE001FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDF96EDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDF96F9D0>]}
[0m14:22:44.612082 [debug] [MainThread]: Flushing usage events
[0m14:22:46.393478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:55.497490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021498653A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149666DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021499A47C50>]}


============================== 14:22:55.508868 | c9a8df93-09c1-4bdd-a0db-af44326a9b13 ==============================
[0m14:22:55.508868 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:22:55.511099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_messages', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:56.589782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9a8df93-09c1-4bdd-a0db-af44326a9b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021498D47CE0>]}
[0m14:22:56.882162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9a8df93-09c1-4bdd-a0db-af44326a9b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149AA89F20>]}
[0m14:22:56.885622 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:22:58.014429 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:22:59.395308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:59.396748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:59.696309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9a8df93-09c1-4bdd-a0db-af44326a9b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214998D3150>]}
[0m14:23:00.099128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:23:00.106210 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:23:00.213945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9a8df93-09c1-4bdd-a0db-af44326a9b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214998C6300>]}
[0m14:23:00.215638 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:23:00.220079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9a8df93-09c1-4bdd-a0db-af44326a9b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149AD251D0>]}
[0m14:23:00.225859 [info ] [MainThread]: 
[0m14:23:00.228850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:00.231403 [info ] [MainThread]: 
[0m14:23:00.233610 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:00.240207 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:23:00.468138 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:23:00.469464 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:23:00.470558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:00.561388 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.091 seconds
[0m14:23:00.565244 [debug] [ThreadPool]: On list_postgres: Close
[0m14:23:00.582457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:23:00.601559 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:23:00.602815 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:23:00.603839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:00.686594 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m14:23:00.687763 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:23:00.689284 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:23:00.704449 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m14:23:00.707875 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:23:00.709056 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:23:00.722858 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:00.724049 [debug] [MainThread]: On master: BEGIN
[0m14:23:00.725207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:00.898718 [debug] [MainThread]: SQL status: BEGIN in 0.174 seconds
[0m14:23:00.899435 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:00.901119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:00.922926 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m14:23:00.926377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9a8df93-09c1-4bdd-a0db-af44326a9b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B460390>]}
[0m14:23:00.927793 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:00.929254 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:00.930354 [debug] [MainThread]: On master: BEGIN
[0m14:23:00.932070 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:23:00.933150 [debug] [MainThread]: On master: COMMIT
[0m14:23:00.934636 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:00.935852 [debug] [MainThread]: On master: COMMIT
[0m14:23:00.937074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:00.938114 [debug] [MainThread]: On master: Close
[0m14:23:00.949389 [debug] [Thread-1 (]: Began running node model.medintel_models.fct_messages
[0m14:23:00.951728 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.fct_messages ............................... [RUN]
[0m14:23:00.953956 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:23:00.955112 [debug] [Thread-1 (]: Began compiling node model.medintel_models.fct_messages
[0m14:23:01.022377 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:23:01.026134 [debug] [Thread-1 (]: Began executing node model.medintel_models.fct_messages
[0m14:23:01.324374 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:23:01.328818 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:23:01.330227 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:23:01.331489 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:01.415363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m14:23:01.416520 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:23:01.418133 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  stg.message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
WHERE stg.message_length > 1
  );
[0m14:23:01.429636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:23:01.450063 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:23:01.452387 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:23:01.454615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:01.510398 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:23:01.511307 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:23:01.511990 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:23:01.514010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:23:01.530408 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:23:01.545683 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:23:01.547494 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:23:01.549514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:23:01.557757 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: Close
[0m14:23:01.563751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9a8df93-09c1-4bdd-a0db-af44326a9b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B4E8B90>]}
[0m14:23:01.565710 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.61s]
[0m14:23:01.569408 [debug] [Thread-1 (]: Finished running node model.medintel_models.fct_messages
[0m14:23:01.572957 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:01.574218 [debug] [MainThread]: On master: BEGIN
[0m14:23:01.575249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:01.663023 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m14:23:01.664454 [debug] [MainThread]: On master: COMMIT
[0m14:23:01.665458 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:01.666474 [debug] [MainThread]: On master: COMMIT
[0m14:23:01.668105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:01.669498 [debug] [MainThread]: On master: Close
[0m14:23:01.671189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:01.672321 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:23:01.673440 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:23:01.674717 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:23:01.676543 [info ] [MainThread]: 
[0m14:23:01.678664 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m14:23:01.681457 [debug] [MainThread]: Command end result
[0m14:23:01.784639 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:23:01.791808 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:23:01.812941 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:23:01.814066 [info ] [MainThread]: 
[0m14:23:01.816467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:01.818362 [info ] [MainThread]: 
[0m14:23:01.820539 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:23:01.823608 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:01.823283 after 6.65 seconds
[0m14:23:01.824699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B151F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B181D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002149B182E90>]}
[0m14:23:01.825797 [debug] [MainThread]: Flushing usage events
[0m14:23:03.170254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:14.026831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5DAEFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5BB0DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5EED7C50>]}


============================== 14:23:14.038368 | 1fbb02e8-839f-459c-b92d-99f8097106f1 ==============================
[0m14:23:14.038368 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:23:14.040381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select long_messages', 'send_anonymous_usage_stats': 'True'}
[0m14:23:14.786544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fbb02e8-839f-459c-b92d-99f8097106f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5E1DFCE0>]}
[0m14:23:15.018182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fbb02e8-839f-459c-b92d-99f8097106f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5FF19F20>]}
[0m14:23:15.021389 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:23:15.736908 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:23:16.329620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:16.330881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:16.534248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fbb02e8-839f-459c-b92d-99f8097106f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5ED63150>]}
[0m14:23:16.932979 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:23:16.940418 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:23:17.060502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fbb02e8-839f-459c-b92d-99f8097106f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F60686210>]}
[0m14:23:17.061770 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:23:17.064102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fbb02e8-839f-459c-b92d-99f8097106f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F605F7770>]}
[0m14:23:17.068109 [info ] [MainThread]: 
[0m14:23:17.069915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:17.075559 [info ] [MainThread]: 
[0m14:23:17.078130 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:17.113984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:23:17.444549 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:23:17.445640 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:23:17.446527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:17.552321 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m14:23:17.553813 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:23:17.554838 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:23:17.567706 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m14:23:17.571762 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:23:17.573117 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:23:17.591270 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:17.592307 [debug] [MainThread]: On master: BEGIN
[0m14:23:17.593525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:17.685380 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m14:23:17.686570 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:17.688180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:17.707618 [debug] [MainThread]: SQL status: SELECT 2 in 0.018 seconds
[0m14:23:17.712304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fbb02e8-839f-459c-b92d-99f8097106f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F60783A00>]}
[0m14:23:17.713775 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:17.714852 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:17.716001 [debug] [MainThread]: On master: BEGIN
[0m14:23:17.717652 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:23:17.718685 [debug] [MainThread]: On master: COMMIT
[0m14:23:17.719620 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:17.720624 [debug] [MainThread]: On master: COMMIT
[0m14:23:17.722077 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:17.723452 [debug] [MainThread]: On master: Close
[0m14:23:17.735191 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:23:17.736547 [info ] [Thread-1 (]: 1 of 1 START test long_messages ................................................ [RUN]
[0m14:23:17.738543 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:23:17.739978 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:23:17.766871 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:23:17.771614 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:23:17.845546 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:23:17.848347 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:23:17.849994 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:23:17.851976 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:17.931761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m14:23:17.933128 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:23:17.934763 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:23:18.004288 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m14:23:18.016619 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:23:18.017986 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:23:18.020076 [error] [Thread-1 (]: 1 of 1 FAIL 12 long_messages ................................................... [[31mFAIL 12[0m in 0.28s]
[0m14:23:18.022900 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:23:18.026235 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:18.027445 [debug] [MainThread]: On master: BEGIN
[0m14:23:18.028614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:18.112468 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m14:23:18.113724 [debug] [MainThread]: On master: COMMIT
[0m14:23:18.114710 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:18.115312 [debug] [MainThread]: On master: COMMIT
[0m14:23:18.116878 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:18.118008 [debug] [MainThread]: On master: Close
[0m14:23:18.119626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:18.120696 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:23:18.122258 [debug] [MainThread]: Connection 'test.medintel_models.long_messages' was properly closed.
[0m14:23:18.123425 [info ] [MainThread]: 
[0m14:23:18.124715 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m14:23:18.127062 [debug] [MainThread]: Command end result
[0m14:23:18.230081 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:23:18.237185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:23:18.261207 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:23:18.262201 [info ] [MainThread]: 
[0m14:23:18.263415 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:23:18.265069 [info ] [MainThread]: 
[0m14:23:18.267101 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:23:18.269239 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:23:18.271043 [info ] [MainThread]: 
[0m14:23:18.273228 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:23:18.274740 [info ] [MainThread]: 
[0m14:23:18.281333 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:23:18.288160 [debug] [MainThread]: Command `dbt test` failed at 14:23:18.287822 after 5.24 seconds
[0m14:23:18.289295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5EE8C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F606AFAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F606AFA10>]}
[0m14:23:18.290508 [debug] [MainThread]: Flushing usage events
[0m14:23:19.189256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:22.374930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D28763A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D26775BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D29B47C50>]}


============================== 14:25:22.383302 | e9041ca5-dbef-4525-9a3f-89564438e0e1 ==============================
[0m14:25:22.383302 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:25:22.385196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_messages', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:22.929403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9041ca5-dbef-4525-9a3f-89564438e0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D28E4FCE0>]}
[0m14:25:23.130132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9041ca5-dbef-4525-9a3f-89564438e0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D29BB9F20>]}
[0m14:25:23.133703 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:25:23.975981 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:25:24.456125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:24.457743 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\fct_messages.sql
[0m14:25:25.897715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9041ca5-dbef-4525-9a3f-89564438e0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2AF6B850>]}
[0m14:25:26.334932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:25:26.344801 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:25:26.412623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9041ca5-dbef-4525-9a3f-89564438e0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D299C6300>]}
[0m14:25:26.413993 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:25:26.416259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9041ca5-dbef-4525-9a3f-89564438e0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D29B2E6D0>]}
[0m14:25:26.419680 [info ] [MainThread]: 
[0m14:25:26.420733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:26.421841 [info ] [MainThread]: 
[0m14:25:26.423451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:26.428402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:25:26.664666 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:25:26.665712 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:25:26.666316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:26.760478 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.094 seconds
[0m14:25:26.764933 [debug] [ThreadPool]: On list_postgres: Close
[0m14:25:26.779614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:25:26.795365 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:25:26.796347 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:25:26.796937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:26.969376 [debug] [ThreadPool]: SQL status: BEGIN in 0.172 seconds
[0m14:25:26.970084 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:25:26.971335 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:25:26.984560 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m14:25:26.988994 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:25:26.990171 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:25:27.007310 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.008034 [debug] [MainThread]: On master: BEGIN
[0m14:25:27.009105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:27.083855 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m14:25:27.085025 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.086687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:27.103938 [debug] [MainThread]: SQL status: SELECT 2 in 0.016 seconds
[0m14:25:27.107825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9041ca5-dbef-4525-9a3f-89564438e0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2B618940>]}
[0m14:25:27.108645 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:27.109636 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.110302 [debug] [MainThread]: On master: BEGIN
[0m14:25:27.111495 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:25:27.112782 [debug] [MainThread]: On master: COMMIT
[0m14:25:27.113573 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.114109 [debug] [MainThread]: On master: COMMIT
[0m14:25:27.115231 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:27.116122 [debug] [MainThread]: On master: Close
[0m14:25:27.127075 [debug] [Thread-1 (]: Began running node model.medintel_models.fct_messages
[0m14:25:27.128741 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.fct_messages ............................... [RUN]
[0m14:25:27.131184 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:25:27.132535 [debug] [Thread-1 (]: Began compiling node model.medintel_models.fct_messages
[0m14:25:27.156266 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:25:27.160839 [debug] [Thread-1 (]: Began executing node model.medintel_models.fct_messages
[0m14:25:27.300147 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:25:27.305833 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:25:27.307214 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:25:27.308436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:27.386219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m14:25:27.387677 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:25:27.389153 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  CHAR_LENGTH(
    REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')
  ) AS message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
WHERE CHAR_LENGTH(
  REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')
) > 1
  );
[0m14:25:27.403032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:25:27.422084 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:25:27.423478 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages" rename to "fct_messages__dbt_backup"
[0m14:25:27.425142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:25:27.430308 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:25:27.431798 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:25:27.434012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:27.482992 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:25:27.484739 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:25:27.487035 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:25:27.490602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:25:27.514876 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:25:27.533926 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:25:27.535665 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:25:27.539244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:25:27.548721 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: Close
[0m14:25:27.556622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9041ca5-dbef-4525-9a3f-89564438e0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2B4D5FD0>]}
[0m14:25:27.558554 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.42s]
[0m14:25:27.562299 [debug] [Thread-1 (]: Finished running node model.medintel_models.fct_messages
[0m14:25:27.566427 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.567833 [debug] [MainThread]: On master: BEGIN
[0m14:25:27.569203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:27.665331 [debug] [MainThread]: SQL status: BEGIN in 0.096 seconds
[0m14:25:27.666368 [debug] [MainThread]: On master: COMMIT
[0m14:25:27.667377 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.668388 [debug] [MainThread]: On master: COMMIT
[0m14:25:27.669528 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:27.670405 [debug] [MainThread]: On master: Close
[0m14:25:27.671822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:27.672890 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:25:27.673893 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:25:27.674954 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:25:27.676857 [info ] [MainThread]: 
[0m14:25:27.678959 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m14:25:27.681466 [debug] [MainThread]: Command end result
[0m14:25:27.760397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:25:27.769189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:25:27.787883 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:25:27.788877 [info ] [MainThread]: 
[0m14:25:27.790080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:27.791417 [info ] [MainThread]: 
[0m14:25:27.793162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:25:27.797535 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:27.796701 after 5.80 seconds
[0m14:25:27.798982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2B3CFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2AD2EDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2AD2F9D0>]}
[0m14:25:27.800334 [debug] [MainThread]: Flushing usage events
[0m14:25:28.744920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:37.526686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC0813A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEBE829BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC1BF7C50>]}


============================== 14:25:37.536588 | aefd7040-aef4-4c0b-95c2-ef153e83fff3 ==============================
[0m14:25:37.536588 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:25:37.538151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select long_messages', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:25:38.756753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aefd7040-aef4-4c0b-95c2-ef153e83fff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC0EFBCE0>]}
[0m14:25:39.044542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aefd7040-aef4-4c0b-95c2-ef153e83fff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC2C25F20>]}
[0m14:25:39.047807 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:25:40.317950 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:25:40.950914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:40.951996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:41.164712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aefd7040-aef4-4c0b-95c2-ef153e83fff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC1A83150>]}
[0m14:25:41.477302 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:25:41.484458 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:25:41.581519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aefd7040-aef4-4c0b-95c2-ef153e83fff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC32C6210>]}
[0m14:25:41.582890 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:25:41.584186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aefd7040-aef4-4c0b-95c2-ef153e83fff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC3237770>]}
[0m14:25:41.587812 [info ] [MainThread]: 
[0m14:25:41.589547 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:41.592066 [info ] [MainThread]: 
[0m14:25:41.594512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:41.641012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:25:41.870841 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:25:41.871998 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:25:41.873434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:41.967490 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m14:25:41.968215 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:25:41.968934 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:25:41.982416 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m14:25:41.985283 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:25:41.986212 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:25:42.005022 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:42.005891 [debug] [MainThread]: On master: BEGIN
[0m14:25:42.006380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:42.089157 [debug] [MainThread]: SQL status: BEGIN in 0.083 seconds
[0m14:25:42.090242 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:42.091204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:42.109787 [debug] [MainThread]: SQL status: SELECT 2 in 0.017 seconds
[0m14:25:42.113869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aefd7040-aef4-4c0b-95c2-ef153e83fff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC33C3A00>]}
[0m14:25:42.115514 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:42.116959 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:42.117833 [debug] [MainThread]: On master: BEGIN
[0m14:25:42.119029 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:25:42.120396 [debug] [MainThread]: On master: COMMIT
[0m14:25:42.122069 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:42.123504 [debug] [MainThread]: On master: COMMIT
[0m14:25:42.124811 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:42.125514 [debug] [MainThread]: On master: Close
[0m14:25:42.134577 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:25:42.136015 [info ] [Thread-1 (]: 1 of 1 START test long_messages ................................................ [RUN]
[0m14:25:42.138867 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:25:42.140073 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:25:42.168573 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:25:42.171519 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:25:42.223143 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:25:42.224938 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:25:42.226134 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:25:42.227256 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:42.304881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m14:25:42.306105 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:25:42.306938 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:25:42.364304 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.056 seconds
[0m14:25:42.374019 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:25:42.375367 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:25:42.377206 [error] [Thread-1 (]: 1 of 1 FAIL 12 long_messages ................................................... [[31mFAIL 12[0m in 0.24s]
[0m14:25:42.380606 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:25:42.385191 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:42.386804 [debug] [MainThread]: On master: BEGIN
[0m14:25:42.388174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:42.468435 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m14:25:42.469358 [debug] [MainThread]: On master: COMMIT
[0m14:25:42.470587 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:42.471452 [debug] [MainThread]: On master: COMMIT
[0m14:25:42.472748 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:42.473778 [debug] [MainThread]: On master: Close
[0m14:25:42.474757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:42.475900 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:25:42.476783 [debug] [MainThread]: Connection 'test.medintel_models.long_messages' was properly closed.
[0m14:25:42.477379 [info ] [MainThread]: 
[0m14:25:42.478820 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m14:25:42.481409 [debug] [MainThread]: Command end result
[0m14:25:42.562538 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:25:42.568820 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:25:42.588243 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:25:42.589230 [info ] [MainThread]: 
[0m14:25:42.590424 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:25:42.591431 [info ] [MainThread]: 
[0m14:25:42.593654 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:25:42.595306 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:25:42.596978 [info ] [MainThread]: 
[0m14:25:42.598533 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:25:42.600053 [info ] [MainThread]: 
[0m14:25:42.601689 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:25:42.609067 [debug] [MainThread]: Command `dbt test` failed at 14:25:42.607441 after 5.35 seconds
[0m14:25:42.613108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC1BAC950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC32EFAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEC32EF120>]}
[0m14:25:42.614502 [debug] [MainThread]: Flushing usage events
[0m14:25:43.589816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:14.715711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1BDECFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1BBEE9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1BF2C7C50>]}


============================== 14:27:14.724727 | 46d63397-71e5-4ca5-92c6-a501e90dc4fc ==============================
[0m14:27:14.724727 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:27:14.725999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select long_messages', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:15.218702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d63397-71e5-4ca5-92c6-a501e90dc4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1BE5CFCE0>]}
[0m14:27:15.380420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46d63397-71e5-4ca5-92c6-a501e90dc4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1C0309F20>]}
[0m14:27:15.383159 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:15.930966 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:27:16.383141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:16.383864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:16.517633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46d63397-71e5-4ca5-92c6-a501e90dc4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1BF153150>]}
[0m14:27:16.819549 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:27:16.825165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:27:16.911635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46d63397-71e5-4ca5-92c6-a501e90dc4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1C09A6210>]}
[0m14:27:16.913009 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:27:16.914478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d63397-71e5-4ca5-92c6-a501e90dc4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1C0917770>]}
[0m14:27:16.917939 [info ] [MainThread]: 
[0m14:27:16.918883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:16.920031 [info ] [MainThread]: 
[0m14:27:16.921981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:16.938826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:27:17.115766 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:27:17.116849 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:27:17.117807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:17.200044 [debug] [ThreadPool]: SQL status: BEGIN in 0.082 seconds
[0m14:27:17.201301 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:27:17.202562 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:27:17.214205 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m14:27:17.216412 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:27:17.217182 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:27:17.229316 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:17.229910 [debug] [MainThread]: On master: BEGIN
[0m14:27:17.230473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:17.302424 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m14:27:17.303152 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:17.303998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:17.318366 [debug] [MainThread]: SQL status: SELECT 2 in 0.013 seconds
[0m14:27:17.322987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d63397-71e5-4ca5-92c6-a501e90dc4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1C0AA3A00>]}
[0m14:27:17.324328 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:17.325212 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:17.325872 [debug] [MainThread]: On master: BEGIN
[0m14:27:17.326743 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:27:17.327664 [debug] [MainThread]: On master: COMMIT
[0m14:27:17.328524 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:17.329356 [debug] [MainThread]: On master: COMMIT
[0m14:27:17.330385 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:17.331727 [debug] [MainThread]: On master: Close
[0m14:27:17.340777 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:27:17.342033 [info ] [Thread-1 (]: 1 of 1 START test long_messages ................................................ [RUN]
[0m14:27:17.343495 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:27:17.344402 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:27:17.371541 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:27:17.374000 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:27:17.432404 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:27:17.434262 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:27:17.435289 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:27:17.436279 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:17.502996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m14:27:17.504291 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:27:17.505443 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:27:17.557141 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m14:27:17.564928 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:27:17.565935 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:27:17.568006 [error] [Thread-1 (]: 1 of 1 FAIL 12 long_messages ................................................... [[31mFAIL 12[0m in 0.22s]
[0m14:27:17.571031 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:27:17.574533 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:17.575249 [debug] [MainThread]: On master: BEGIN
[0m14:27:17.576021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:17.676653 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m14:27:17.677767 [debug] [MainThread]: On master: COMMIT
[0m14:27:17.679056 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:17.680117 [debug] [MainThread]: On master: COMMIT
[0m14:27:17.681498 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:17.682562 [debug] [MainThread]: On master: Close
[0m14:27:17.684025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:17.685075 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:27:17.686435 [debug] [MainThread]: Connection 'test.medintel_models.long_messages' was properly closed.
[0m14:27:17.687631 [info ] [MainThread]: 
[0m14:27:17.689335 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m14:27:17.692761 [debug] [MainThread]: Command end result
[0m14:27:17.786015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:27:17.790340 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:27:17.806097 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:27:17.807166 [info ] [MainThread]: 
[0m14:27:17.808456 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:27:17.809475 [info ] [MainThread]: 
[0m14:27:17.810539 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:27:17.811937 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:27:17.813535 [info ] [MainThread]: 
[0m14:27:17.816242 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:27:17.818118 [info ] [MainThread]: 
[0m14:27:17.819668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:27:17.824866 [debug] [MainThread]: Command `dbt test` failed at 14:27:17.824526 after 3.57 seconds
[0m14:27:17.826285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1BF27C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1C09CFAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1C09CFB70>]}
[0m14:27:17.827468 [debug] [MainThread]: Flushing usage events
[0m14:27:18.985822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:39.364480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277073A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527508DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025278457C50>]}


============================== 14:28:39.374815 | 370cf20b-1112-4f63-88a0-61d860cbd99c ==============================
[0m14:28:39.374815 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:28:39.376544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_messages', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:39.986211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '370cf20b-1112-4f63-88a0-61d860cbd99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277763CE0>]}
[0m14:28:40.179784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '370cf20b-1112-4f63-88a0-61d860cbd99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025279499F20>]}
[0m14:28:40.186464 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:28:40.871796 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:28:41.354280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:41.355317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:41.513594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '370cf20b-1112-4f63-88a0-61d860cbd99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252782E3150>]}
[0m14:28:41.819474 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:28:41.825450 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:28:41.892313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '370cf20b-1112-4f63-88a0-61d860cbd99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252782D6300>]}
[0m14:28:41.893894 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:28:41.894864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370cf20b-1112-4f63-88a0-61d860cbd99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252796591D0>]}
[0m14:28:41.898434 [info ] [MainThread]: 
[0m14:28:41.899718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:41.901347 [info ] [MainThread]: 
[0m14:28:41.903243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:41.905918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:28:42.113298 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:28:42.114686 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:28:42.115783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:42.203334 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.088 seconds
[0m14:28:42.207196 [debug] [ThreadPool]: On list_postgres: Close
[0m14:28:42.220533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:28:42.238913 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:28:42.239902 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:28:42.240748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:42.318453 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m14:28:42.319738 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:28:42.320764 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:28:42.333840 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m14:28:42.336273 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:28:42.337313 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:28:42.350488 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:42.351899 [debug] [MainThread]: On master: BEGIN
[0m14:28:42.353128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:42.427459 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m14:28:42.428309 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:42.429270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:42.448045 [debug] [MainThread]: SQL status: SELECT 2 in 0.018 seconds
[0m14:28:42.452498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370cf20b-1112-4f63-88a0-61d860cbd99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025279DE0390>]}
[0m14:28:42.453844 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:42.455280 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:42.456361 [debug] [MainThread]: On master: BEGIN
[0m14:28:42.457789 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:28:42.458752 [debug] [MainThread]: On master: COMMIT
[0m14:28:42.459806 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:42.461102 [debug] [MainThread]: On master: COMMIT
[0m14:28:42.462465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:42.463563 [debug] [MainThread]: On master: Close
[0m14:28:42.476013 [debug] [Thread-1 (]: Began running node model.medintel_models.fct_messages
[0m14:28:42.477450 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.fct_messages ............................... [RUN]
[0m14:28:42.479221 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:28:42.480690 [debug] [Thread-1 (]: Began compiling node model.medintel_models.fct_messages
[0m14:28:42.508181 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:28:42.509998 [debug] [Thread-1 (]: Began executing node model.medintel_models.fct_messages
[0m14:28:42.633100 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:28:42.635367 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:28:42.636774 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:28:42.637929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:42.729874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m14:28:42.731391 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:28:42.732731 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  CHAR_LENGTH(
    REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')
  ) AS message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
WHERE CHAR_LENGTH(
  REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')
) > 1
  );
[0m14:28:42.743949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:28:42.764470 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:28:42.765903 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages" rename to "fct_messages__dbt_backup"
[0m14:28:42.767995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:42.777682 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:28:42.778972 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:28:42.781078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:42.837177 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:28:42.838312 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:28:42.839214 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:28:42.842380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:28:42.861467 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:28:42.877699 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:28:42.878938 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:28:42.882500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:28:42.888753 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: Close
[0m14:28:42.895806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370cf20b-1112-4f63-88a0-61d860cbd99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025279E68AD0>]}
[0m14:28:42.898059 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.41s]
[0m14:28:42.900378 [debug] [Thread-1 (]: Finished running node model.medintel_models.fct_messages
[0m14:28:42.903449 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:42.904061 [debug] [MainThread]: On master: BEGIN
[0m14:28:42.904628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:43.024229 [debug] [MainThread]: SQL status: BEGIN in 0.120 seconds
[0m14:28:43.025368 [debug] [MainThread]: On master: COMMIT
[0m14:28:43.026450 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:43.027555 [debug] [MainThread]: On master: COMMIT
[0m14:28:43.028715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:43.029629 [debug] [MainThread]: On master: Close
[0m14:28:43.030712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:43.031835 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:28:43.032887 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:28:43.033885 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:28:43.035146 [info ] [MainThread]: 
[0m14:28:43.037139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m14:28:43.040070 [debug] [MainThread]: Command end result
[0m14:28:43.143952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:28:43.149918 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:28:43.169565 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:28:43.170884 [info ] [MainThread]: 
[0m14:28:43.173207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:43.177032 [info ] [MainThread]: 
[0m14:28:43.178870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:28:43.183068 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:43.182712 after 4.10 seconds
[0m14:28:43.184901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025279AD1E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025279B09A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025279B0A7B0>]}
[0m14:28:43.188431 [debug] [MainThread]: Flushing usage events
[0m14:28:44.083046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:53.535094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E507F1BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E505F3DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E509307C50>]}


============================== 14:28:53.548545 | 4cd68dec-b139-4eb6-a686-224fe59f953d ==============================
[0m14:28:53.548545 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:28:53.550855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select long_messages', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:54.247580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cd68dec-b139-4eb6-a686-224fe59f953d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50860FCE0>]}
[0m14:28:54.488420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cd68dec-b139-4eb6-a686-224fe59f953d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50A349F20>]}
[0m14:28:54.492399 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:28:55.478380 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:28:56.068390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:56.069030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:56.310294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cd68dec-b139-4eb6-a686-224fe59f953d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E509193150>]}
[0m14:28:56.719143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:28:56.728079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:28:56.835270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cd68dec-b139-4eb6-a686-224fe59f953d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50AA46210>]}
[0m14:28:56.837113 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:28:56.838636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd68dec-b139-4eb6-a686-224fe59f953d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50A9B7770>]}
[0m14:28:56.842461 [info ] [MainThread]: 
[0m14:28:56.844245 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:56.845882 [info ] [MainThread]: 
[0m14:28:56.848349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:56.869443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:28:57.113784 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:28:57.115213 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:28:57.117298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:57.227788 [debug] [ThreadPool]: SQL status: BEGIN in 0.110 seconds
[0m14:28:57.229341 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:28:57.230863 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:28:57.246436 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m14:28:57.250532 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:28:57.251997 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:28:57.266082 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.267229 [debug] [MainThread]: On master: BEGIN
[0m14:28:57.268320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:57.348050 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m14:28:57.349132 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.351058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:57.375405 [debug] [MainThread]: SQL status: SELECT 2 in 0.022 seconds
[0m14:28:57.380514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd68dec-b139-4eb6-a686-224fe59f953d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50AB43A00>]}
[0m14:28:57.382001 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:57.383486 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.384721 [debug] [MainThread]: On master: BEGIN
[0m14:28:57.386485 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:28:57.387845 [debug] [MainThread]: On master: COMMIT
[0m14:28:57.388996 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.390127 [debug] [MainThread]: On master: COMMIT
[0m14:28:57.391370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:57.392415 [debug] [MainThread]: On master: Close
[0m14:28:57.402138 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:28:57.404606 [info ] [Thread-1 (]: 1 of 1 START test long_messages ................................................ [RUN]
[0m14:28:57.406994 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:28:57.408456 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:28:57.453405 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:28:57.457709 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:28:57.529111 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:28:57.531970 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:28:57.533570 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:28:57.534832 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:57.628152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m14:28:57.629476 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:28:57.630125 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:28:57.690936 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.060 seconds
[0m14:28:57.704216 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:28:57.705312 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:28:57.706801 [error] [Thread-1 (]: 1 of 1 FAIL 12 long_messages ................................................... [[31mFAIL 12[0m in 0.30s]
[0m14:28:57.710212 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:28:57.716353 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.717455 [debug] [MainThread]: On master: BEGIN
[0m14:28:57.718502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:57.812988 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m14:28:57.814299 [debug] [MainThread]: On master: COMMIT
[0m14:28:57.815463 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.816577 [debug] [MainThread]: On master: COMMIT
[0m14:28:57.818103 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:57.819731 [debug] [MainThread]: On master: Close
[0m14:28:57.823255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:57.825185 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:28:57.826343 [debug] [MainThread]: Connection 'test.medintel_models.long_messages' was properly closed.
[0m14:28:57.827648 [info ] [MainThread]: 
[0m14:28:57.831973 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m14:28:57.841630 [debug] [MainThread]: Command end result
[0m14:28:57.977002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:28:57.984095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:28:58.011703 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:28:58.013158 [info ] [MainThread]: 
[0m14:28:58.015153 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:28:58.016924 [info ] [MainThread]: 
[0m14:28:58.018556 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:28:58.021170 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:28:58.023002 [info ] [MainThread]: 
[0m14:28:58.026835 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:28:58.029527 [info ] [MainThread]: 
[0m14:28:58.031172 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:28:58.044507 [debug] [MainThread]: Command `dbt test` failed at 14:28:58.043026 after 4.87 seconds
[0m14:28:58.047588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5092BC950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50AA6FAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50AA6FA10>]}
[0m14:28:58.049183 [debug] [MainThread]: Flushing usage events
[0m14:28:58.917982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:47.593694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B0593A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6AE5A9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B1973C50>]}


============================== 14:30:47.604659 | bb50308a-b709-4d86-91ba-1648caf3d3c5 ==============================
[0m14:30:47.604659 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:30:47.606453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select long_messages', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:48.188564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb50308a-b709-4d86-91ba-1648caf3d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B0C83CE0>]}
[0m14:30:48.376814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb50308a-b709-4d86-91ba-1648caf3d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B29A5F20>]}
[0m14:30:48.379658 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:48.913233 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:30:49.653764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:49.654785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:49.831227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb50308a-b709-4d86-91ba-1648caf3d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B1803150>]}
[0m14:30:50.224315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:30:50.231754 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:30:50.335942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb50308a-b709-4d86-91ba-1648caf3d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B2FD6210>]}
[0m14:30:50.337468 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:30:50.339022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb50308a-b709-4d86-91ba-1648caf3d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B2F47770>]}
[0m14:30:50.344336 [info ] [MainThread]: 
[0m14:30:50.345764 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:30:50.347063 [info ] [MainThread]: 
[0m14:30:50.349359 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:50.367404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:30:50.596422 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:30:50.597806 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:30:50.599099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:50.690231 [debug] [ThreadPool]: SQL status: BEGIN in 0.091 seconds
[0m14:30:50.691374 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:30:50.692630 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:30:50.708910 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m14:30:50.713440 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:30:50.714908 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:30:50.729314 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:50.730274 [debug] [MainThread]: On master: BEGIN
[0m14:30:50.731167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:50.811045 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m14:30:50.812689 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:50.814306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:50.833410 [debug] [MainThread]: SQL status: SELECT 2 in 0.017 seconds
[0m14:30:50.837814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb50308a-b709-4d86-91ba-1648caf3d3c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B30DFA00>]}
[0m14:30:50.839115 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:50.840465 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:50.841600 [debug] [MainThread]: On master: BEGIN
[0m14:30:50.843027 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:30:50.844143 [debug] [MainThread]: On master: COMMIT
[0m14:30:50.845173 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:50.846034 [debug] [MainThread]: On master: COMMIT
[0m14:30:50.847235 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:50.848205 [debug] [MainThread]: On master: Close
[0m14:30:50.858451 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:30:50.860230 [info ] [Thread-1 (]: 1 of 1 START test long_messages ................................................ [RUN]
[0m14:30:50.862327 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:30:50.863704 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:30:50.890178 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:30:50.894619 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:30:50.962611 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:30:50.965509 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:30:50.966915 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:30:50.968317 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:30:51.047751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m14:30:51.049283 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:30:51.050845 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  
  
      
    ) dbt_internal_test
[0m14:30:51.119712 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.067 seconds
[0m14:30:51.133554 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:30:51.135275 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:30:51.137249 [error] [Thread-1 (]: 1 of 1 FAIL 12 long_messages ................................................... [[31mFAIL 12[0m in 0.28s]
[0m14:30:51.139387 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:30:51.142569 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:51.143486 [debug] [MainThread]: On master: BEGIN
[0m14:30:51.144323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:51.237719 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m14:30:51.238885 [debug] [MainThread]: On master: COMMIT
[0m14:30:51.240008 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:51.241025 [debug] [MainThread]: On master: COMMIT
[0m14:30:51.242326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:51.243398 [debug] [MainThread]: On master: Close
[0m14:30:51.244912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:51.245868 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:30:51.247116 [debug] [MainThread]: Connection 'test.medintel_models.long_messages' was properly closed.
[0m14:30:51.248477 [info ] [MainThread]: 
[0m14:30:51.249748 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m14:30:51.252385 [debug] [MainThread]: Command end result
[0m14:30:51.361553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:30:51.367072 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:30:51.392770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:30:51.394307 [info ] [MainThread]: 
[0m14:30:51.396458 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:30:51.398522 [info ] [MainThread]: 
[0m14:30:51.401032 [error] [MainThread]: [31mFailure in test long_messages (dbt/medintel_models/tests\long_messages.sql)[0m
[0m14:30:51.408533 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m14:30:51.424040 [info ] [MainThread]: 
[0m14:30:51.428253 [info ] [MainThread]:   compiled code at target\compiled\medintel_models\dbt/medintel_models/tests\long_messages.sql
[0m14:30:51.430445 [info ] [MainThread]: 
[0m14:30:51.431982 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:30:51.438696 [debug] [MainThread]: Command `dbt test` failed at 14:30:51.437972 after 4.18 seconds
[0m14:30:51.440526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B192C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B2FFFAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B2FFFB70>]}
[0m14:30:51.442116 [debug] [MainThread]: Flushing usage events
[0m14:30:52.768706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:38.683810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09FAEFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09DB09BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A0ED3C50>]}


============================== 14:33:38.692085 | cebc9af5-b429-4845-9a37-9d304c2598e9 ==============================
[0m14:33:38.692085 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:33:38.693603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:39.074077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cebc9af5-b429-4845-9a37-9d304c2598e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A01DFCE0>]}
[0m14:33:39.131743 [debug] [MainThread]: Command `dbt clean` succeeded at 14:33:39.131527 after 0.86 seconds
[0m14:33:39.132340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A210C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A210C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0A0D63D50>]}
[0m14:33:39.133234 [debug] [MainThread]: Flushing usage events
[0m14:33:40.721431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:50.561713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CF93FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7CD95DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D0D27C50>]}


============================== 14:33:50.572522 | 10321975-1bcb-4760-ad0b-2a7737e6d4f5 ==============================
[0m14:33:50.572522 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:33:50.574165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_telegram_messages', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:51.273766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10321975-1bcb-4760-ad0b-2a7737e6d4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D002FCE0>]}
[0m14:33:51.602357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10321975-1bcb-4760-ad0b-2a7737e6d4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D1D69F20>]}
[0m14:33:51.606635 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:33:52.508320 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:33:53.271089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:33:53.272827 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/tests\long_messages.sql
[0m14:33:53.274924 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\marts\fct_messages.sql
[0m14:33:53.277467 [debug] [MainThread]: Partial parsing: updated file: medintel_models://dbt/medintel_models/models\staging\stg_telegram_messages.sql
[0m14:33:55.331322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10321975-1bcb-4760-ad0b-2a7737e6d4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D2232F50>]}
[0m14:33:55.757250 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:33:55.765407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:33:55.856561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10321975-1bcb-4760-ad0b-2a7737e6d4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D1DC9130>]}
[0m14:33:55.857616 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:33:55.859170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10321975-1bcb-4760-ad0b-2a7737e6d4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D24A4590>]}
[0m14:33:55.863930 [info ] [MainThread]: 
[0m14:33:55.864785 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:33:55.865429 [info ] [MainThread]: 
[0m14:33:55.867139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:55.870668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:33:56.124399 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:33:56.125018 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:33:56.126533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:56.334215 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.208 seconds
[0m14:33:56.337786 [debug] [ThreadPool]: On list_postgres: Close
[0m14:33:56.353389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:33:56.368659 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:33:56.369897 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:33:56.371054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:56.463963 [debug] [ThreadPool]: SQL status: BEGIN in 0.093 seconds
[0m14:33:56.465203 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:33:56.466547 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:33:56.480706 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m14:33:56.485047 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:33:56.486775 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:33:56.503224 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:56.504284 [debug] [MainThread]: On master: BEGIN
[0m14:33:56.504867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:56.595206 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m14:33:56.596546 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:56.598323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:33:56.619553 [debug] [MainThread]: SQL status: SELECT 2 in 0.019 seconds
[0m14:33:56.624611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10321975-1bcb-4760-ad0b-2a7737e6d4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D2825230>]}
[0m14:33:56.625911 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:56.627153 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:56.628675 [debug] [MainThread]: On master: BEGIN
[0m14:33:56.630953 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:33:56.632021 [debug] [MainThread]: On master: COMMIT
[0m14:33:56.633009 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:56.633997 [debug] [MainThread]: On master: COMMIT
[0m14:33:56.635251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:56.636520 [debug] [MainThread]: On master: Close
[0m14:33:56.648743 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m14:33:56.651297 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m14:33:56.655187 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m14:33:56.656724 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m14:33:56.682851 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m14:33:56.687499 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m14:33:56.847591 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.stg_telegram_messages"
[0m14:33:56.850863 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:33:56.852685 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: BEGIN
[0m14:33:56.854505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:33:56.944418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m14:33:56.946366 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:33:56.947992 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  msg.id,
  msg.channel,
  CAST(msg.date AS TIMESTAMP) AS message_date,
  CHAR_LENGTH(REGEXP_REPLACE(TRIM(msg.text), '\s+', '', 'g')) AS message_length,
  msg.has_image,
  msg.image_path,
  msg.text
FROM "postgres"."raw"."telegram_messages" AS msg
WHERE CHAR_LENGTH(REGEXP_REPLACE(TRIM(msg.text), '\s+', '', 'g')) > 1
  );
[0m14:33:56.962276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:33:56.977994 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:33:56.981560 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m14:33:56.983965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:33:56.996427 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:33:56.997937 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m14:33:56.999978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:33:57.057454 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:33:57.058396 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:33:57.059721 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: COMMIT
[0m14:33:57.064769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:33:57.080623 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m14:33:57.098713 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.stg_telegram_messages"
[0m14:33:57.100075 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m14:33:57.103528 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:33:57.112084 [debug] [Thread-1 (]: On model.medintel_models.stg_telegram_messages: Close
[0m14:33:57.119522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10321975-1bcb-4760-ad0b-2a7737e6d4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D2805190>]}
[0m14:33:57.122968 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.46s]
[0m14:33:57.126103 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m14:33:57.130949 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:57.131602 [debug] [MainThread]: On master: BEGIN
[0m14:33:57.132095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:57.231923 [debug] [MainThread]: SQL status: BEGIN in 0.100 seconds
[0m14:33:57.233045 [debug] [MainThread]: On master: COMMIT
[0m14:33:57.234026 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:57.234948 [debug] [MainThread]: On master: COMMIT
[0m14:33:57.236145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:57.237098 [debug] [MainThread]: On master: Close
[0m14:33:57.238680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:57.240115 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:33:57.241216 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:33:57.242263 [debug] [MainThread]: Connection 'model.medintel_models.stg_telegram_messages' was properly closed.
[0m14:33:57.243402 [info ] [MainThread]: 
[0m14:33:57.245840 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m14:33:57.249230 [debug] [MainThread]: Command end result
[0m14:33:57.390545 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:33:57.399689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:33:57.422258 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:33:57.423094 [info ] [MainThread]: 
[0m14:33:57.424406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:57.425742 [info ] [MainThread]: 
[0m14:33:57.429706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:33:57.432533 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:57.432197 after 7.16 seconds
[0m14:33:57.433844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D22C76A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D1FFE670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7D1FFEAD0>]}
[0m14:33:57.435023 [debug] [MainThread]: Flushing usage events
[0m14:33:58.541787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:07.914841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7A263A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7827DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7B647C50>]}


============================== 14:34:07.926723 | 83e52822-cce3-4355-b528-0871e75bf0d4 ==============================
[0m14:34:07.926723 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:34:07.929384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_messages', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:34:08.612819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83e52822-cce3-4355-b528-0871e75bf0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7A94FCE0>]}
[0m14:34:08.866181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83e52822-cce3-4355-b528-0871e75bf0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7C689F20>]}
[0m14:34:08.868270 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:34:09.820558 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:34:10.614649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:10.615389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:10.867673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83e52822-cce3-4355-b528-0871e75bf0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7B4D3150>]}
[0m14:34:11.369325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:34:11.377496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:34:11.468632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83e52822-cce3-4355-b528-0871e75bf0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7B4C6300>]}
[0m14:34:11.469836 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:34:11.471809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e52822-cce3-4355-b528-0871e75bf0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7C8519B0>]}
[0m14:34:11.476404 [info ] [MainThread]: 
[0m14:34:11.478051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:11.480635 [info ] [MainThread]: 
[0m14:34:11.482791 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:34:11.486943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:34:11.778364 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:34:11.779617 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:34:11.780944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:11.891130 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.110 seconds
[0m14:34:11.894991 [debug] [ThreadPool]: On list_postgres: Close
[0m14:34:11.911549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:34:11.929656 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:34:11.930704 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:34:11.931652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:12.014633 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m14:34:12.015716 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:34:12.016853 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:34:12.034027 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m14:34:12.037935 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:34:12.039362 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:34:12.052625 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:12.053618 [debug] [MainThread]: On master: BEGIN
[0m14:34:12.055192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:12.157910 [debug] [MainThread]: SQL status: BEGIN in 0.103 seconds
[0m14:34:12.159214 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:12.160890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:34:12.183381 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m14:34:12.187062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e52822-cce3-4355-b528-0871e75bf0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7CFA0390>]}
[0m14:34:12.188718 [debug] [MainThread]: On master: ROLLBACK
[0m14:34:12.190124 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:12.191171 [debug] [MainThread]: On master: BEGIN
[0m14:34:12.192848 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:34:12.194118 [debug] [MainThread]: On master: COMMIT
[0m14:34:12.195298 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:12.196434 [debug] [MainThread]: On master: COMMIT
[0m14:34:12.197888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:34:12.199170 [debug] [MainThread]: On master: Close
[0m14:34:12.217478 [debug] [Thread-1 (]: Began running node model.medintel_models.fct_messages
[0m14:34:12.218997 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.fct_messages ............................... [RUN]
[0m14:34:12.235746 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:34:12.236955 [debug] [Thread-1 (]: Began compiling node model.medintel_models.fct_messages
[0m14:34:12.265770 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:34:12.273427 [debug] [Thread-1 (]: Began executing node model.medintel_models.fct_messages
[0m14:34:12.434403 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_models.fct_messages"
[0m14:34:12.436475 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:34:12.438868 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: BEGIN
[0m14:34:12.440002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:12.560787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.121 seconds
[0m14:34:12.562386 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:34:12.563740 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  CHAR_LENGTH(REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')) AS message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
WHERE CHAR_LENGTH(REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')) > 1
  );
[0m14:34:12.576323 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:34:12.597571 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:34:12.598719 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m14:34:12.600556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:34:12.681042 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:34:12.682628 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:34:12.684140 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: COMMIT
[0m14:34:12.688141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:34:12.708931 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m14:34:12.727447 [debug] [Thread-1 (]: Using postgres connection "model.medintel_models.fct_messages"
[0m14:34:12.728944 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "model.medintel_models.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m14:34:12.730759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:34:12.738735 [debug] [Thread-1 (]: On model.medintel_models.fct_messages: Close
[0m14:34:12.744212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e52822-cce3-4355-b528-0871e75bf0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7D028B90>]}
[0m14:34:12.746274 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.51s]
[0m14:34:12.772422 [debug] [Thread-1 (]: Finished running node model.medintel_models.fct_messages
[0m14:34:12.776605 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:12.777697 [debug] [MainThread]: On master: BEGIN
[0m14:34:12.778684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:34:13.036079 [debug] [MainThread]: SQL status: BEGIN in 0.257 seconds
[0m14:34:13.037357 [debug] [MainThread]: On master: COMMIT
[0m14:34:13.038290 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:13.039185 [debug] [MainThread]: On master: COMMIT
[0m14:34:13.040321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:34:13.041367 [debug] [MainThread]: On master: Close
[0m14:34:13.042735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:13.043738 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:34:13.044761 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:34:13.045642 [debug] [MainThread]: Connection 'model.medintel_models.fct_messages' was properly closed.
[0m14:34:13.046674 [info ] [MainThread]: 
[0m14:34:13.059110 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m14:34:13.063360 [debug] [MainThread]: Command end result
[0m14:34:13.504015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:34:13.540883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:34:13.636185 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:34:13.643064 [info ] [MainThread]: 
[0m14:34:13.656207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:13.683731 [info ] [MainThread]: 
[0m14:34:13.728976 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:34:13.883360 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:13.880720 after 6.36 seconds
[0m14:34:13.886287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7CC85F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7CCBDD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7CCBEE90>]}
[0m14:34:13.891881 [debug] [MainThread]: Flushing usage events
[0m14:34:14.810768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:24.554679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C363B33A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361B49BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C364F17C50>]}


============================== 14:34:24.569089 | c28028da-71eb-4b06-a6bd-7f4682dc25fe ==============================
[0m14:34:24.569089 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:34:24.573218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select long_messages', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:25.351173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c28028da-71eb-4b06-a6bd-7f4682dc25fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C36421FCE0>]}
[0m14:34:25.591658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c28028da-71eb-4b06-a6bd-7f4682dc25fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C365F59F20>]}
[0m14:34:25.594927 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:34:26.543213 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:34:27.109050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:27.109997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:27.321813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c28028da-71eb-4b06-a6bd-7f4682dc25fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C364DA3150>]}
[0m14:34:27.737161 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:34:27.744196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:34:27.854418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c28028da-71eb-4b06-a6bd-7f4682dc25fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C36657E210>]}
[0m14:34:27.855674 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:34:27.857251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c28028da-71eb-4b06-a6bd-7f4682dc25fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3664E3770>]}
[0m14:34:27.861880 [info ] [MainThread]: 
[0m14:34:27.863894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:27.866147 [info ] [MainThread]: 
[0m14:34:27.868171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:34:27.887188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:34:28.139037 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:34:28.140108 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:34:28.141050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:28.235028 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m14:34:28.236561 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:34:28.237764 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:34:28.255075 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.016 seconds
[0m14:34:28.259529 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:34:28.261181 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:34:28.278882 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:28.281383 [debug] [MainThread]: On master: BEGIN
[0m14:34:28.282515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:28.401721 [debug] [MainThread]: SQL status: BEGIN in 0.119 seconds
[0m14:34:28.403805 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:28.405586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:34:28.428305 [debug] [MainThread]: SQL status: SELECT 2 in 0.021 seconds
[0m14:34:28.434241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c28028da-71eb-4b06-a6bd-7f4682dc25fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C366683A00>]}
[0m14:34:28.435720 [debug] [MainThread]: On master: ROLLBACK
[0m14:34:28.437146 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:28.438273 [debug] [MainThread]: On master: BEGIN
[0m14:34:28.439770 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:34:28.441051 [debug] [MainThread]: On master: COMMIT
[0m14:34:28.442231 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:28.443314 [debug] [MainThread]: On master: COMMIT
[0m14:34:28.444626 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:34:28.445711 [debug] [MainThread]: On master: Close
[0m14:34:28.562048 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:34:28.566946 [info ] [Thread-1 (]: 1 of 1 START test long_messages ................................................ [RUN]
[0m14:34:28.584718 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_models.long_messages'
[0m14:34:28.587115 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:34:28.642917 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:34:28.645353 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:34:28.825603 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_models.long_messages"
[0m14:34:28.828309 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:34:28.834291 [debug] [Thread-1 (]: On test.medintel_models.long_messages: BEGIN
[0m14:34:28.841404 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:29.048675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.209 seconds
[0m14:34:29.050164 [debug] [Thread-1 (]: Using postgres connection "test.medintel_models.long_messages"
[0m14:34:29.051997 [debug] [Thread-1 (]: On test.medintel_models.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "node_id": "test.medintel_models.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM "postgres"."staging"."fct_messages"
WHERE message_length <= 1
  
  
      
    ) dbt_internal_test
[0m14:34:29.317974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.265 seconds
[0m14:34:29.334329 [debug] [Thread-1 (]: On test.medintel_models.long_messages: ROLLBACK
[0m14:34:29.336130 [debug] [Thread-1 (]: On test.medintel_models.long_messages: Close
[0m14:34:29.338418 [info ] [Thread-1 (]: 1 of 1 PASS long_messages ...................................................... [[32mPASS[0m in 0.75s]
[0m14:34:29.341208 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:34:29.344886 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:29.350470 [debug] [MainThread]: On master: BEGIN
[0m14:34:29.351507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:34:29.467867 [debug] [MainThread]: SQL status: BEGIN in 0.116 seconds
[0m14:34:29.469158 [debug] [MainThread]: On master: COMMIT
[0m14:34:29.470367 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:29.471624 [debug] [MainThread]: On master: COMMIT
[0m14:34:29.473237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:34:29.474784 [debug] [MainThread]: On master: Close
[0m14:34:29.476425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:29.477842 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:34:29.479262 [debug] [MainThread]: Connection 'test.medintel_models.long_messages' was properly closed.
[0m14:34:29.480856 [info ] [MainThread]: 
[0m14:34:29.483405 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m14:34:29.486224 [debug] [MainThread]: Command end result
[0m14:34:29.641422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:34:29.653805 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:34:29.689732 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:34:29.690806 [info ] [MainThread]: 
[0m14:34:29.692184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:29.693654 [info ] [MainThread]: 
[0m14:34:29.695125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:34:29.705653 [debug] [MainThread]: Command `dbt test` succeeded at 14:34:29.705269 after 5.51 seconds
[0m14:34:29.707135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C364ECC950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3665A3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3665A3C20>]}
[0m14:34:29.708667 [debug] [MainThread]: Flushing usage events
[0m14:34:30.794022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:46.760410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DED513A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEB52DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEE907C50>]}


============================== 14:35:46.769755 | c222c082-e528-451c-a047-3bdd2413b709 ==============================
[0m14:35:46.769755 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:35:46.771523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:47.977737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c222c082-e528-451c-a047-3bdd2413b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEDC0BCE0>]}
[0m14:35:48.222771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c222c082-e528-451c-a047-3bdd2413b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEE979F20>]}
[0m14:35:48.226938 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:49.078168 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:35:49.730250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:49.731373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:49.935239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c222c082-e528-451c-a047-3bdd2413b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEE793150>]}
[0m14:35:50.014621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c222c082-e528-451c-a047-3bdd2413b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEFED6030>]}
[0m14:35:50.015834 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m14:35:50.017162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c222c082-e528-451c-a047-3bdd2413b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEFB08130>]}
[0m14:35:50.023758 [info ] [MainThread]: 
[0m14:35:50.025053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:35:50.026269 [info ] [MainThread]: 
[0m14:35:50.027988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:50.039983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m14:35:50.289961 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:35:50.291136 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:35:50.292389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:50.480287 [debug] [ThreadPool]: SQL status: BEGIN in 0.188 seconds
[0m14:35:50.481305 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:35:50.482369 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:35:50.497392 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m14:35:50.501519 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:35:50.502937 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:35:50.516143 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:50.517124 [debug] [MainThread]: On master: BEGIN
[0m14:35:50.518016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:50.611611 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m14:35:50.612792 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:50.614460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:50.636011 [debug] [MainThread]: SQL status: SELECT 2 in 0.020 seconds
[0m14:35:50.642376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c222c082-e528-451c-a047-3bdd2413b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DF00D9E60>]}
[0m14:35:50.643925 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:50.645065 [debug] [MainThread]: On master: Close
[0m14:35:50.672317 [debug] [Thread-1 (]: Began running node model.medintel_models.stg_telegram_messages
[0m14:35:50.675342 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_models.stg_telegram_messages'
[0m14:35:50.676583 [debug] [Thread-1 (]: Began compiling node model.medintel_models.stg_telegram_messages
[0m14:35:50.703448 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_models.stg_telegram_messages"
[0m14:35:50.705839 [debug] [Thread-1 (]: Began executing node model.medintel_models.stg_telegram_messages
[0m14:35:50.708595 [debug] [Thread-1 (]: Finished running node model.medintel_models.stg_telegram_messages
[0m14:35:50.711978 [debug] [Thread-3 (]: Began running node model.medintel_models.dim_dates
[0m14:35:50.713745 [debug] [Thread-4 (]: Began running node model.medintel_models.fct_messages
[0m14:35:50.715421 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medintel_models.dim_dates'
[0m14:35:50.716968 [debug] [Thread-1 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:35:50.718471 [debug] [Thread-2 (]: Began running node model.medintel_models.dim_channels
[0m14:35:50.720320 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medintel_models.fct_messages'
[0m14:35:50.721794 [debug] [Thread-3 (]: Began compiling node model.medintel_models.dim_dates
[0m14:35:50.724507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medintel_models.stg_telegram_messages, now test.medintel_models.not_null_stg_telegram_messages_channel.4874862192)
[0m14:35:50.726361 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medintel_models.dim_channels'
[0m14:35:50.727857 [debug] [Thread-4 (]: Began compiling node model.medintel_models.fct_messages
[0m14:35:50.736696 [debug] [Thread-3 (]: Writing injected SQL for node "model.medintel_models.dim_dates"
[0m14:35:50.738212 [debug] [Thread-1 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:35:50.739784 [debug] [Thread-2 (]: Began compiling node model.medintel_models.dim_channels
[0m14:35:50.747958 [debug] [Thread-4 (]: Writing injected SQL for node "model.medintel_models.fct_messages"
[0m14:35:50.779320 [debug] [Thread-2 (]: Writing injected SQL for node "model.medintel_models.dim_channels"
[0m14:35:50.800860 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_channel.4874862192"
[0m14:35:50.802846 [debug] [Thread-3 (]: Began executing node model.medintel_models.dim_dates
[0m14:35:50.805732 [debug] [Thread-3 (]: Finished running node model.medintel_models.dim_dates
[0m14:35:50.807455 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:35:50.808710 [debug] [Thread-2 (]: Began executing node model.medintel_models.dim_channels
[0m14:35:50.811143 [debug] [Thread-4 (]: Began executing node model.medintel_models.fct_messages
[0m14:35:50.812881 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medintel_models.dim_dates, now test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m14:35:50.814211 [debug] [Thread-1 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:35:50.816523 [debug] [Thread-2 (]: Finished running node model.medintel_models.dim_channels
[0m14:35:50.819661 [debug] [Thread-4 (]: Finished running node model.medintel_models.fct_messages
[0m14:35:50.821043 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:35:50.824094 [debug] [Thread-1 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_channel.4874862192
[0m14:35:50.825611 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:35:50.827681 [debug] [Thread-4 (]: Began running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:35:50.835779 [debug] [Thread-1 (]: Began running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:35:50.845587 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m14:35:50.846999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.medintel_models.dim_channels, now test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m14:35:50.848420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.medintel_models.fct_messages, now test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a)
[0m14:35:50.851928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_channel.4874862192, now test.medintel_models.not_null_dim_dates_date.e2decc9d39)
[0m14:35:50.853498 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:35:50.854806 [debug] [Thread-4 (]: Began compiling node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:35:50.857898 [debug] [Thread-1 (]: Began compiling node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:35:50.871365 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m14:35:50.883747 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:35:50.893831 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a"
[0m14:35:50.908759 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_dates_date.e2decc9d39"
[0m14:35:50.911371 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317
[0m14:35:50.913487 [debug] [Thread-3 (]: Began running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:35:50.915183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medintel_models.unique_dim_dates_date.bab48d2068)
[0m14:35:50.916663 [debug] [Thread-3 (]: Began compiling node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:35:50.918386 [debug] [Thread-4 (]: Began executing node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:35:50.919989 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:35:50.921390 [debug] [Thread-1 (]: Began executing node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:35:50.932171 [debug] [Thread-4 (]: Finished running node test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a
[0m14:35:50.935830 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.unique_dim_dates_date.bab48d2068"
[0m14:35:50.938214 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m14:35:50.941060 [debug] [Thread-1 (]: Finished running node test.medintel_models.not_null_dim_dates_date.e2decc9d39
[0m14:35:50.941835 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:35:50.942834 [debug] [Thread-2 (]: Began running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:35:50.943877 [debug] [Thread-1 (]: Began running node test.medintel_models.long_messages
[0m14:35:50.945212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.unique_stg_telegram_messages_id.58b6a8a35a, now test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m14:35:50.947178 [debug] [Thread-3 (]: Began executing node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:35:50.946261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medintel_models.unique_dim_channels_channel_name.e57614abc8)
[0m14:35:50.948835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_dates_date.e2decc9d39, now test.medintel_models.long_messages)
[0m14:35:50.950210 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:35:50.951950 [debug] [Thread-3 (]: Finished running node test.medintel_models.unique_dim_dates_date.bab48d2068
[0m14:35:50.952913 [debug] [Thread-2 (]: Began compiling node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:35:50.954296 [debug] [Thread-1 (]: Began compiling node test.medintel_models.long_messages
[0m14:35:50.966769 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m14:35:50.968284 [debug] [Thread-3 (]: Began running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:35:50.981243 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.unique_dim_channels_channel_name.e57614abc8"
[0m14:35:50.989010 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.long_messages"
[0m14:35:50.990682 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_models.unique_dim_dates_date.bab48d2068, now test.medintel_models.not_null_fct_messages_channel.e99e1d225f)
[0m14:35:50.992482 [debug] [Thread-3 (]: Began compiling node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:35:51.003197 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:35:51.004801 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_channel.e99e1d225f"
[0m14:35:51.006109 [debug] [Thread-2 (]: Began executing node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:35:51.008245 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b
[0m14:35:51.011172 [debug] [Thread-1 (]: Began executing node test.medintel_models.long_messages
[0m14:35:51.012204 [debug] [Thread-2 (]: Finished running node test.medintel_models.unique_dim_channels_channel_name.e57614abc8
[0m14:35:51.013587 [debug] [Thread-4 (]: Began running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:35:51.016052 [debug] [Thread-1 (]: Finished running node test.medintel_models.long_messages
[0m14:35:51.017246 [debug] [Thread-3 (]: Began executing node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:35:51.018717 [debug] [Thread-2 (]: Began running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:35:51.020155 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_models.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medintel_models.not_null_fct_messages_id.a8dc118488)
[0m14:35:51.021512 [debug] [Thread-1 (]: Began running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:35:51.023869 [debug] [Thread-3 (]: Finished running node test.medintel_models.not_null_fct_messages_channel.e99e1d225f
[0m14:35:51.025211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_models.unique_dim_channels_channel_name.e57614abc8, now test.medintel_models.not_null_fct_messages_message_date.e5a43e40df)
[0m14:35:51.026616 [debug] [Thread-4 (]: Began compiling node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:35:51.027956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_models.long_messages, now test.medintel_models.unique_fct_messages_id.e6be0d3724)
[0m14:35:51.029590 [debug] [Thread-2 (]: Began compiling node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:35:51.042185 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_id.a8dc118488"
[0m14:35:51.043736 [debug] [Thread-1 (]: Began compiling node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:35:51.054672 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_models.not_null_fct_messages_message_date.e5a43e40df"
[0m14:35:51.067195 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_models.unique_fct_messages_id.e6be0d3724"
[0m14:35:51.069118 [debug] [Thread-4 (]: Began executing node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:35:51.071530 [debug] [Thread-4 (]: Finished running node test.medintel_models.not_null_fct_messages_id.a8dc118488
[0m14:35:51.073302 [debug] [Thread-2 (]: Began executing node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:35:51.076097 [debug] [Thread-2 (]: Finished running node test.medintel_models.not_null_fct_messages_message_date.e5a43e40df
[0m14:35:51.074418 [debug] [Thread-1 (]: Began executing node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:35:51.079068 [debug] [Thread-1 (]: Finished running node test.medintel_models.unique_fct_messages_id.e6be0d3724
[0m14:35:51.081890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:51.082996 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m14:35:51.083978 [debug] [MainThread]: Connection 'test.medintel_models.unique_fct_messages_id.e6be0d3724' was properly closed.
[0m14:35:51.085211 [debug] [MainThread]: Connection 'test.medintel_models.not_null_fct_messages_channel.e99e1d225f' was properly closed.
[0m14:35:51.086222 [debug] [MainThread]: Connection 'test.medintel_models.not_null_fct_messages_id.a8dc118488' was properly closed.
[0m14:35:51.087096 [debug] [MainThread]: Connection 'test.medintel_models.not_null_fct_messages_message_date.e5a43e40df' was properly closed.
[0m14:35:51.096793 [debug] [MainThread]: Command end result
[0m14:35:51.646306 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:35:51.654053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:35:51.699171 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m14:35:52.546754 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:35:52.547700 [info ] [MainThread]: Building catalog
[0m14:35:52.581026 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m14:35:52.603993 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m14:35:52.605173 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m14:35:52.606259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:52.690806 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m14:35:52.691949 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m14:35:52.693681 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_models", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:35:52.720879 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.026 seconds
[0m14:35:52.729266 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m14:35:52.730606 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m14:35:52.763401 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\User\medintel-pipeline\target\catalog.json
[0m14:35:52.844287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m14:35:52.850052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m14:35:52.851049 [info ] [MainThread]: Catalog written to C:\Users\User\medintel-pipeline\target\catalog.json
[0m14:35:52.854721 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:35:52.854152 after 6.39 seconds
[0m14:35:52.856064 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:35:52.857040 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m14:35:52.858882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEE8BC950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEFF238B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEFF23070>]}
[0m14:35:52.860421 [debug] [MainThread]: Flushing usage events
[0m14:35:53.712649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:13.711124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103699FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210349BDBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021037D83C50>]}


============================== 14:37:13.724027 | baec4aec-7bbd-4db5-9431-7a8ccc78e01b ==============================
[0m14:37:13.724027 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:37:13.726186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:14.563838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baec4aec-7bbd-4db5-9431-7a8ccc78e01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021037093CE0>]}
[0m14:37:14.876082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baec4aec-7bbd-4db5-9431-7a8ccc78e01b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021038DA6030>]}
[0m14:39:11.614344 [error] [MainThread]: Encountered an error:

[0m14:39:11.630652 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\User\medintel-pipeline\venv\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\User\medintel-pipeline\venv\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\medintel-pipeline\venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\medintel-pipeline\venv\Lib\site-packages\dbt\cli\requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\medintel-pipeline\venv\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\medintel-pipeline\venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\User\medintel-pipeline\venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\User\anaconda3\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\User\anaconda3\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\anaconda3\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\anaconda3\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\anaconda3\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\User\anaconda3\Lib\socketserver.py", line 766, in __init__
    self.handle()
    ~~~~~~~~~~~^^
  File "C:\Users\User\anaconda3\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\User\anaconda3\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\User\anaconda3\Lib\socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
KeyboardInterrupt

[0m14:39:11.667071 [debug] [MainThread]: Command `dbt docs serve` failed at 14:39:11.665959 after 118.38 seconds
[0m14:39:11.668212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103909E550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103909E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210390BD310>]}
[0m14:39:11.669339 [debug] [MainThread]: Flushing usage events
[0m14:39:12.659273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:57.580710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB60053A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5E06DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB61443C50>]}


============================== 15:09:57.595300 | cd897bae-a55a-4001-8121-0bcc122e3d1c ==============================
[0m15:09:57.595300 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:09:57.597891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:57.697375 [info ] [MainThread]: dbt version: 1.10.4
[0m15:09:57.699889 [info ] [MainThread]: python version: 3.13.5
[0m15:09:57.701669 [info ] [MainThread]: python path: C:\Users\User\medintel-pipeline\venv\Scripts\python.exe
[0m15:09:57.703175 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:09:57.742829 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m15:09:57.745234 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m15:09:57.755407 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\medintel-pipeline\dbt_project.yml
[0m15:09:58.184400 [info ] [MainThread]: Configuration:
[0m15:09:58.186094 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m15:09:58.187668 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:58.189024 [info ] [MainThread]: Required dependencies:
[0m15:09:58.190710 [debug] [MainThread]: Executing "git --help"
[0m15:09:58.301377 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:58.302493 [debug] [MainThread]: STDERR: "b''"
[0m15:09:58.303340 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:58.304837 [info ] [MainThread]: Connection test skipped since no profile was found
[0m15:09:58.306458 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:09:58.308879 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'medintel_pipeline'


[0m15:09:58.312553 [debug] [MainThread]: Command `dbt debug` failed at 15:09:58.312092 after 1.14 seconds
[0m15:09:58.314741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB60745480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6259FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6247BF00>]}
[0m15:09:58.315875 [debug] [MainThread]: Flushing usage events
[0m15:10:00.154077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:09.711859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083A17FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020838199BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083B577C50>]}


============================== 15:10:09.724135 | 47c4b6f8-b408-4c62-b64c-c7eacaa28c3f ==============================
[0m15:10:09.724135 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:10:09.727264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:09.736610 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medintel_pipeline'
[0m15:10:09.786716 [debug] [MainThread]: Command `dbt run` failed at 15:10:09.786341 after 2.69 seconds
[0m15:10:09.788071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083B453230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083B45AC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083B5D8270>]}
[0m15:10:09.789388 [debug] [MainThread]: Flushing usage events
[0m15:10:10.837988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:19.426925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59F813A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59D829BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A0C07C50>]}


============================== 15:10:19.436882 | 80dd5b9e-d961-4886-bd3c-991a8d0f0dc1 ==============================
[0m15:10:19.436882 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:10:19.439009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:10:19.450336 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'medintel_pipeline'
[0m15:10:19.457969 [debug] [MainThread]: Command `dbt test` failed at 15:10:19.457517 after 0.37 seconds
[0m15:10:19.459540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A0AE3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A0AEEC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A1C38270>]}
[0m15:10:19.461380 [debug] [MainThread]: Flushing usage events
[0m15:10:20.603468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:22.109054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D32023A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D3003DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D3340BC50>]}


============================== 15:12:22.115279 | 1a4e06d4-1a67-4fc1-a738-145f65f40427 ==============================
[0m15:12:22.115279 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:12:22.116333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:12:22.153880 [info ] [MainThread]: dbt version: 1.10.4
[0m15:12:22.154780 [info ] [MainThread]: python version: 3.13.5
[0m15:12:22.155564 [info ] [MainThread]: python path: C:\Users\User\medintel-pipeline\venv\Scripts\python.exe
[0m15:12:22.156587 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:12:22.275698 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m15:12:22.276483 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m15:12:22.277119 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\medintel-pipeline\dbt_project.yml
[0m15:12:22.278695 [info ] [MainThread]: adapter type: postgres
[0m15:12:22.279363 [info ] [MainThread]: adapter version: 1.9.0
[0m15:12:22.452214 [info ] [MainThread]: Configuration:
[0m15:12:22.453161 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:12:22.453965 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:12:22.454783 [info ] [MainThread]: Required dependencies:
[0m15:12:22.455594 [debug] [MainThread]: Executing "git --help"
[0m15:12:22.516033 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:12:22.516690 [debug] [MainThread]: STDERR: "b''"
[0m15:12:22.517253 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:12:22.518207 [info ] [MainThread]: Connection:
[0m15:12:22.518993 [info ] [MainThread]:   host: localhost
[0m15:12:22.519694 [info ] [MainThread]:   port: 5432
[0m15:12:22.520428 [info ] [MainThread]:   user: postgres
[0m15:12:22.521186 [info ] [MainThread]:   database: postgres
[0m15:12:22.522047 [info ] [MainThread]:   schema: staging
[0m15:12:22.524083 [info ] [MainThread]:   connect_timeout: 10
[0m15:12:22.525687 [info ] [MainThread]:   role: None
[0m15:12:22.526777 [info ] [MainThread]:   search_path: None
[0m15:12:22.527690 [info ] [MainThread]:   keepalives_idle: 0
[0m15:12:22.528583 [info ] [MainThread]:   sslmode: None
[0m15:12:22.529466 [info ] [MainThread]:   sslcert: None
[0m15:12:22.530361 [info ] [MainThread]:   sslkey: None
[0m15:12:22.531355 [info ] [MainThread]:   sslrootcert: None
[0m15:12:22.532252 [info ] [MainThread]:   application_name: dbt
[0m15:12:22.533131 [info ] [MainThread]:   retries: 1
[0m15:12:22.534491 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:12:22.874234 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:12:22.974232 [debug] [MainThread]: Using postgres connection "debug"
[0m15:12:22.974734 [debug] [MainThread]: On debug: select 1 as id
[0m15:12:22.975137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:23.029207 [debug] [MainThread]: SQL status: SELECT 1 in 0.054 seconds
[0m15:12:23.031098 [debug] [MainThread]: On debug: Close
[0m15:12:23.031648 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:12:23.032796 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:12:23.034699 [debug] [MainThread]: Command `dbt debug` succeeded at 15:12:23.034476 after 1.15 seconds
[0m15:12:23.035205 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:12:23.035679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D349D9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D3471DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D33483130>]}
[0m15:12:23.036216 [debug] [MainThread]: Flushing usage events
[0m15:12:24.303526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:29.710238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144044CBA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001440256DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144058B7C50>]}


============================== 15:12:29.717045 | 40a489b4-8fc6-41cb-935b-3cb16591e43b ==============================
[0m15:12:29.717045 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:12:29.718152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:12:30.101369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014404BBFCE0>]}
[0m15:12:30.202569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014405909F20>]}
[0m15:12:30.204691 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:12:30.665470 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:12:30.834808 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:12:30.835785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014406D7EA50>]}
[0m15:12:33.296614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014406F40C80>]}
[0m15:12:33.504793 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m15:12:33.508163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m15:12:33.548753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014406F2E190>]}
[0m15:12:33.549939 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m15:12:33.550876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014406F5EF70>]}
[0m15:12:33.554448 [info ] [MainThread]: 
[0m15:12:33.555340 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:12:33.556237 [info ] [MainThread]: 
[0m15:12:33.557620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:12:33.563526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:12:33.694076 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:12:33.694609 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:12:33.695044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:33.756504 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.061 seconds
[0m15:12:33.758401 [debug] [ThreadPool]: On list_postgres: Close
[0m15:12:33.761693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m15:12:33.773264 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m15:12:33.773776 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m15:12:33.774201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:33.830019 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m15:12:33.830588 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m15:12:33.831094 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:12:33.840927 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m15:12:33.842705 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m15:12:33.843355 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m15:12:33.852567 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:33.853175 [debug] [MainThread]: On master: BEGIN
[0m15:12:33.853595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:34.063133 [debug] [MainThread]: SQL status: BEGIN in 0.209 seconds
[0m15:12:34.064296 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:34.066841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:12:34.092890 [debug] [MainThread]: SQL status: SELECT 2 in 0.025 seconds
[0m15:12:34.097158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144074990D0>]}
[0m15:12:34.098777 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:34.100866 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:34.101922 [debug] [MainThread]: On master: BEGIN
[0m15:12:34.103674 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:12:34.105461 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.106501 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:34.107449 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.108772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:34.109799 [debug] [MainThread]: On master: Close
[0m15:12:34.125341 [debug] [Thread-1 (]: Began running node model.medintel_pipeline.stg_telegram_messages
[0m15:12:34.129723 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.stg_telegram_messages ...................... [RUN]
[0m15:12:34.134628 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medintel_pipeline.stg_telegram_messages'
[0m15:12:34.137123 [debug] [Thread-1 (]: Began compiling node model.medintel_pipeline.stg_telegram_messages
[0m15:12:34.170043 [debug] [Thread-1 (]: Writing injected SQL for node "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.173898 [debug] [Thread-1 (]: Began executing node model.medintel_pipeline.stg_telegram_messages
[0m15:12:34.271665 [debug] [Thread-1 (]: Writing runtime sql for node "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.275457 [debug] [Thread-1 (]: Using postgres connection "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.276688 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: BEGIN
[0m15:12:34.277462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:12:34.341399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m15:12:34.342156 [debug] [Thread-1 (]: Using postgres connection "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.342694 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.stg_telegram_messages"} */

  create view "postgres"."staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
  msg.id,
  msg.channel,
  CAST(msg.date AS TIMESTAMP) AS message_date,
  CHAR_LENGTH(REGEXP_REPLACE(TRIM(msg.text), '\s+', '', 'g')) AS message_length,
  msg.has_image,
  msg.image_path,
  msg.text
FROM "postgres"."raw"."telegram_messages" AS msg
WHERE CHAR_LENGTH(REGEXP_REPLACE(TRIM(msg.text), '\s+', '', 'g')) > 1
  );
[0m15:12:34.351965 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m15:12:34.360415 [debug] [Thread-1 (]: Using postgres connection "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.361053 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m15:12:34.362191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:34.366551 [debug] [Thread-1 (]: Using postgres connection "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.367166 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.stg_telegram_messages"} */
alter table "postgres"."staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m15:12:34.368241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:12:34.392376 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: COMMIT
[0m15:12:34.393038 [debug] [Thread-1 (]: Using postgres connection "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.393582 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: COMMIT
[0m15:12:34.396099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:12:34.405426 [debug] [Thread-1 (]: Applying DROP to: "postgres"."staging"."stg_telegram_messages__dbt_backup"
[0m15:12:34.412636 [debug] [Thread-1 (]: Using postgres connection "model.medintel_pipeline.stg_telegram_messages"
[0m15:12:34.413216 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.stg_telegram_messages"} */
drop view if exists "postgres"."staging"."stg_telegram_messages__dbt_backup" cascade
[0m15:12:34.416342 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:12:34.420852 [debug] [Thread-1 (]: On model.medintel_pipeline.stg_telegram_messages: Close
[0m15:12:34.426329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001440700F540>]}
[0m15:12:34.428029 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.stg_telegram_messages ................. [[32mCREATE VIEW[0m in 0.29s]
[0m15:12:34.429541 [debug] [Thread-1 (]: Finished running node model.medintel_pipeline.stg_telegram_messages
[0m15:12:34.430826 [debug] [Thread-3 (]: Began running node model.medintel_pipeline.dim_dates
[0m15:12:34.432345 [debug] [Thread-4 (]: Began running node model.medintel_pipeline.fct_messages
[0m15:12:34.433774 [debug] [Thread-2 (]: Began running node model.medintel_pipeline.dim_channels
[0m15:12:34.431933 [info ] [Thread-3 (]: 3 of 4 START sql view model staging.dim_dates .................................. [RUN]
[0m15:12:34.435740 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medintel_pipeline.dim_dates'
[0m15:12:34.433263 [info ] [Thread-4 (]: 4 of 4 START sql view model staging.fct_messages ............................... [RUN]
[0m15:12:34.436704 [debug] [Thread-3 (]: Began compiling node model.medintel_pipeline.dim_dates
[0m15:12:34.438109 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medintel_pipeline.fct_messages'
[0m15:12:34.434835 [info ] [Thread-2 (]: 2 of 4 START sql view model staging.dim_channels ............................... [RUN]
[0m15:12:34.440212 [debug] [Thread-4 (]: Began compiling node model.medintel_pipeline.fct_messages
[0m15:12:34.449242 [debug] [Thread-3 (]: Writing injected SQL for node "model.medintel_pipeline.dim_dates"
[0m15:12:34.450131 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medintel_pipeline.dim_channels'
[0m15:12:34.453437 [debug] [Thread-4 (]: Writing injected SQL for node "model.medintel_pipeline.fct_messages"
[0m15:12:34.454258 [debug] [Thread-2 (]: Began compiling node model.medintel_pipeline.dim_channels
[0m15:12:34.460566 [debug] [Thread-2 (]: Writing injected SQL for node "model.medintel_pipeline.dim_channels"
[0m15:12:34.461856 [debug] [Thread-3 (]: Began executing node model.medintel_pipeline.dim_dates
[0m15:12:34.470645 [debug] [Thread-3 (]: Writing runtime sql for node "model.medintel_pipeline.dim_dates"
[0m15:12:34.473140 [debug] [Thread-2 (]: Began executing node model.medintel_pipeline.dim_channels
[0m15:12:34.471313 [debug] [Thread-4 (]: Began executing node model.medintel_pipeline.fct_messages
[0m15:12:34.482540 [debug] [Thread-2 (]: Writing runtime sql for node "model.medintel_pipeline.dim_channels"
[0m15:12:34.487855 [debug] [Thread-4 (]: Writing runtime sql for node "model.medintel_pipeline.fct_messages"
[0m15:12:34.490456 [debug] [Thread-3 (]: Using postgres connection "model.medintel_pipeline.dim_dates"
[0m15:12:34.491784 [debug] [Thread-3 (]: On model.medintel_pipeline.dim_dates: BEGIN
[0m15:12:34.492686 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:12:34.494930 [debug] [Thread-2 (]: Using postgres connection "model.medintel_pipeline.dim_channels"
[0m15:12:34.496242 [debug] [Thread-2 (]: On model.medintel_pipeline.dim_channels: BEGIN
[0m15:12:34.497305 [debug] [Thread-4 (]: Using postgres connection "model.medintel_pipeline.fct_messages"
[0m15:12:34.498169 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:12:34.499474 [debug] [Thread-4 (]: On model.medintel_pipeline.fct_messages: BEGIN
[0m15:12:34.501057 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:12:34.564391 [debug] [Thread-3 (]: SQL status: BEGIN in 0.072 seconds
[0m15:12:34.565594 [debug] [Thread-3 (]: Using postgres connection "model.medintel_pipeline.dim_dates"
[0m15:12:34.566797 [debug] [Thread-3 (]: On model.medintel_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.dim_dates"} */

  create view "postgres"."staging"."dim_dates__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  message_date::DATE AS date,
  EXTRACT(DAY FROM message_date) AS day,
  EXTRACT(WEEK FROM message_date) AS week,
  EXTRACT(MONTH FROM message_date) AS month,
  EXTRACT(YEAR FROM message_date) AS year
FROM "postgres"."staging"."stg_telegram_messages"
WHERE message_date IS NOT NULL
  );
[0m15:12:34.576573 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:12:34.584456 [debug] [Thread-3 (]: Using postgres connection "model.medintel_pipeline.dim_dates"
[0m15:12:34.585761 [debug] [Thread-3 (]: On model.medintel_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.dim_dates"} */
alter table "postgres"."staging"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:12:34.587579 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:34.588554 [debug] [Thread-4 (]: SQL status: BEGIN in 0.088 seconds
[0m15:12:34.591375 [debug] [Thread-3 (]: On model.medintel_pipeline.dim_dates: COMMIT
[0m15:12:34.592597 [debug] [Thread-4 (]: Using postgres connection "model.medintel_pipeline.fct_messages"
[0m15:12:34.593181 [debug] [Thread-2 (]: SQL status: BEGIN in 0.095 seconds
[0m15:12:34.593793 [debug] [Thread-3 (]: Using postgres connection "model.medintel_pipeline.dim_dates"
[0m15:12:34.594397 [debug] [Thread-4 (]: On model.medintel_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.fct_messages"} */

  create view "postgres"."staging"."fct_messages__dbt_tmp"
    
    
  as (
    SELECT
  stg.id,
  stg.channel,
  stg.message_date,
  CHAR_LENGTH(REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')) AS message_length,
  stg.has_image,
  stg.image_path,
  stg.text
FROM "postgres"."staging"."stg_telegram_messages" AS stg
WHERE CHAR_LENGTH(REGEXP_REPLACE(TRIM(stg.text), '\s+', '', 'g')) > 1
  );
[0m15:12:34.595015 [debug] [Thread-2 (]: Using postgres connection "model.medintel_pipeline.dim_channels"
[0m15:12:34.595585 [debug] [Thread-3 (]: On model.medintel_pipeline.dim_dates: COMMIT
[0m15:12:34.596491 [debug] [Thread-2 (]: On model.medintel_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.dim_channels"} */

  create view "postgres"."staging"."dim_channels__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
  channel AS channel_name,
  NULL::TEXT AS channel_type -- Optional enrichment
FROM "postgres"."staging"."stg_telegram_messages"
  );
[0m15:12:34.598787 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:12:34.605167 [debug] [Thread-3 (]: Applying DROP to: "postgres"."staging"."dim_dates__dbt_backup"
[0m15:12:34.605844 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:12:34.606391 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m15:12:34.607621 [debug] [Thread-3 (]: Using postgres connection "model.medintel_pipeline.dim_dates"
[0m15:12:34.612137 [debug] [Thread-2 (]: Using postgres connection "model.medintel_pipeline.dim_channels"
[0m15:12:34.616097 [debug] [Thread-4 (]: Using postgres connection "model.medintel_pipeline.fct_messages"
[0m15:12:34.616888 [debug] [Thread-3 (]: On model.medintel_pipeline.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.dim_dates"} */
drop view if exists "postgres"."staging"."dim_dates__dbt_backup" cascade
[0m15:12:34.617492 [debug] [Thread-2 (]: On model.medintel_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.dim_channels"} */
alter table "postgres"."staging"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m15:12:34.618102 [debug] [Thread-4 (]: On model.medintel_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.fct_messages"} */
alter table "postgres"."staging"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m15:12:34.619377 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:12:34.620127 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:34.622197 [debug] [Thread-3 (]: On model.medintel_pipeline.dim_dates: Close
[0m15:12:34.622768 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:12:34.625416 [debug] [Thread-4 (]: On model.medintel_pipeline.fct_messages: COMMIT
[0m15:12:34.628053 [debug] [Thread-2 (]: On model.medintel_pipeline.dim_channels: COMMIT
[0m15:12:34.629073 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001440766CC30>]}
[0m15:12:34.629978 [debug] [Thread-4 (]: Using postgres connection "model.medintel_pipeline.fct_messages"
[0m15:12:34.630599 [debug] [Thread-2 (]: Using postgres connection "model.medintel_pipeline.dim_channels"
[0m15:12:34.632212 [debug] [Thread-4 (]: On model.medintel_pipeline.fct_messages: COMMIT
[0m15:12:34.631646 [info ] [Thread-3 (]: 3 of 4 OK created sql view model staging.dim_dates ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m15:12:34.633078 [debug] [Thread-2 (]: On model.medintel_pipeline.dim_channels: COMMIT
[0m15:12:34.634356 [debug] [Thread-3 (]: Finished running node model.medintel_pipeline.dim_dates
[0m15:12:34.635165 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:12:34.638574 [debug] [Thread-4 (]: Applying DROP to: "postgres"."staging"."fct_messages__dbt_backup"
[0m15:12:34.641698 [debug] [Thread-4 (]: Using postgres connection "model.medintel_pipeline.fct_messages"
[0m15:12:34.639164 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:12:34.642820 [debug] [Thread-4 (]: On model.medintel_pipeline.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.fct_messages"} */
drop view if exists "postgres"."staging"."fct_messages__dbt_backup" cascade
[0m15:12:34.646960 [debug] [Thread-2 (]: Applying DROP to: "postgres"."staging"."dim_channels__dbt_backup"
[0m15:12:34.648476 [debug] [Thread-2 (]: Using postgres connection "model.medintel_pipeline.dim_channels"
[0m15:12:34.649068 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:12:34.649608 [debug] [Thread-2 (]: On model.medintel_pipeline.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "model.medintel_pipeline.dim_channels"} */
drop view if exists "postgres"."staging"."dim_channels__dbt_backup" cascade
[0m15:12:34.651746 [debug] [Thread-4 (]: On model.medintel_pipeline.fct_messages: Close
[0m15:12:34.652723 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014407565D50>]}
[0m15:12:34.653463 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:12:34.658979 [debug] [Thread-2 (]: On model.medintel_pipeline.dim_channels: Close
[0m15:12:34.654345 [info ] [Thread-4 (]: 4 of 4 OK created sql view model staging.fct_messages .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m15:12:34.660833 [debug] [Thread-4 (]: Finished running node model.medintel_pipeline.fct_messages
[0m15:12:34.662182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a489b4-8fc6-41cb-935b-3cb16591e43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001440719BB60>]}
[0m15:12:34.663498 [info ] [Thread-2 (]: 2 of 4 OK created sql view model staging.dim_channels .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m15:12:34.666379 [debug] [Thread-2 (]: Finished running node model.medintel_pipeline.dim_channels
[0m15:12:34.669670 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:34.671633 [debug] [MainThread]: On master: BEGIN
[0m15:12:34.672526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:34.736917 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m15:12:34.737668 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.738150 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:34.738607 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.739151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:34.739595 [debug] [MainThread]: On master: Close
[0m15:12:34.740185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:34.740878 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:12:34.741692 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m15:12:34.743320 [debug] [MainThread]: Connection 'model.medintel_pipeline.stg_telegram_messages' was properly closed.
[0m15:12:34.744737 [debug] [MainThread]: Connection 'model.medintel_pipeline.dim_dates' was properly closed.
[0m15:12:34.746254 [debug] [MainThread]: Connection 'model.medintel_pipeline.fct_messages' was properly closed.
[0m15:12:34.747683 [debug] [MainThread]: Connection 'model.medintel_pipeline.dim_channels' was properly closed.
[0m15:12:34.749309 [info ] [MainThread]: 
[0m15:12:34.750160 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m15:12:34.752610 [debug] [MainThread]: Command end result
[0m15:12:34.814066 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m15:12:34.817722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m15:12:34.828950 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m15:12:34.829666 [info ] [MainThread]: 
[0m15:12:34.830539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:34.831276 [info ] [MainThread]: 
[0m15:12:34.832168 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:12:34.833878 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:34.833680 after 5.31 seconds
[0m15:12:34.834426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014402B0ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014406E380B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144059AA0F0>]}
[0m15:12:34.834960 [debug] [MainThread]: Flushing usage events
[0m15:12:36.212893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:43.387527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015263AC3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015261AD9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015264EA7C50>]}


============================== 15:12:43.395823 | 2661cd86-9154-4e71-b85f-c23c1668dd45 ==============================
[0m15:12:43.395823 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:12:43.397346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\medintel-pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:12:43.803836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2661cd86-9154-4e71-b85f-c23c1668dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152641B3CE0>]}
[0m15:12:43.943312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2661cd86-9154-4e71-b85f-c23c1668dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015264EF9F20>]}
[0m15:12:43.946364 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:12:44.621538 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:12:45.015303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:45.015964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:45.229736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2661cd86-9154-4e71-b85f-c23c1668dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015264D33150>]}
[0m15:12:45.469205 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m15:12:45.472603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m15:12:45.536784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2661cd86-9154-4e71-b85f-c23c1668dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001526655A210>]}
[0m15:12:45.538001 [info ] [MainThread]: Found 4 models, 13 data tests, 1 source, 433 macros
[0m15:12:45.538969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2661cd86-9154-4e71-b85f-c23c1668dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152664DB5B0>]}
[0m15:12:45.542510 [info ] [MainThread]: 
[0m15:12:45.543562 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:12:45.544276 [info ] [MainThread]: 
[0m15:12:45.545620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:12:45.555159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m15:12:45.729603 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m15:12:45.730175 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m15:12:45.730627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:45.814571 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m15:12:45.815804 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m15:12:45.817393 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m15:12:45.829958 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m15:12:45.832767 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m15:12:45.834297 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m15:12:45.850053 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.851099 [debug] [MainThread]: On master: BEGIN
[0m15:12:45.852033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:45.916566 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m15:12:45.917209 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.917752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:12:45.929370 [debug] [MainThread]: SQL status: SELECT 4 in 0.011 seconds
[0m15:12:45.933542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2661cd86-9154-4e71-b85f-c23c1668dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001526664FEE0>]}
[0m15:12:45.934196 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:45.934962 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.935865 [debug] [MainThread]: On master: BEGIN
[0m15:12:45.937078 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:12:45.937735 [debug] [MainThread]: On master: COMMIT
[0m15:12:45.938207 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.938653 [debug] [MainThread]: On master: COMMIT
[0m15:12:45.939312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:45.939869 [debug] [MainThread]: On master: Close
[0m15:12:45.948798 [debug] [Thread-3 (]: Began running node test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39
[0m15:12:45.950055 [debug] [Thread-4 (]: Began running node test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f
[0m15:12:45.951225 [debug] [Thread-1 (]: Began running node test.medintel_pipeline.long_messages
[0m15:12:45.952154 [debug] [Thread-2 (]: Began running node test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b
[0m15:12:45.952767 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_dates_date ..................................... [RUN]
[0m15:12:45.953437 [info ] [Thread-4 (]: 4 of 13 START test not_null_fct_messages_channel ............................... [RUN]
[0m15:12:45.955770 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39'
[0m15:12:45.956714 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f'
[0m15:12:45.954223 [info ] [Thread-1 (]: 1 of 13 START test long_messages ............................................... [RUN]
[0m15:12:45.957453 [debug] [Thread-3 (]: Began compiling node test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39
[0m15:12:45.958181 [debug] [Thread-4 (]: Began compiling node test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f
[0m15:12:45.960088 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medintel_pipeline.long_messages'
[0m15:12:45.954851 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m15:12:46.024607 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39"
[0m15:12:46.026384 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f"
[0m15:12:46.027517 [debug] [Thread-1 (]: Began compiling node test.medintel_pipeline.long_messages
[0m15:12:46.028824 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m15:12:46.035841 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_pipeline.long_messages"
[0m15:12:46.037067 [debug] [Thread-2 (]: Began compiling node test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b
[0m15:12:46.046459 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m15:12:46.047887 [debug] [Thread-3 (]: Began executing node test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39
[0m15:12:46.063610 [debug] [Thread-4 (]: Began executing node test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f
[0m15:12:46.087327 [debug] [Thread-2 (]: Began executing node test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b
[0m15:12:46.144179 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39"
[0m15:12:46.145001 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m15:12:46.148500 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f"
[0m15:12:46.153398 [debug] [Thread-1 (]: Began executing node test.medintel_pipeline.long_messages
[0m15:12:46.160850 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_pipeline.long_messages"
[0m15:12:46.163217 [debug] [Thread-2 (]: Using postgres connection "test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m15:12:46.168007 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m15:12:46.169077 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:12:46.165655 [debug] [Thread-1 (]: Using postgres connection "test.medintel_pipeline.long_messages"
[0m15:12:46.171050 [debug] [Thread-1 (]: On test.medintel_pipeline.long_messages: BEGIN
[0m15:12:46.172860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:12:46.175755 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39"
[0m15:12:46.178764 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39: BEGIN
[0m15:12:46.180138 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:12:46.187402 [debug] [Thread-4 (]: Using postgres connection "test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f"
[0m15:12:46.189028 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f: BEGIN
[0m15:12:46.190208 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:12:46.296716 [debug] [Thread-3 (]: SQL status: BEGIN in 0.116 seconds
[0m15:12:46.297967 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39"
[0m15:12:46.299765 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "postgres"."staging"."dim_dates"
where date is null



  
  
      
    ) dbt_internal_test
[0m15:12:46.307238 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:12:46.321898 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39: ROLLBACK
[0m15:12:46.323270 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39: Close
[0m15:12:46.338442 [debug] [Thread-2 (]: SQL status: BEGIN in 0.169 seconds
[0m15:12:46.339668 [debug] [Thread-2 (]: Using postgres connection "test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m15:12:46.341005 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "postgres"."staging"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m15:12:46.347106 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:12:46.351828 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m15:12:46.353286 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m15:12:46.356575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.184 seconds
[0m15:12:46.357877 [debug] [Thread-1 (]: Using postgres connection "test.medintel_pipeline.long_messages"
[0m15:12:46.359329 [debug] [Thread-1 (]: On test.medintel_pipeline.long_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.long_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM "postgres"."staging"."fct_messages"
WHERE message_length <= 1
  
  
      
    ) dbt_internal_test
[0m15:12:46.324925 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_dates_date ........................................... [[32mPASS[0m in 0.37s]
[0m15:12:46.376686 [debug] [Thread-3 (]: Finished running node test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39
[0m15:12:46.377996 [debug] [Thread-3 (]: Began running node test.medintel_pipeline.not_null_fct_messages_id.a8dc118488
[0m15:12:46.355433 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.33s]
[0m15:12:46.415807 [debug] [Thread-2 (]: Finished running node test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b
[0m15:12:46.418078 [debug] [Thread-2 (]: Began running node test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df
[0m15:12:46.379190 [info ] [Thread-3 (]: 5 of 13 START test not_null_fct_messages_id .................................... [RUN]
[0m15:12:46.455075 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_dim_dates_date.e2decc9d39, now test.medintel_pipeline.not_null_fct_messages_id.a8dc118488)
[0m15:12:46.456400 [debug] [Thread-3 (]: Began compiling node test.medintel_pipeline.not_null_fct_messages_id.a8dc118488
[0m15:12:46.486315 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_fct_messages_id.a8dc118488"
[0m15:12:46.489723 [debug] [Thread-3 (]: Began executing node test.medintel_pipeline.not_null_fct_messages_id.a8dc118488
[0m15:12:46.496120 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_fct_messages_id.a8dc118488"
[0m15:12:46.500052 [debug] [Thread-4 (]: SQL status: BEGIN in 0.310 seconds
[0m15:12:46.501355 [debug] [Thread-4 (]: Using postgres connection "test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f"
[0m15:12:46.502600 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."fct_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m15:12:46.507683 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:12:46.511797 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f: ROLLBACK
[0m15:12:46.513223 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f: Close
[0m15:12:46.514522 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.not_null_fct_messages_id.a8dc118488"
[0m15:12:46.517984 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_fct_messages_id.a8dc118488: BEGIN
[0m15:12:46.519773 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:12:46.419451 [info ] [Thread-2 (]: 6 of 13 START test not_null_fct_messages_message_date .......................... [RUN]
[0m15:12:46.521964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df)
[0m15:12:46.523304 [debug] [Thread-2 (]: Began compiling node test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df
[0m15:12:46.542641 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df"
[0m15:12:46.516815 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fct_messages_channel ..................................... [[32mPASS[0m in 0.56s]
[0m15:12:46.545116 [debug] [Thread-4 (]: Finished running node test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f
[0m15:12:46.546509 [debug] [Thread-4 (]: Began running node test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192
[0m15:12:46.550141 [debug] [Thread-2 (]: Began executing node test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df
[0m15:12:46.556816 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df"
[0m15:12:46.548568 [info ] [Thread-4 (]: 7 of 13 START test not_null_stg_telegram_messages_channel ...................... [RUN]
[0m15:12:46.571022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_fct_messages_channel.e99e1d225f, now test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192)
[0m15:12:46.572069 [debug] [Thread-4 (]: Began compiling node test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192
[0m15:12:46.582313 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192"
[0m15:12:46.584876 [debug] [Thread-4 (]: Began executing node test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192
[0m15:12:46.690230 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192"
[0m15:12:46.691127 [debug] [Thread-3 (]: SQL status: BEGIN in 0.172 seconds
[0m15:12:46.692104 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.331 seconds
[0m15:12:46.693253 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.not_null_fct_messages_id.a8dc118488"
[0m15:12:46.697098 [debug] [Thread-1 (]: On test.medintel_pipeline.long_messages: ROLLBACK
[0m15:12:46.698616 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_fct_messages_id.a8dc118488: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_fct_messages_id.a8dc118488"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."fct_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m15:12:46.699602 [debug] [Thread-2 (]: Using postgres connection "test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df"
[0m15:12:46.700841 [debug] [Thread-4 (]: Using postgres connection "test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192"
[0m15:12:46.701938 [debug] [Thread-1 (]: On test.medintel_pipeline.long_messages: Close
[0m15:12:46.703300 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df: BEGIN
[0m15:12:46.704435 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:12:46.705449 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192: BEGIN
[0m15:12:46.706756 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:12:46.712315 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_fct_messages_id.a8dc118488: ROLLBACK
[0m15:12:46.708237 [info ] [Thread-1 (]: 1 of 13 PASS long_messages ..................................................... [[32mPASS[0m in 0.75s]
[0m15:12:46.713910 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:12:46.716162 [debug] [Thread-1 (]: Finished running node test.medintel_pipeline.long_messages
[0m15:12:46.717218 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_fct_messages_id.a8dc118488: Close
[0m15:12:46.719044 [debug] [Thread-1 (]: Began running node test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317
[0m15:12:46.720759 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_telegram_messages_id ........................... [RUN]
[0m15:12:46.726320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.long_messages, now test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m15:12:46.727612 [debug] [Thread-1 (]: Began compiling node test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317
[0m15:12:46.741463 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m15:12:46.722432 [info ] [Thread-3 (]: 5 of 13 PASS not_null_fct_messages_id .......................................... [[32mPASS[0m in 0.27s]
[0m15:12:46.744066 [debug] [Thread-3 (]: Finished running node test.medintel_pipeline.not_null_fct_messages_id.a8dc118488
[0m15:12:46.745630 [debug] [Thread-3 (]: Began running node test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m15:12:46.747038 [debug] [Thread-1 (]: Began executing node test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317
[0m15:12:46.752304 [info ] [Thread-3 (]: 9 of 13 START test not_null_stg_telegram_messages_message_date ................. [RUN]
[0m15:12:46.760992 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m15:12:46.762371 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_fct_messages_id.a8dc118488, now test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m15:12:46.763876 [debug] [Thread-3 (]: Began compiling node test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m15:12:46.777953 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m15:12:46.779785 [debug] [Thread-1 (]: Using postgres connection "test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m15:12:46.780813 [debug] [Thread-1 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m15:12:46.786234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:46.787858 [debug] [Thread-3 (]: Began executing node test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m15:12:46.795888 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m15:12:46.799840 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m15:12:46.801163 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14: BEGIN
[0m15:12:46.801979 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:12:46.818472 [debug] [Thread-2 (]: SQL status: BEGIN in 0.112 seconds
[0m15:12:46.819657 [debug] [Thread-2 (]: Using postgres connection "test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df"
[0m15:12:46.820735 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."fct_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m15:12:46.827317 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:12:46.831133 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df: ROLLBACK
[0m15:12:46.833053 [debug] [Thread-2 (]: On test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df: Close
[0m15:12:46.840828 [debug] [Thread-4 (]: SQL status: BEGIN in 0.127 seconds
[0m15:12:46.842370 [debug] [Thread-4 (]: Using postgres connection "test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192"
[0m15:12:46.844070 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "postgres"."staging"."stg_telegram_messages"
where channel is null



  
  
      
    ) dbt_internal_test
[0m15:12:46.848795 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:12:46.853418 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192: ROLLBACK
[0m15:12:46.854847 [debug] [Thread-4 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192: Close
[0m15:12:46.834729 [info ] [Thread-2 (]: 6 of 13 PASS not_null_fct_messages_message_date ................................ [[32mPASS[0m in 0.31s]
[0m15:12:46.882740 [debug] [Thread-2 (]: Finished running node test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df
[0m15:12:46.884097 [debug] [Thread-2 (]: Began running node test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8
[0m15:12:46.856865 [info ] [Thread-4 (]: 7 of 13 PASS not_null_stg_telegram_messages_channel ............................ [[32mPASS[0m in 0.29s]
[0m15:12:46.888608 [debug] [Thread-4 (]: Finished running node test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192
[0m15:12:46.889963 [debug] [Thread-4 (]: Began running node test.medintel_pipeline.unique_dim_dates_date.bab48d2068
[0m15:12:46.920684 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m15:12:46.921990 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m15:12:46.923381 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "postgres"."staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m15:12:46.928340 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:12:46.932322 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m15:12:46.934677 [debug] [Thread-3 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m15:12:46.885482 [info ] [Thread-2 (]: 10 of 13 START test unique_dim_channels_channel_name ........................... [RUN]
[0m15:12:46.946031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_fct_messages_message_date.e5a43e40df, now test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8)
[0m15:12:46.947661 [debug] [Thread-2 (]: Began compiling node test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8
[0m15:12:47.022615 [debug] [Thread-2 (]: Writing injected SQL for node "test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8"
[0m15:12:47.024638 [debug] [Thread-2 (]: Began executing node test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8
[0m15:12:47.033877 [debug] [Thread-2 (]: Writing runtime sql for node "test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8"
[0m15:12:47.036247 [debug] [Thread-2 (]: Using postgres connection "test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8"
[0m15:12:47.037479 [debug] [Thread-2 (]: On test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m15:12:47.038599 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:12:47.062467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.276 seconds
[0m15:12:47.063803 [debug] [Thread-1 (]: Using postgres connection "test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m15:12:47.065710 [debug] [Thread-1 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "postgres"."staging"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m15:12:47.072455 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:12:47.076385 [debug] [Thread-1 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m15:12:47.077658 [debug] [Thread-1 (]: On test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m15:12:46.891338 [info ] [Thread-4 (]: 11 of 13 START test unique_dim_dates_date ...................................... [RUN]
[0m15:12:47.084250 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_stg_telegram_messages_channel.4874862192, now test.medintel_pipeline.unique_dim_dates_date.bab48d2068)
[0m15:12:47.085439 [debug] [Thread-4 (]: Began compiling node test.medintel_pipeline.unique_dim_dates_date.bab48d2068
[0m15:12:47.100914 [debug] [Thread-4 (]: Writing injected SQL for node "test.medintel_pipeline.unique_dim_dates_date.bab48d2068"
[0m15:12:46.936843 [info ] [Thread-3 (]: 9 of 13 PASS not_null_stg_telegram_messages_message_date ....................... [[32mPASS[0m in 0.17s]
[0m15:12:47.103827 [debug] [Thread-3 (]: Finished running node test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m15:12:47.105897 [debug] [Thread-3 (]: Began running node test.medintel_pipeline.unique_fct_messages_id.e6be0d3724
[0m15:12:47.108366 [debug] [Thread-4 (]: Began executing node test.medintel_pipeline.unique_dim_dates_date.bab48d2068
[0m15:12:47.120616 [debug] [Thread-4 (]: Writing runtime sql for node "test.medintel_pipeline.unique_dim_dates_date.bab48d2068"
[0m15:12:47.123457 [debug] [Thread-4 (]: Using postgres connection "test.medintel_pipeline.unique_dim_dates_date.bab48d2068"
[0m15:12:47.124545 [debug] [Thread-4 (]: On test.medintel_pipeline.unique_dim_dates_date.bab48d2068: BEGIN
[0m15:12:47.079691 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_telegram_messages_id ................................. [[32mPASS[0m in 0.35s]
[0m15:12:47.146328 [debug] [Thread-1 (]: Finished running node test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317
[0m15:12:47.148209 [debug] [Thread-1 (]: Began running node test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a
[0m15:12:47.151111 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:12:47.107210 [info ] [Thread-3 (]: 12 of 13 START test unique_fct_messages_id ..................................... [RUN]
[0m15:12:47.156154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medintel_pipeline.unique_fct_messages_id.e6be0d3724)
[0m15:12:47.157435 [debug] [Thread-3 (]: Began compiling node test.medintel_pipeline.unique_fct_messages_id.e6be0d3724
[0m15:12:47.169152 [debug] [Thread-3 (]: Writing injected SQL for node "test.medintel_pipeline.unique_fct_messages_id.e6be0d3724"
[0m15:12:47.171537 [debug] [Thread-3 (]: Began executing node test.medintel_pipeline.unique_fct_messages_id.e6be0d3724
[0m15:12:47.150179 [info ] [Thread-1 (]: 13 of 13 START test unique_stg_telegram_messages_id ............................ [RUN]
[0m15:12:47.180559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medintel_pipeline.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a)
[0m15:12:47.182121 [debug] [Thread-1 (]: Began compiling node test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a
[0m15:12:47.178649 [debug] [Thread-3 (]: Writing runtime sql for node "test.medintel_pipeline.unique_fct_messages_id.e6be0d3724"
[0m15:12:47.193097 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.unique_fct_messages_id.e6be0d3724"
[0m15:12:47.194224 [debug] [Thread-3 (]: On test.medintel_pipeline.unique_fct_messages_id.e6be0d3724: BEGIN
[0m15:12:47.195783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:12:47.199194 [debug] [Thread-1 (]: Writing injected SQL for node "test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a"
[0m15:12:47.201446 [debug] [Thread-1 (]: Began executing node test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a
[0m15:12:47.209179 [debug] [Thread-1 (]: Writing runtime sql for node "test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a"
[0m15:12:47.211154 [debug] [Thread-2 (]: SQL status: BEGIN in 0.173 seconds
[0m15:12:47.212247 [debug] [Thread-2 (]: Using postgres connection "test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8"
[0m15:12:47.213402 [debug] [Thread-2 (]: On test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:47.244313 [debug] [Thread-1 (]: Using postgres connection "test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a"
[0m15:12:47.245437 [debug] [Thread-1 (]: On test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a: BEGIN
[0m15:12:47.246462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:47.273713 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.059 seconds
[0m15:12:47.279453 [debug] [Thread-4 (]: SQL status: BEGIN in 0.154 seconds
[0m15:12:47.278247 [debug] [Thread-2 (]: On test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m15:12:47.280818 [debug] [Thread-4 (]: Using postgres connection "test.medintel_pipeline.unique_dim_dates_date.bab48d2068"
[0m15:12:47.282421 [debug] [Thread-4 (]: On test.medintel_pipeline.unique_dim_dates_date.bab48d2068: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.unique_dim_dates_date.bab48d2068"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date as unique_field,
    count(*) as n_records

from "postgres"."staging"."dim_dates"
where date is not null
group by date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:47.283821 [debug] [Thread-2 (]: On test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8: Close
[0m15:12:47.285703 [info ] [Thread-2 (]: 10 of 13 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.34s]
[0m15:12:47.293128 [debug] [Thread-2 (]: Finished running node test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8
[0m15:12:47.344150 [debug] [Thread-3 (]: SQL status: BEGIN in 0.148 seconds
[0m15:12:47.345309 [debug] [Thread-3 (]: Using postgres connection "test.medintel_pipeline.unique_fct_messages_id.e6be0d3724"
[0m15:12:47.346363 [debug] [Thread-3 (]: On test.medintel_pipeline.unique_fct_messages_id.e6be0d3724: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.unique_fct_messages_id.e6be0d3724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."fct_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:47.348681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.102 seconds
[0m15:12:47.349965 [debug] [Thread-1 (]: Using postgres connection "test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a"
[0m15:12:47.351265 [debug] [Thread-1 (]: On test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medintel_pipeline", "target_name": "dev", "node_id": "test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."staging"."stg_telegram_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:47.372946 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.088 seconds
[0m15:12:47.376747 [debug] [Thread-4 (]: On test.medintel_pipeline.unique_dim_dates_date.bab48d2068: ROLLBACK
[0m15:12:47.378018 [debug] [Thread-4 (]: On test.medintel_pipeline.unique_dim_dates_date.bab48d2068: Close
[0m15:12:47.379606 [info ] [Thread-4 (]: 11 of 13 PASS unique_dim_dates_date ............................................ [[32mPASS[0m in 0.30s]
[0m15:12:47.392578 [debug] [Thread-4 (]: Finished running node test.medintel_pipeline.unique_dim_dates_date.bab48d2068
[0m15:12:47.474136 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.122 seconds
[0m15:12:47.477792 [debug] [Thread-1 (]: On test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a: ROLLBACK
[0m15:12:47.479174 [debug] [Thread-1 (]: On test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a: Close
[0m15:12:47.481108 [info ] [Thread-1 (]: 13 of 13 PASS unique_stg_telegram_messages_id .................................. [[32mPASS[0m in 0.30s]
[0m15:12:47.510536 [debug] [Thread-1 (]: Finished running node test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a
[0m15:12:47.545176 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.197 seconds
[0m15:12:47.550717 [debug] [Thread-3 (]: On test.medintel_pipeline.unique_fct_messages_id.e6be0d3724: ROLLBACK
[0m15:12:47.552198 [debug] [Thread-3 (]: On test.medintel_pipeline.unique_fct_messages_id.e6be0d3724: Close
[0m15:12:47.554203 [info ] [Thread-3 (]: 12 of 13 PASS unique_fct_messages_id ........................................... [[32mPASS[0m in 0.40s]
[0m15:12:47.578431 [debug] [Thread-3 (]: Finished running node test.medintel_pipeline.unique_fct_messages_id.e6be0d3724
[0m15:12:47.602162 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:47.603429 [debug] [MainThread]: On master: BEGIN
[0m15:12:47.604688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:47.713676 [debug] [MainThread]: SQL status: BEGIN in 0.109 seconds
[0m15:12:47.714545 [debug] [MainThread]: On master: COMMIT
[0m15:12:47.715839 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:47.716769 [debug] [MainThread]: On master: COMMIT
[0m15:12:47.717487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:47.718143 [debug] [MainThread]: On master: Close
[0m15:12:47.719041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:47.719931 [debug] [MainThread]: Connection 'list_postgres_staging' was properly closed.
[0m15:12:47.721221 [debug] [MainThread]: Connection 'test.medintel_pipeline.unique_fct_messages_id.e6be0d3724' was properly closed.
[0m15:12:47.722883 [debug] [MainThread]: Connection 'test.medintel_pipeline.unique_dim_dates_date.bab48d2068' was properly closed.
[0m15:12:47.724410 [debug] [MainThread]: Connection 'test.medintel_pipeline.unique_stg_telegram_messages_id.58b6a8a35a' was properly closed.
[0m15:12:47.726051 [debug] [MainThread]: Connection 'test.medintel_pipeline.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m15:12:47.727367 [info ] [MainThread]: 
[0m15:12:47.728508 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m15:12:47.735367 [debug] [MainThread]: Command end result
[0m15:12:47.799387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\medintel-pipeline\target\manifest.json
[0m15:12:47.806158 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\medintel-pipeline\target\semantic_manifest.json
[0m15:12:47.834191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\medintel-pipeline\target\run_results.json
[0m15:12:47.835106 [info ] [MainThread]: 
[0m15:12:47.836304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:47.837597 [info ] [MainThread]: 
[0m15:12:47.838896 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m15:12:47.842499 [debug] [MainThread]: Command `dbt test` succeeded at 15:12:47.842162 after 4.68 seconds
[0m15:12:47.844976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015264E5C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152669E12E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152669E1440>]}
[0m15:12:47.845822 [debug] [MainThread]: Flushing usage events
[0m15:12:49.140734 [debug] [MainThread]: An error was encountered while trying to flush usage events
